(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const v of d.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&r(v)}).observe(document,{childList:!0,subtree:!0});function i(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function r(o){if(o.ep)return;o.ep=!0;const d=i(o);fetch(o.href,d)}})();function Rr(e,t){const i=Object.create(null),r=e.split(",");for(let o=0;o<r.length;o++)i[r[o]]=!0;return t?o=>!!i[o.toLowerCase()]:o=>!!i[o]}const we={},Xt=[],Je=()=>{},ll=()=>!1,hl=/^on[^a-z]/,Ss=e=>hl.test(e),Ar=e=>e.startsWith("onUpdate:"),Te=Object.assign,Lr=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},cl=Object.prototype.hasOwnProperty,ue=(e,t)=>cl.call(e,t),ae=Array.isArray,Yt=e=>bs(e)==="[object Map]",Co=e=>bs(e)==="[object Set]",ce=e=>typeof e=="function",ke=e=>typeof e=="string",Dr=e=>typeof e=="symbol",ye=e=>e!==null&&typeof e=="object",Eo=e=>ye(e)&&ce(e.then)&&ce(e.catch),xo=Object.prototype.toString,bs=e=>xo.call(e),dl=e=>bs(e).slice(8,-1),ko=e=>bs(e)==="[object Object]",Tr=e=>ke(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,is=Rr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ws=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},fl=/-(\w)/g,ht=ws(e=>e.replace(fl,(t,i)=>i?i.toUpperCase():"")),_l=/\B([A-Z])/g,oi=ws(e=>e.replace(_l,"-$1").toLowerCase()),ys=ws(e=>e.charAt(0).toUpperCase()+e.slice(1)),Os=ws(e=>e?`on${ys(e)}`:""),ki=(e,t)=>!Object.is(e,t),Ps=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)},cs=(e,t,i)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:i})},ul=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let rn;const ir=()=>rn||(rn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Cs(e){if(ae(e)){const t={};for(let i=0;i<e.length;i++){const r=e[i],o=ke(r)?ml(r):Cs(r);if(o)for(const d in o)t[d]=o[d]}return t}else{if(ke(e))return e;if(ye(e))return e}}const pl=/;(?![^(]*\))/g,gl=/:([^]+)/,vl=/\/\*[^]*?\*\//g;function ml(e){const t={};return e.replace(vl,"").split(pl).forEach(i=>{if(i){const r=i.split(gl);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function rt(e){let t="";if(ke(e))t=e;else if(ae(e))for(let i=0;i<e.length;i++){const r=rt(e[i]);r&&(t+=r+" ")}else if(ye(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}const Sl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",bl=Rr(Sl);function Ro(e){return!!e||e===""}const sr=e=>ke(e)?e:e==null?"":ae(e)||ye(e)&&(e.toString===xo||!ce(e.toString))?JSON.stringify(e,Ao,2):String(e),Ao=(e,t)=>t&&t.__v_isRef?Ao(e,t.value):Yt(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[r,o])=>(i[`${r} =>`]=o,i),{})}:Co(t)?{[`Set(${t.size})`]:[...t.values()]}:ye(t)&&!ae(t)&&!ko(t)?String(t):t;let Ge;class wl{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ge,!t&&Ge&&(this.index=(Ge.scopes||(Ge.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const i=Ge;try{return Ge=this,t()}finally{Ge=i}}}on(){Ge=this}off(){Ge=this.parent}stop(t){if(this._active){let i,r;for(i=0,r=this.effects.length;i<r;i++)this.effects[i].stop();for(i=0,r=this.cleanups.length;i<r;i++)this.cleanups[i]();if(this.scopes)for(i=0,r=this.scopes.length;i<r;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0,this._active=!1}}}function yl(e,t=Ge){t&&t.active&&t.effects.push(e)}function Cl(){return Ge}const Ir=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Lo=e=>(e.w&kt)>0,Do=e=>(e.n&kt)>0,El=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=kt},xl=e=>{const{deps:t}=e;if(t.length){let i=0;for(let r=0;r<t.length;r++){const o=t[r];Lo(o)&&!Do(o)?o.delete(e):t[i++]=o,o.w&=~kt,o.n&=~kt}t.length=i}},rr=new WeakMap;let gi=0,kt=1;const nr=30;let Xe;const Ht=Symbol(""),or=Symbol("");class Mr{constructor(t,i=null,r){this.fn=t,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,yl(this,r)}run(){if(!this.active)return this.fn();let t=Xe,i=wt;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Xe,Xe=this,wt=!0,kt=1<<++gi,gi<=nr?El(this):nn(this),this.fn()}finally{gi<=nr&&xl(this),kt=1<<--gi,Xe=this.parent,wt=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Xe===this?this.deferStop=!0:this.active&&(nn(this),this.onStop&&this.onStop(),this.active=!1)}}function nn(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let wt=!0;const To=[];function ai(){To.push(wt),wt=!1}function li(){const e=To.pop();wt=e===void 0?!0:e}function We(e,t,i){if(wt&&Xe){let r=rr.get(e);r||rr.set(e,r=new Map);let o=r.get(i);o||r.set(i,o=Ir()),Io(o)}}function Io(e,t){let i=!1;gi<=nr?Do(e)||(e.n|=kt,i=!Lo(e)):i=!e.has(Xe),i&&(e.add(Xe),Xe.deps.push(e))}function ut(e,t,i,r,o,d){const v=rr.get(e);if(!v)return;let s=[];if(t==="clear")s=[...v.values()];else if(i==="length"&&ae(e)){const l=Number(r);v.forEach((a,u)=>{(u==="length"||u>=l)&&s.push(a)})}else switch(i!==void 0&&s.push(v.get(i)),t){case"add":ae(e)?Tr(i)&&s.push(v.get("length")):(s.push(v.get(Ht)),Yt(e)&&s.push(v.get(or)));break;case"delete":ae(e)||(s.push(v.get(Ht)),Yt(e)&&s.push(v.get(or)));break;case"set":Yt(e)&&s.push(v.get(Ht));break}if(s.length===1)s[0]&&ar(s[0]);else{const l=[];for(const a of s)a&&l.push(...a);ar(Ir(l))}}function ar(e,t){const i=ae(e)?e:[...e];for(const r of i)r.computed&&on(r);for(const r of i)r.computed||on(r)}function on(e,t){(e!==Xe||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const kl=Rr("__proto__,__v_isRef,__isVue"),Mo=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Dr)),Rl=Or(),Al=Or(!1,!0),Ll=Or(!0),an=Dl();function Dl(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...i){const r=ge(this);for(let d=0,v=this.length;d<v;d++)We(r,"get",d+"");const o=r[t](...i);return o===-1||o===!1?r[t](...i.map(ge)):o}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...i){ai();const r=ge(this)[t].apply(this,i);return li(),r}}),e}function Tl(e){const t=ge(this);return We(t,"has",e),t.hasOwnProperty(e)}function Or(e=!1,t=!1){return function(r,o,d){if(o==="__v_isReactive")return!e;if(o==="__v_isReadonly")return e;if(o==="__v_isShallow")return t;if(o==="__v_raw"&&d===(e?t?ql:Fo:t?Ho:Bo).get(r))return r;const v=ae(r);if(!e){if(v&&ue(an,o))return Reflect.get(an,o,d);if(o==="hasOwnProperty")return Tl}const s=Reflect.get(r,o,d);return(Dr(o)?Mo.has(o):kl(o))||(e||We(r,"get",o),t)?s:Me(s)?v&&Tr(o)?s:s.value:ye(s)?e?Uo(s):Hr(s):s}}const Il=Oo(),Ml=Oo(!0);function Oo(e=!1){return function(i,r,o,d){let v=i[r];if(ti(v)&&Me(v)&&!Me(o))return!1;if(!e&&(!ds(o)&&!ti(o)&&(v=ge(v),o=ge(o)),!ae(i)&&Me(v)&&!Me(o)))return v.value=o,!0;const s=ae(i)&&Tr(r)?Number(r)<i.length:ue(i,r),l=Reflect.set(i,r,o,d);return i===ge(d)&&(s?ki(o,v)&&ut(i,"set",r,o):ut(i,"add",r,o)),l}}function Ol(e,t){const i=ue(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&i&&ut(e,"delete",t,void 0),r}function Pl(e,t){const i=Reflect.has(e,t);return(!Dr(t)||!Mo.has(t))&&We(e,"has",t),i}function Bl(e){return We(e,"iterate",ae(e)?"length":Ht),Reflect.ownKeys(e)}const Po={get:Rl,set:Il,deleteProperty:Ol,has:Pl,ownKeys:Bl},Hl={get:Ll,set(e,t){return!0},deleteProperty(e,t){return!0}},Fl=Te({},Po,{get:Al,set:Ml}),Pr=e=>e,Es=e=>Reflect.getPrototypeOf(e);function ji(e,t,i=!1,r=!1){e=e.__v_raw;const o=ge(e),d=ge(t);i||(t!==d&&We(o,"get",t),We(o,"get",d));const{has:v}=Es(o),s=r?Pr:i?Ur:Ri;if(v.call(o,t))return s(e.get(t));if(v.call(o,d))return s(e.get(d));e!==o&&e.get(t)}function Ki(e,t=!1){const i=this.__v_raw,r=ge(i),o=ge(e);return t||(e!==o&&We(r,"has",e),We(r,"has",o)),e===o?i.has(e):i.has(e)||i.has(o)}function Zi(e,t=!1){return e=e.__v_raw,!t&&We(ge(e),"iterate",Ht),Reflect.get(e,"size",e)}function ln(e){e=ge(e);const t=ge(this);return Es(t).has.call(t,e)||(t.add(e),ut(t,"add",e,e)),this}function hn(e,t){t=ge(t);const i=ge(this),{has:r,get:o}=Es(i);let d=r.call(i,e);d||(e=ge(e),d=r.call(i,e));const v=o.call(i,e);return i.set(e,t),d?ki(t,v)&&ut(i,"set",e,t):ut(i,"add",e,t),this}function cn(e){const t=ge(this),{has:i,get:r}=Es(t);let o=i.call(t,e);o||(e=ge(e),o=i.call(t,e)),r&&r.call(t,e);const d=t.delete(e);return o&&ut(t,"delete",e,void 0),d}function dn(){const e=ge(this),t=e.size!==0,i=e.clear();return t&&ut(e,"clear",void 0,void 0),i}function qi(e,t){return function(r,o){const d=this,v=d.__v_raw,s=ge(v),l=t?Pr:e?Ur:Ri;return!e&&We(s,"iterate",Ht),v.forEach((a,u)=>r.call(o,l(a),l(u),d))}}function Vi(e,t,i){return function(...r){const o=this.__v_raw,d=ge(o),v=Yt(d),s=e==="entries"||e===Symbol.iterator&&v,l=e==="keys"&&v,a=o[e](...r),u=i?Pr:t?Ur:Ri;return!t&&We(d,"iterate",l?or:Ht),{next(){const{value:_,done:g}=a.next();return g?{value:_,done:g}:{value:s?[u(_[0]),u(_[1])]:u(_),done:g}},[Symbol.iterator](){return this}}}}function gt(e){return function(...t){return e==="delete"?!1:this}}function Ul(){const e={get(d){return ji(this,d)},get size(){return Zi(this)},has:Ki,add:ln,set:hn,delete:cn,clear:dn,forEach:qi(!1,!1)},t={get(d){return ji(this,d,!1,!0)},get size(){return Zi(this)},has:Ki,add:ln,set:hn,delete:cn,clear:dn,forEach:qi(!1,!0)},i={get(d){return ji(this,d,!0)},get size(){return Zi(this,!0)},has(d){return Ki.call(this,d,!0)},add:gt("add"),set:gt("set"),delete:gt("delete"),clear:gt("clear"),forEach:qi(!0,!1)},r={get(d){return ji(this,d,!0,!0)},get size(){return Zi(this,!0)},has(d){return Ki.call(this,d,!0)},add:gt("add"),set:gt("set"),delete:gt("delete"),clear:gt("clear"),forEach:qi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{e[d]=Vi(d,!1,!1),i[d]=Vi(d,!0,!1),t[d]=Vi(d,!1,!0),r[d]=Vi(d,!0,!0)}),[e,i,t,r]}const[Nl,Wl,zl,$l]=Ul();function Br(e,t){const i=t?e?$l:zl:e?Wl:Nl;return(r,o,d)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?r:Reflect.get(ue(i,o)&&o in r?i:r,o,d)}const jl={get:Br(!1,!1)},Kl={get:Br(!1,!0)},Zl={get:Br(!0,!1)},Bo=new WeakMap,Ho=new WeakMap,Fo=new WeakMap,ql=new WeakMap;function Vl(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Gl(e){return e.__v_skip||!Object.isExtensible(e)?0:Vl(dl(e))}function Hr(e){return ti(e)?e:Fr(e,!1,Po,jl,Bo)}function Xl(e){return Fr(e,!1,Fl,Kl,Ho)}function Uo(e){return Fr(e,!0,Hl,Zl,Fo)}function Fr(e,t,i,r,o){if(!ye(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const d=o.get(e);if(d)return d;const v=Gl(e);if(v===0)return e;const s=new Proxy(e,v===2?r:i);return o.set(e,s),s}function Jt(e){return ti(e)?Jt(e.__v_raw):!!(e&&e.__v_isReactive)}function ti(e){return!!(e&&e.__v_isReadonly)}function ds(e){return!!(e&&e.__v_isShallow)}function No(e){return Jt(e)||ti(e)}function ge(e){const t=e&&e.__v_raw;return t?ge(t):e}function Wo(e){return cs(e,"__v_skip",!0),e}const Ri=e=>ye(e)?Hr(e):e,Ur=e=>ye(e)?Uo(e):e;function zo(e){wt&&Xe&&(e=ge(e),Io(e.dep||(e.dep=Ir())))}function Nr(e,t){e=ge(e);const i=e.dep;i&&ar(i)}function Me(e){return!!(e&&e.__v_isRef===!0)}function Bs(e){return $o(e,!1)}function Yl(e){return $o(e,!0)}function $o(e,t){return Me(e)?e:new Jl(e,t)}class Jl{constructor(t,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?t:ge(t),this._value=i?t:Ri(t)}get value(){return zo(this),this._value}set value(t){const i=this.__v_isShallow||ds(t)||ti(t);t=i?t:ge(t),ki(t,this._rawValue)&&(this._rawValue=t,this._value=i?t:Ri(t),Nr(this))}}function Ql(e){Nr(e)}function eh(e){return Me(e)?e.value:e}const th={get:(e,t,i)=>eh(Reflect.get(e,t,i)),set:(e,t,i,r)=>{const o=e[t];return Me(o)&&!Me(i)?(o.value=i,!0):Reflect.set(e,t,i,r)}};function jo(e){return Jt(e)?e:new Proxy(e,th)}class ih{constructor(t,i,r,o){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Mr(t,()=>{this._dirty||(this._dirty=!0,Nr(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=r}get value(){const t=ge(this);return zo(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function sh(e,t,i=!1){let r,o;const d=ce(e);return d?(r=e,o=Je):(r=e.get,o=e.set),new ih(r,o,d||!o,i)}function yt(e,t,i,r){let o;try{o=r?e(...r):e()}catch(d){xs(d,t,i)}return o}function Qe(e,t,i,r){if(ce(e)){const d=yt(e,t,i,r);return d&&Eo(d)&&d.catch(v=>{xs(v,t,i)}),d}const o=[];for(let d=0;d<e.length;d++)o.push(Qe(e[d],t,i,r));return o}function xs(e,t,i,r=!0){const o=t?t.vnode:null;if(t){let d=t.parent;const v=t.proxy,s=i;for(;d;){const a=d.ec;if(a){for(let u=0;u<a.length;u++)if(a[u](e,v,s)===!1)return}d=d.parent}const l=t.appContext.config.errorHandler;if(l){yt(l,null,10,[e,v,s]);return}}rh(e,i,o,r)}function rh(e,t,i,r=!0){console.error(e)}let Ai=!1,lr=!1;const Ie=[];let nt=0;const Qt=[];let dt=null,It=0;const Ko=Promise.resolve();let Wr=null;function nh(e){const t=Wr||Ko;return e?t.then(this?e.bind(this):e):t}function oh(e){let t=nt+1,i=Ie.length;for(;t<i;){const r=t+i>>>1;Li(Ie[r])<e?t=r+1:i=r}return t}function zr(e){(!Ie.length||!Ie.includes(e,Ai&&e.allowRecurse?nt+1:nt))&&(e.id==null?Ie.push(e):Ie.splice(oh(e.id),0,e),Zo())}function Zo(){!Ai&&!lr&&(lr=!0,Wr=Ko.then(Vo))}function ah(e){const t=Ie.indexOf(e);t>nt&&Ie.splice(t,1)}function lh(e){ae(e)?Qt.push(...e):(!dt||!dt.includes(e,e.allowRecurse?It+1:It))&&Qt.push(e),Zo()}function fn(e,t=Ai?nt+1:0){for(;t<Ie.length;t++){const i=Ie[t];i&&i.pre&&(Ie.splice(t,1),t--,i())}}function qo(e){if(Qt.length){const t=[...new Set(Qt)];if(Qt.length=0,dt){dt.push(...t);return}for(dt=t,dt.sort((i,r)=>Li(i)-Li(r)),It=0;It<dt.length;It++)dt[It]();dt=null,It=0}}const Li=e=>e.id==null?1/0:e.id,hh=(e,t)=>{const i=Li(e)-Li(t);if(i===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return i};function Vo(e){lr=!1,Ai=!0,Ie.sort(hh);const t=Je;try{for(nt=0;nt<Ie.length;nt++){const i=Ie[nt];i&&i.active!==!1&&yt(i,null,14)}}finally{nt=0,Ie.length=0,qo(),Ai=!1,Wr=null,(Ie.length||Qt.length)&&Vo()}}function ch(e,t,...i){if(e.isUnmounted)return;const r=e.vnode.props||we;let o=i;const d=t.startsWith("update:"),v=d&&t.slice(7);if(v&&v in r){const u=`${v==="modelValue"?"model":v}Modifiers`,{number:_,trim:g}=r[u]||we;g&&(o=i.map(S=>ke(S)?S.trim():S)),_&&(o=i.map(ul))}let s,l=r[s=Os(t)]||r[s=Os(ht(t))];!l&&d&&(l=r[s=Os(oi(t))]),l&&Qe(l,e,6,o);const a=r[s+"Once"];if(a){if(!e.emitted)e.emitted={};else if(e.emitted[s])return;e.emitted[s]=!0,Qe(a,e,6,o)}}function Go(e,t,i=!1){const r=t.emitsCache,o=r.get(e);if(o!==void 0)return o;const d=e.emits;let v={},s=!1;if(!ce(e)){const l=a=>{const u=Go(a,t,!0);u&&(s=!0,Te(v,u))};!i&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!d&&!s?(ye(e)&&r.set(e,null),null):(ae(d)?d.forEach(l=>v[l]=null):Te(v,d),ye(e)&&r.set(e,v),v)}function ks(e,t){return!e||!Ss(t)?!1:(t=t.slice(2).replace(/Once$/,""),ue(e,t[0].toLowerCase()+t.slice(1))||ue(e,oi(t))||ue(e,t))}let Be=null,Rs=null;function fs(e){const t=Be;return Be=e,Rs=e&&e.type.__scopeId||null,t}function Xo(e){Rs=e}function Yo(){Rs=null}function Jo(e,t=Be,i){if(!t||e._n)return e;const r=(...o)=>{r._d&&Cn(-1);const d=fs(t);let v;try{v=e(...o)}finally{fs(d),r._d&&Cn(1)}return v};return r._n=!0,r._c=!0,r._d=!0,r}function Hs(e){const{type:t,vnode:i,proxy:r,withProxy:o,props:d,propsOptions:[v],slots:s,attrs:l,emit:a,render:u,renderCache:_,data:g,setupState:S,ctx:y,inheritAttrs:w}=e;let n,f;const h=fs(e);try{if(i.shapeFlag&4){const p=o||r;n=st(u.call(p,p,_,d,S,g,y)),f=l}else{const p=t;n=st(p.length>1?p(d,{attrs:l,slots:s,emit:a}):p(d,null)),f=t.props?l:dh(l)}}catch(p){yi.length=0,xs(p,e,1),n=Fe(Rt)}let c=n;if(f&&w!==!1){const p=Object.keys(f),{shapeFlag:b}=c;p.length&&b&7&&(v&&p.some(Ar)&&(f=fh(f,v)),c=ii(c,f))}return i.dirs&&(c=ii(c),c.dirs=c.dirs?c.dirs.concat(i.dirs):i.dirs),i.transition&&(c.transition=i.transition),n=c,fs(h),n}const dh=e=>{let t;for(const i in e)(i==="class"||i==="style"||Ss(i))&&((t||(t={}))[i]=e[i]);return t},fh=(e,t)=>{const i={};for(const r in e)(!Ar(r)||!(r.slice(9)in t))&&(i[r]=e[r]);return i};function _h(e,t,i){const{props:r,children:o,component:d}=e,{props:v,children:s,patchFlag:l}=t,a=d.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&l>=0){if(l&1024)return!0;if(l&16)return r?_n(r,v,a):!!v;if(l&8){const u=t.dynamicProps;for(let _=0;_<u.length;_++){const g=u[_];if(v[g]!==r[g]&&!ks(a,g))return!0}}}else return(o||s)&&(!s||!s.$stable)?!0:r===v?!1:r?v?_n(r,v,a):!0:!!v;return!1}function _n(e,t,i){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let o=0;o<r.length;o++){const d=r[o];if(t[d]!==e[d]&&!ks(i,d))return!0}return!1}function uh({vnode:e,parent:t},i){for(;t&&t.subTree===e;)(e=t.vnode).el=i,t=t.parent}const ph=e=>e.__isSuspense;function gh(e,t){t&&t.pendingBranch?ae(e)?t.effects.push(...e):t.effects.push(e):lh(e)}const Gi={};function Fs(e,t,i){return Qo(e,t,i)}function Qo(e,t,{immediate:i,deep:r,flush:o,onTrack:d,onTrigger:v}=we){var s;const l=Cl()===((s=De)==null?void 0:s.scope)?De:null;let a,u=!1,_=!1;if(Me(e)?(a=()=>e.value,u=ds(e)):Jt(e)?(a=()=>e,r=!0):ae(e)?(_=!0,u=e.some(p=>Jt(p)||ds(p)),a=()=>e.map(p=>{if(Me(p))return p.value;if(Jt(p))return Vt(p);if(ce(p))return yt(p,l,2)})):ce(e)?t?a=()=>yt(e,l,2):a=()=>{if(!(l&&l.isUnmounted))return g&&g(),Qe(e,l,3,[S])}:a=Je,t&&r){const p=a;a=()=>Vt(p())}let g,S=p=>{g=h.onStop=()=>{yt(p,l,4)}},y;if(Ti)if(S=Je,t?i&&Qe(t,l,3,[a(),_?[]:void 0,S]):a(),o==="sync"){const p=fc();y=p.__watcherHandles||(p.__watcherHandles=[])}else return Je;let w=_?new Array(e.length).fill(Gi):Gi;const n=()=>{if(h.active)if(t){const p=h.run();(r||u||(_?p.some((b,E)=>ki(b,w[E])):ki(p,w)))&&(g&&g(),Qe(t,l,3,[p,w===Gi?void 0:_&&w[0]===Gi?[]:w,S]),w=p)}else h.run()};n.allowRecurse=!!t;let f;o==="sync"?f=n:o==="post"?f=()=>Ue(n,l&&l.suspense):(n.pre=!0,l&&(n.id=l.uid),f=()=>zr(n));const h=new Mr(a,f);t?i?n():w=h.run():o==="post"?Ue(h.run.bind(h),l&&l.suspense):h.run();const c=()=>{h.stop(),l&&l.scope&&Lr(l.scope.effects,h)};return y&&y.push(c),c}function vh(e,t,i){const r=this.proxy,o=ke(e)?e.includes(".")?ea(r,e):()=>r[e]:e.bind(r,r);let d;ce(t)?d=t:(d=t.handler,i=t);const v=De;si(this);const s=Qo(o,d.bind(r),i);return v?si(v):Ft(),s}function ea(e,t){const i=t.split(".");return()=>{let r=e;for(let o=0;o<i.length&&r;o++)r=r[i[o]];return r}}function Vt(e,t){if(!ye(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Me(e))Vt(e.value,t);else if(ae(e))for(let i=0;i<e.length;i++)Vt(e[i],t);else if(Co(e)||Yt(e))e.forEach(i=>{Vt(i,t)});else if(ko(e))for(const i in e)Vt(e[i],t);return e}function Lt(e,t,i,r){const o=e.dirs,d=t&&t.dirs;for(let v=0;v<o.length;v++){const s=o[v];d&&(s.oldValue=d[v].value);let l=s.dir[r];l&&(ai(),Qe(l,i,8,[e.el,s,e,t]),li())}}const bi=e=>!!e.type.__asyncLoader,ta=e=>e.type.__isKeepAlive;function mh(e,t){ia(e,"a",t)}function Sh(e,t){ia(e,"da",t)}function ia(e,t,i=De){const r=e.__wdc||(e.__wdc=()=>{let o=i;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(As(t,r,i),i){let o=i.parent;for(;o&&o.parent;)ta(o.parent.vnode)&&bh(r,t,i,o),o=o.parent}}function bh(e,t,i,r){const o=As(t,e,r,!0);sa(()=>{Lr(r[t],o)},i)}function As(e,t,i=De,r=!1){if(i){const o=i[e]||(i[e]=[]),d=t.__weh||(t.__weh=(...v)=>{if(i.isUnmounted)return;ai(),si(i);const s=Qe(t,i,e,v);return Ft(),li(),s});return r?o.unshift(d):o.push(d),d}}const pt=e=>(t,i=De)=>(!Ti||e==="sp")&&As(e,(...r)=>t(...r),i),wh=pt("bm"),yh=pt("m"),Ch=pt("bu"),Eh=pt("u"),xh=pt("bum"),sa=pt("um"),kh=pt("sp"),Rh=pt("rtg"),Ah=pt("rtc");function Lh(e,t=De){As("ec",e,t)}const ra="components";function ss(e,t){return Th(ra,e,!0,t)||e}const Dh=Symbol.for("v-ndc");function Th(e,t,i=!0,r=!1){const o=Be||De;if(o){const d=o.type;if(e===ra){const s=hc(d,!1);if(s&&(s===t||s===ht(t)||s===ys(ht(t))))return d}const v=un(o[e]||d[e],t)||un(o.appContext[e],t);return!v&&r?d:v}}function un(e,t){return e&&(e[t]||e[ht(t)]||e[ys(ht(t))])}function Ih(e,t,i={},r,o){if(Be.isCE||Be.parent&&bi(Be.parent)&&Be.parent.isCE)return t!=="default"&&(i.name=t),Fe("slot",i,r&&r());let d=e[t];d&&d._c&&(d._d=!1),Le();const v=d&&na(d(i)),s=ps(xe,{key:i.key||v&&v.key||`_${t}`},v||(r?r():[]),v&&e._===1?64:-2);return!o&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),d&&d._c&&(d._d=!0),s}function na(e){return e.some(t=>pa(t)?!(t.type===Rt||t.type===xe&&!na(t.children)):!0)?e:null}const hr=e=>e?va(e)?qr(e)||e.proxy:hr(e.parent):null,wi=Te(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>hr(e.parent),$root:e=>hr(e.root),$emit:e=>e.emit,$options:e=>$r(e),$forceUpdate:e=>e.f||(e.f=()=>zr(e.update)),$nextTick:e=>e.n||(e.n=nh.bind(e.proxy)),$watch:e=>vh.bind(e)}),Us=(e,t)=>e!==we&&!e.__isScriptSetup&&ue(e,t),Mh={get({_:e},t){const{ctx:i,setupState:r,data:o,props:d,accessCache:v,type:s,appContext:l}=e;let a;if(t[0]!=="$"){const S=v[t];if(S!==void 0)switch(S){case 1:return r[t];case 2:return o[t];case 4:return i[t];case 3:return d[t]}else{if(Us(r,t))return v[t]=1,r[t];if(o!==we&&ue(o,t))return v[t]=2,o[t];if((a=e.propsOptions[0])&&ue(a,t))return v[t]=3,d[t];if(i!==we&&ue(i,t))return v[t]=4,i[t];cr&&(v[t]=0)}}const u=wi[t];let _,g;if(u)return t==="$attrs"&&We(e,"get",t),u(e);if((_=s.__cssModules)&&(_=_[t]))return _;if(i!==we&&ue(i,t))return v[t]=4,i[t];if(g=l.config.globalProperties,ue(g,t))return g[t]},set({_:e},t,i){const{data:r,setupState:o,ctx:d}=e;return Us(o,t)?(o[t]=i,!0):r!==we&&ue(r,t)?(r[t]=i,!0):ue(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(d[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:r,appContext:o,propsOptions:d}},v){let s;return!!i[v]||e!==we&&ue(e,v)||Us(t,v)||(s=d[0])&&ue(s,v)||ue(r,v)||ue(wi,v)||ue(o.config.globalProperties,v)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:ue(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function pn(e){return ae(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let cr=!0;function Oh(e){const t=$r(e),i=e.proxy,r=e.ctx;cr=!1,t.beforeCreate&&gn(t.beforeCreate,e,"bc");const{data:o,computed:d,methods:v,watch:s,provide:l,inject:a,created:u,beforeMount:_,mounted:g,beforeUpdate:S,updated:y,activated:w,deactivated:n,beforeDestroy:f,beforeUnmount:h,destroyed:c,unmounted:p,render:b,renderTracked:E,renderTriggered:x,errorCaptured:m,serverPrefetch:C,expose:A,inheritAttrs:T,components:D,directives:O,filters:U}=t;if(a&&Ph(a,r,null),v)for(const N in v){const k=v[N];ce(k)&&(r[N]=k.bind(i))}if(o){const N=o.call(i,i);ye(N)&&(e.data=Hr(N))}if(cr=!0,d)for(const N in d){const k=d[N],I=ce(k)?k.bind(i,i):ce(k.get)?k.get.bind(i,i):Je,M=!ce(k)&&ce(k.set)?k.set.bind(i):Je,B=ur({get:I,set:M});Object.defineProperty(r,N,{enumerable:!0,configurable:!0,get:()=>B.value,set:V=>B.value=V})}if(s)for(const N in s)oa(s[N],r,i,N);if(l){const N=ce(l)?l.call(i):l;Reflect.ownKeys(N).forEach(k=>{Wh(k,N[k])})}u&&gn(u,e,"c");function Z(N,k){ae(k)?k.forEach(I=>N(I.bind(i))):k&&N(k.bind(i))}if(Z(wh,_),Z(yh,g),Z(Ch,S),Z(Eh,y),Z(mh,w),Z(Sh,n),Z(Lh,m),Z(Ah,E),Z(Rh,x),Z(xh,h),Z(sa,p),Z(kh,C),ae(A))if(A.length){const N=e.exposed||(e.exposed={});A.forEach(k=>{Object.defineProperty(N,k,{get:()=>i[k],set:I=>i[k]=I})})}else e.exposed||(e.exposed={});b&&e.render===Je&&(e.render=b),T!=null&&(e.inheritAttrs=T),D&&(e.components=D),O&&(e.directives=O)}function Ph(e,t,i=Je){ae(e)&&(e=dr(e));for(const r in e){const o=e[r];let d;ye(o)?"default"in o?d=rs(o.from||r,o.default,!0):d=rs(o.from||r):d=rs(o),Me(d)?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>d.value,set:v=>d.value=v}):t[r]=d}}function gn(e,t,i){Qe(ae(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,i)}function oa(e,t,i,r){const o=r.includes(".")?ea(i,r):()=>i[r];if(ke(e)){const d=t[e];ce(d)&&Fs(o,d)}else if(ce(e))Fs(o,e.bind(i));else if(ye(e))if(ae(e))e.forEach(d=>oa(d,t,i,r));else{const d=ce(e.handler)?e.handler.bind(i):t[e.handler];ce(d)&&Fs(o,d,e)}}function $r(e){const t=e.type,{mixins:i,extends:r}=t,{mixins:o,optionsCache:d,config:{optionMergeStrategies:v}}=e.appContext,s=d.get(t);let l;return s?l=s:!o.length&&!i&&!r?l=t:(l={},o.length&&o.forEach(a=>_s(l,a,v,!0)),_s(l,t,v)),ye(t)&&d.set(t,l),l}function _s(e,t,i,r=!1){const{mixins:o,extends:d}=t;d&&_s(e,d,i,!0),o&&o.forEach(v=>_s(e,v,i,!0));for(const v in t)if(!(r&&v==="expose")){const s=Bh[v]||i&&i[v];e[v]=s?s(e[v],t[v]):t[v]}return e}const Bh={data:vn,props:mn,emits:mn,methods:vi,computed:vi,beforeCreate:Pe,created:Pe,beforeMount:Pe,mounted:Pe,beforeUpdate:Pe,updated:Pe,beforeDestroy:Pe,beforeUnmount:Pe,destroyed:Pe,unmounted:Pe,activated:Pe,deactivated:Pe,errorCaptured:Pe,serverPrefetch:Pe,components:vi,directives:vi,watch:Fh,provide:vn,inject:Hh};function vn(e,t){return t?e?function(){return Te(ce(e)?e.call(this,this):e,ce(t)?t.call(this,this):t)}:t:e}function Hh(e,t){return vi(dr(e),dr(t))}function dr(e){if(ae(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function Pe(e,t){return e?[...new Set([].concat(e,t))]:t}function vi(e,t){return e?Te(Object.create(null),e,t):t}function mn(e,t){return e?ae(e)&&ae(t)?[...new Set([...e,...t])]:Te(Object.create(null),pn(e),pn(t??{})):t}function Fh(e,t){if(!e)return t;if(!t)return e;const i=Te(Object.create(null),e);for(const r in t)i[r]=Pe(e[r],t[r]);return i}function aa(){return{app:null,config:{isNativeTag:ll,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Uh=0;function Nh(e,t){return function(r,o=null){ce(r)||(r=Te({},r)),o!=null&&!ye(o)&&(o=null);const d=aa(),v=new Set;let s=!1;const l=d.app={_uid:Uh++,_component:r,_props:o,_container:null,_context:d,_instance:null,version:_c,get config(){return d.config},set config(a){},use(a,...u){return v.has(a)||(a&&ce(a.install)?(v.add(a),a.install(l,...u)):ce(a)&&(v.add(a),a(l,...u))),l},mixin(a){return d.mixins.includes(a)||d.mixins.push(a),l},component(a,u){return u?(d.components[a]=u,l):d.components[a]},directive(a,u){return u?(d.directives[a]=u,l):d.directives[a]},mount(a,u,_){if(!s){const g=Fe(r,o);return g.appContext=d,u&&t?t(g,a):e(g,a,_),s=!0,l._container=a,a.__vue_app__=l,qr(g.component)||g.component.proxy}},unmount(){s&&(e(null,l._container),delete l._container.__vue_app__)},provide(a,u){return d.provides[a]=u,l},runWithContext(a){us=l;try{return a()}finally{us=null}}};return l}}let us=null;function Wh(e,t){if(De){let i=De.provides;const r=De.parent&&De.parent.provides;r===i&&(i=De.provides=Object.create(r)),i[e]=t}}function rs(e,t,i=!1){const r=De||Be;if(r||us){const o=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:us._context.provides;if(o&&e in o)return o[e];if(arguments.length>1)return i&&ce(t)?t.call(r&&r.proxy):t}}function zh(e,t,i,r=!1){const o={},d={};cs(d,Ds,1),e.propsDefaults=Object.create(null),la(e,t,o,d);for(const v in e.propsOptions[0])v in o||(o[v]=void 0);i?e.props=r?o:Xl(o):e.type.props?e.props=o:e.props=d,e.attrs=d}function $h(e,t,i,r){const{props:o,attrs:d,vnode:{patchFlag:v}}=e,s=ge(o),[l]=e.propsOptions;let a=!1;if((r||v>0)&&!(v&16)){if(v&8){const u=e.vnode.dynamicProps;for(let _=0;_<u.length;_++){let g=u[_];if(ks(e.emitsOptions,g))continue;const S=t[g];if(l)if(ue(d,g))S!==d[g]&&(d[g]=S,a=!0);else{const y=ht(g);o[y]=fr(l,s,y,S,e,!1)}else S!==d[g]&&(d[g]=S,a=!0)}}}else{la(e,t,o,d)&&(a=!0);let u;for(const _ in s)(!t||!ue(t,_)&&((u=oi(_))===_||!ue(t,u)))&&(l?i&&(i[_]!==void 0||i[u]!==void 0)&&(o[_]=fr(l,s,_,void 0,e,!0)):delete o[_]);if(d!==s)for(const _ in d)(!t||!ue(t,_))&&(delete d[_],a=!0)}a&&ut(e,"set","$attrs")}function la(e,t,i,r){const[o,d]=e.propsOptions;let v=!1,s;if(t)for(let l in t){if(is(l))continue;const a=t[l];let u;o&&ue(o,u=ht(l))?!d||!d.includes(u)?i[u]=a:(s||(s={}))[u]=a:ks(e.emitsOptions,l)||(!(l in r)||a!==r[l])&&(r[l]=a,v=!0)}if(d){const l=ge(i),a=s||we;for(let u=0;u<d.length;u++){const _=d[u];i[_]=fr(o,l,_,a[_],e,!ue(a,_))}}return v}function fr(e,t,i,r,o,d){const v=e[i];if(v!=null){const s=ue(v,"default");if(s&&r===void 0){const l=v.default;if(v.type!==Function&&!v.skipFactory&&ce(l)){const{propsDefaults:a}=o;i in a?r=a[i]:(si(o),r=a[i]=l.call(null,t),Ft())}else r=l}v[0]&&(d&&!s?r=!1:v[1]&&(r===""||r===oi(i))&&(r=!0))}return r}function ha(e,t,i=!1){const r=t.propsCache,o=r.get(e);if(o)return o;const d=e.props,v={},s=[];let l=!1;if(!ce(e)){const u=_=>{l=!0;const[g,S]=ha(_,t,!0);Te(v,g),S&&s.push(...S)};!i&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!d&&!l)return ye(e)&&r.set(e,Xt),Xt;if(ae(d))for(let u=0;u<d.length;u++){const _=ht(d[u]);Sn(_)&&(v[_]=we)}else if(d)for(const u in d){const _=ht(u);if(Sn(_)){const g=d[u],S=v[_]=ae(g)||ce(g)?{type:g}:Te({},g);if(S){const y=yn(Boolean,S.type),w=yn(String,S.type);S[0]=y>-1,S[1]=w<0||y<w,(y>-1||ue(S,"default"))&&s.push(_)}}}const a=[v,s];return ye(e)&&r.set(e,a),a}function Sn(e){return e[0]!=="$"}function bn(e){const t=e&&e.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:e===null?"null":""}function wn(e,t){return bn(e)===bn(t)}function yn(e,t){return ae(t)?t.findIndex(i=>wn(i,e)):ce(t)&&wn(t,e)?0:-1}const ca=e=>e[0]==="_"||e==="$stable",jr=e=>ae(e)?e.map(st):[st(e)],jh=(e,t,i)=>{if(t._n)return t;const r=Jo((...o)=>jr(t(...o)),i);return r._c=!1,r},da=(e,t,i)=>{const r=e._ctx;for(const o in e){if(ca(o))continue;const d=e[o];if(ce(d))t[o]=jh(o,d,r);else if(d!=null){const v=jr(d);t[o]=()=>v}}},fa=(e,t)=>{const i=jr(t);e.slots.default=()=>i},Kh=(e,t)=>{if(e.vnode.shapeFlag&32){const i=t._;i?(e.slots=ge(t),cs(t,"_",i)):da(t,e.slots={})}else e.slots={},t&&fa(e,t);cs(e.slots,Ds,1)},Zh=(e,t,i)=>{const{vnode:r,slots:o}=e;let d=!0,v=we;if(r.shapeFlag&32){const s=t._;s?i&&s===1?d=!1:(Te(o,t),!i&&s===1&&delete o._):(d=!t.$stable,da(t,o)),v=t}else t&&(fa(e,t),v={default:1});if(d)for(const s in o)!ca(s)&&!(s in v)&&delete o[s]};function _r(e,t,i,r,o=!1){if(ae(e)){e.forEach((g,S)=>_r(g,t&&(ae(t)?t[S]:t),i,r,o));return}if(bi(r)&&!o)return;const d=r.shapeFlag&4?qr(r.component)||r.component.proxy:r.el,v=o?null:d,{i:s,r:l}=e,a=t&&t.r,u=s.refs===we?s.refs={}:s.refs,_=s.setupState;if(a!=null&&a!==l&&(ke(a)?(u[a]=null,ue(_,a)&&(_[a]=null)):Me(a)&&(a.value=null)),ce(l))yt(l,s,12,[v,u]);else{const g=ke(l),S=Me(l);if(g||S){const y=()=>{if(e.f){const w=g?ue(_,l)?_[l]:u[l]:l.value;o?ae(w)&&Lr(w,d):ae(w)?w.includes(d)||w.push(d):g?(u[l]=[d],ue(_,l)&&(_[l]=u[l])):(l.value=[d],e.k&&(u[e.k]=l.value))}else g?(u[l]=v,ue(_,l)&&(_[l]=v)):S&&(l.value=v,e.k&&(u[e.k]=v))};v?(y.id=-1,Ue(y,i)):y()}}}const Ue=gh;function qh(e){return Vh(e)}function Vh(e,t){const i=ir();i.__VUE__=!0;const{insert:r,remove:o,patchProp:d,createElement:v,createText:s,createComment:l,setText:a,setElementText:u,parentNode:_,nextSibling:g,setScopeId:S=Je,insertStaticContent:y}=e,w=(L,P,F,K=null,q=null,W=null,J=!1,X=null,Y=!!P.dynamicChildren)=>{if(L===P)return;L&&!_i(L,P)&&(K=R(L),V(L,q,W,!0),L=null),P.patchFlag===-2&&(Y=!1,P.dynamicChildren=null);const{type:G,ref:se,shapeFlag:ee}=P;switch(G){case Ls:n(L,P,F,K);break;case Rt:f(L,P,F,K);break;case ns:L==null&&h(P,F,K,J);break;case xe:D(L,P,F,K,q,W,J,X,Y);break;default:ee&1?b(L,P,F,K,q,W,J,X,Y):ee&6?O(L,P,F,K,q,W,J,X,Y):(ee&64||ee&128)&&G.process(L,P,F,K,q,W,J,X,Y,z)}se!=null&&q&&_r(se,L&&L.ref,W,P||L,!P)},n=(L,P,F,K)=>{if(L==null)r(P.el=s(P.children),F,K);else{const q=P.el=L.el;P.children!==L.children&&a(q,P.children)}},f=(L,P,F,K)=>{L==null?r(P.el=l(P.children||""),F,K):P.el=L.el},h=(L,P,F,K)=>{[L.el,L.anchor]=y(L.children,P,F,K,L.el,L.anchor)},c=({el:L,anchor:P},F,K)=>{let q;for(;L&&L!==P;)q=g(L),r(L,F,K),L=q;r(P,F,K)},p=({el:L,anchor:P})=>{let F;for(;L&&L!==P;)F=g(L),o(L),L=F;o(P)},b=(L,P,F,K,q,W,J,X,Y)=>{J=J||P.type==="svg",L==null?E(P,F,K,q,W,J,X,Y):C(L,P,q,W,J,X,Y)},E=(L,P,F,K,q,W,J,X)=>{let Y,G;const{type:se,props:ee,shapeFlag:ie,transition:re,dirs:le}=L;if(Y=L.el=v(L.type,W,ee&&ee.is,ee),ie&8?u(Y,L.children):ie&16&&m(L.children,Y,null,K,q,W&&se!=="foreignObject",J,X),le&&Lt(L,null,K,"created"),x(Y,L,L.scopeId,J,K),ee){for(const de in ee)de!=="value"&&!is(de)&&d(Y,de,null,ee[de],W,L.children,K,q,_e);"value"in ee&&d(Y,"value",null,ee.value),(G=ee.onVnodeBeforeMount)&&tt(G,K,L)}le&&Lt(L,null,K,"beforeMount");const ve=(!q||q&&!q.pendingBranch)&&re&&!re.persisted;ve&&re.beforeEnter(Y),r(Y,P,F),((G=ee&&ee.onVnodeMounted)||ve||le)&&Ue(()=>{G&&tt(G,K,L),ve&&re.enter(Y),le&&Lt(L,null,K,"mounted")},q)},x=(L,P,F,K,q)=>{if(F&&S(L,F),K)for(let W=0;W<K.length;W++)S(L,K[W]);if(q){let W=q.subTree;if(P===W){const J=q.vnode;x(L,J,J.scopeId,J.slotScopeIds,q.parent)}}},m=(L,P,F,K,q,W,J,X,Y=0)=>{for(let G=Y;G<L.length;G++){const se=L[G]=X?vt(L[G]):st(L[G]);w(null,se,P,F,K,q,W,J,X)}},C=(L,P,F,K,q,W,J)=>{const X=P.el=L.el;let{patchFlag:Y,dynamicChildren:G,dirs:se}=P;Y|=L.patchFlag&16;const ee=L.props||we,ie=P.props||we;let re;F&&Dt(F,!1),(re=ie.onVnodeBeforeUpdate)&&tt(re,F,P,L),se&&Lt(P,L,F,"beforeUpdate"),F&&Dt(F,!0);const le=q&&P.type!=="foreignObject";if(G?A(L.dynamicChildren,G,X,F,K,le,W):J||k(L,P,X,null,F,K,le,W,!1),Y>0){if(Y&16)T(X,P,ee,ie,F,K,q);else if(Y&2&&ee.class!==ie.class&&d(X,"class",null,ie.class,q),Y&4&&d(X,"style",ee.style,ie.style,q),Y&8){const ve=P.dynamicProps;for(let de=0;de<ve.length;de++){const Se=ve[de],Ce=ee[Se],Ze=ie[Se];(Ze!==Ce||Se==="value")&&d(X,Se,Ce,Ze,q,L.children,F,K,_e)}}Y&1&&L.children!==P.children&&u(X,P.children)}else!J&&G==null&&T(X,P,ee,ie,F,K,q);((re=ie.onVnodeUpdated)||se)&&Ue(()=>{re&&tt(re,F,P,L),se&&Lt(P,L,F,"updated")},K)},A=(L,P,F,K,q,W,J)=>{for(let X=0;X<P.length;X++){const Y=L[X],G=P[X],se=Y.el&&(Y.type===xe||!_i(Y,G)||Y.shapeFlag&70)?_(Y.el):F;w(Y,G,se,null,K,q,W,J,!0)}},T=(L,P,F,K,q,W,J)=>{if(F!==K){if(F!==we)for(const X in F)!is(X)&&!(X in K)&&d(L,X,F[X],null,J,P.children,q,W,_e);for(const X in K){if(is(X))continue;const Y=K[X],G=F[X];Y!==G&&X!=="value"&&d(L,X,G,Y,J,P.children,q,W,_e)}"value"in K&&d(L,"value",F.value,K.value)}},D=(L,P,F,K,q,W,J,X,Y)=>{const G=P.el=L?L.el:s(""),se=P.anchor=L?L.anchor:s("");let{patchFlag:ee,dynamicChildren:ie,slotScopeIds:re}=P;re&&(X=X?X.concat(re):re),L==null?(r(G,F,K),r(se,F,K),m(P.children,F,se,q,W,J,X,Y)):ee>0&&ee&64&&ie&&L.dynamicChildren?(A(L.dynamicChildren,ie,F,q,W,J,X),(P.key!=null||q&&P===q.subTree)&&_a(L,P,!0)):k(L,P,F,se,q,W,J,X,Y)},O=(L,P,F,K,q,W,J,X,Y)=>{P.slotScopeIds=X,L==null?P.shapeFlag&512?q.ctx.activate(P,F,K,J,Y):U(P,F,K,q,W,J,Y):j(L,P,Y)},U=(L,P,F,K,q,W,J)=>{const X=L.component=rc(L,K,q);if(ta(L)&&(X.ctx.renderer=z),nc(X),X.asyncDep){if(q&&q.registerDep(X,Z),!L.el){const Y=X.subTree=Fe(Rt);f(null,Y,P,F)}return}Z(X,L,P,F,q,W,J)},j=(L,P,F)=>{const K=P.component=L.component;if(_h(L,P,F))if(K.asyncDep&&!K.asyncResolved){N(K,P,F);return}else K.next=P,ah(K.update),K.update();else P.el=L.el,K.vnode=P},Z=(L,P,F,K,q,W,J)=>{const X=()=>{if(L.isMounted){let{next:se,bu:ee,u:ie,parent:re,vnode:le}=L,ve=se,de;Dt(L,!1),se?(se.el=le.el,N(L,se,J)):se=le,ee&&Ps(ee),(de=se.props&&se.props.onVnodeBeforeUpdate)&&tt(de,re,se,le),Dt(L,!0);const Se=Hs(L),Ce=L.subTree;L.subTree=Se,w(Ce,Se,_(Ce.el),R(Ce),L,q,W),se.el=Se.el,ve===null&&uh(L,Se.el),ie&&Ue(ie,q),(de=se.props&&se.props.onVnodeUpdated)&&Ue(()=>tt(de,re,se,le),q)}else{let se;const{el:ee,props:ie}=P,{bm:re,m:le,parent:ve}=L,de=bi(P);if(Dt(L,!1),re&&Ps(re),!de&&(se=ie&&ie.onVnodeBeforeMount)&&tt(se,ve,P),Dt(L,!0),ee&&oe){const Se=()=>{L.subTree=Hs(L),oe(ee,L.subTree,L,q,null)};de?P.type.__asyncLoader().then(()=>!L.isUnmounted&&Se()):Se()}else{const Se=L.subTree=Hs(L);w(null,Se,F,K,L,q,W),P.el=Se.el}if(le&&Ue(le,q),!de&&(se=ie&&ie.onVnodeMounted)){const Se=P;Ue(()=>tt(se,ve,Se),q)}(P.shapeFlag&256||ve&&bi(ve.vnode)&&ve.vnode.shapeFlag&256)&&L.a&&Ue(L.a,q),L.isMounted=!0,P=F=K=null}},Y=L.effect=new Mr(X,()=>zr(G),L.scope),G=L.update=()=>Y.run();G.id=L.uid,Dt(L,!0),G()},N=(L,P,F)=>{P.component=L;const K=L.vnode.props;L.vnode=P,L.next=null,$h(L,P.props,K,F),Zh(L,P.children,F),ai(),fn(),li()},k=(L,P,F,K,q,W,J,X,Y=!1)=>{const G=L&&L.children,se=L?L.shapeFlag:0,ee=P.children,{patchFlag:ie,shapeFlag:re}=P;if(ie>0){if(ie&128){M(G,ee,F,K,q,W,J,X,Y);return}else if(ie&256){I(G,ee,F,K,q,W,J,X,Y);return}}re&8?(se&16&&_e(G,q,W),ee!==G&&u(F,ee)):se&16?re&16?M(G,ee,F,K,q,W,J,X,Y):_e(G,q,W,!0):(se&8&&u(F,""),re&16&&m(ee,F,K,q,W,J,X,Y))},I=(L,P,F,K,q,W,J,X,Y)=>{L=L||Xt,P=P||Xt;const G=L.length,se=P.length,ee=Math.min(G,se);let ie;for(ie=0;ie<ee;ie++){const re=P[ie]=Y?vt(P[ie]):st(P[ie]);w(L[ie],re,F,null,q,W,J,X,Y)}G>se?_e(L,q,W,!0,!1,ee):m(P,F,K,q,W,J,X,Y,ee)},M=(L,P,F,K,q,W,J,X,Y)=>{let G=0;const se=P.length;let ee=L.length-1,ie=se-1;for(;G<=ee&&G<=ie;){const re=L[G],le=P[G]=Y?vt(P[G]):st(P[G]);if(_i(re,le))w(re,le,F,null,q,W,J,X,Y);else break;G++}for(;G<=ee&&G<=ie;){const re=L[ee],le=P[ie]=Y?vt(P[ie]):st(P[ie]);if(_i(re,le))w(re,le,F,null,q,W,J,X,Y);else break;ee--,ie--}if(G>ee){if(G<=ie){const re=ie+1,le=re<se?P[re].el:K;for(;G<=ie;)w(null,P[G]=Y?vt(P[G]):st(P[G]),F,le,q,W,J,X,Y),G++}}else if(G>ie)for(;G<=ee;)V(L[G],q,W,!0),G++;else{const re=G,le=G,ve=new Map;for(G=le;G<=ie;G++){const ze=P[G]=Y?vt(P[G]):st(P[G]);ze.key!=null&&ve.set(ze.key,G)}let de,Se=0;const Ce=ie-le+1;let Ze=!1,me=0;const At=new Array(Ce);for(G=0;G<Ce;G++)At[G]=0;for(G=re;G<=ee;G++){const ze=L[G];if(Se>=Ce){V(ze,q,W,!0);continue}let et;if(ze.key!=null)et=ve.get(ze.key);else for(de=le;de<=ie;de++)if(At[de-le]===0&&_i(ze,P[de])){et=de;break}et===void 0?V(ze,q,W,!0):(At[et-le]=G+1,et>=me?me=et:Ze=!0,w(ze,P[et],F,null,q,W,J,X,Y),Se++)}const tn=Ze?Gh(At):Xt;for(de=tn.length-1,G=Ce-1;G>=0;G--){const ze=le+G,et=P[ze],sn=ze+1<se?P[ze+1].el:K;At[G]===0?w(null,et,F,sn,q,W,J,X,Y):Ze&&(de<0||G!==tn[de]?B(et,F,sn,2):de--)}}},B=(L,P,F,K,q=null)=>{const{el:W,type:J,transition:X,children:Y,shapeFlag:G}=L;if(G&6){B(L.component.subTree,P,F,K);return}if(G&128){L.suspense.move(P,F,K);return}if(G&64){J.move(L,P,F,z);return}if(J===xe){r(W,P,F);for(let ee=0;ee<Y.length;ee++)B(Y[ee],P,F,K);r(L.anchor,P,F);return}if(J===ns){c(L,P,F);return}if(K!==2&&G&1&&X)if(K===0)X.beforeEnter(W),r(W,P,F),Ue(()=>X.enter(W),q);else{const{leave:ee,delayLeave:ie,afterLeave:re}=X,le=()=>r(W,P,F),ve=()=>{ee(W,()=>{le(),re&&re()})};ie?ie(W,le,ve):ve()}else r(W,P,F)},V=(L,P,F,K=!1,q=!1)=>{const{type:W,props:J,ref:X,children:Y,dynamicChildren:G,shapeFlag:se,patchFlag:ee,dirs:ie}=L;if(X!=null&&_r(X,null,F,L,!0),se&256){P.ctx.deactivate(L);return}const re=se&1&&ie,le=!bi(L);let ve;if(le&&(ve=J&&J.onVnodeBeforeUnmount)&&tt(ve,P,L),se&6)te(L.component,F,K);else{if(se&128){L.suspense.unmount(F,K);return}re&&Lt(L,null,P,"beforeUnmount"),se&64?L.type.remove(L,P,F,q,z,K):G&&(W!==xe||ee>0&&ee&64)?_e(G,P,F,!1,!0):(W===xe&&ee&384||!q&&se&16)&&_e(Y,P,F),K&&Q(L)}(le&&(ve=J&&J.onVnodeUnmounted)||re)&&Ue(()=>{ve&&tt(ve,P,L),re&&Lt(L,null,P,"unmounted")},F)},Q=L=>{const{type:P,el:F,anchor:K,transition:q}=L;if(P===xe){ne(F,K);return}if(P===ns){p(L);return}const W=()=>{o(F),q&&!q.persisted&&q.afterLeave&&q.afterLeave()};if(L.shapeFlag&1&&q&&!q.persisted){const{leave:J,delayLeave:X}=q,Y=()=>J(F,W);X?X(L.el,W,Y):Y()}else W()},ne=(L,P)=>{let F;for(;L!==P;)F=g(L),o(L),L=F;o(P)},te=(L,P,F)=>{const{bum:K,scope:q,update:W,subTree:J,um:X}=L;K&&Ps(K),q.stop(),W&&(W.active=!1,V(J,L,P,F)),X&&Ue(X,P),Ue(()=>{L.isUnmounted=!0},P),P&&P.pendingBranch&&!P.isUnmounted&&L.asyncDep&&!L.asyncResolved&&L.suspenseId===P.pendingId&&(P.deps--,P.deps===0&&P.resolve())},_e=(L,P,F,K=!1,q=!1,W=0)=>{for(let J=W;J<L.length;J++)V(L[J],P,F,K,q)},R=L=>L.shapeFlag&6?R(L.component.subTree):L.shapeFlag&128?L.suspense.next():g(L.anchor||L.el),H=(L,P,F)=>{L==null?P._vnode&&V(P._vnode,null,null,!0):w(P._vnode||null,L,P,null,null,null,F),fn(),qo(),P._vnode=L},z={p:w,um:V,m:B,r:Q,mt:U,mc:m,pc:k,pbc:A,n:R,o:e};let $,oe;return t&&([$,oe]=t(z)),{render:H,hydrate:$,createApp:Nh(H,$)}}function Dt({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function _a(e,t,i=!1){const r=e.children,o=t.children;if(ae(r)&&ae(o))for(let d=0;d<r.length;d++){const v=r[d];let s=o[d];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=o[d]=vt(o[d]),s.el=v.el),i||_a(v,s)),s.type===Ls&&(s.el=v.el)}}function Gh(e){const t=e.slice(),i=[0];let r,o,d,v,s;const l=e.length;for(r=0;r<l;r++){const a=e[r];if(a!==0){if(o=i[i.length-1],e[o]<a){t[r]=o,i.push(r);continue}for(d=0,v=i.length-1;d<v;)s=d+v>>1,e[i[s]]<a?d=s+1:v=s;a<e[i[d]]&&(d>0&&(t[r]=i[d-1]),i[d]=r)}}for(d=i.length,v=i[d-1];d-- >0;)i[d]=v,v=t[v];return i}const Xh=e=>e.__isTeleport,xe=Symbol.for("v-fgt"),Ls=Symbol.for("v-txt"),Rt=Symbol.for("v-cmt"),ns=Symbol.for("v-stc"),yi=[];let Ye=null;function Le(e=!1){yi.push(Ye=e?null:[])}function Yh(){yi.pop(),Ye=yi[yi.length-1]||null}let Di=1;function Cn(e){Di+=e}function ua(e){return e.dynamicChildren=Di>0?Ye||Xt:null,Yh(),Di>0&&Ye&&Ye.push(e),e}function je(e,t,i,r,o,d){return ua(he(e,t,i,r,o,d,!0))}function ps(e,t,i,r,o){return ua(Fe(e,t,i,r,o,!0))}function pa(e){return e?e.__v_isVNode===!0:!1}function _i(e,t){return e.type===t.type&&e.key===t.key}const Ds="__vInternal",ga=({key:e})=>e??null,os=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?ke(e)||Me(e)||ce(e)?{i:Be,r:e,k:t,f:!!i}:e:null);function he(e,t=null,i=null,r=0,o=null,d=e===xe?0:1,v=!1,s=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ga(t),ref:t&&os(t),scopeId:Rs,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:r,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Be};return s?(Kr(l,i),d&128&&e.normalize(l)):i&&(l.shapeFlag|=ke(i)?8:16),Di>0&&!v&&Ye&&(l.patchFlag>0||d&6)&&l.patchFlag!==32&&Ye.push(l),l}const Fe=Jh;function Jh(e,t=null,i=null,r=0,o=null,d=!1){if((!e||e===Dh)&&(e=Rt),pa(e)){const s=ii(e,t,!0);return i&&Kr(s,i),Di>0&&!d&&Ye&&(s.shapeFlag&6?Ye[Ye.indexOf(e)]=s:Ye.push(s)),s.patchFlag|=-2,s}if(cc(e)&&(e=e.__vccOpts),t){t=Qh(t);let{class:s,style:l}=t;s&&!ke(s)&&(t.class=rt(s)),ye(l)&&(No(l)&&!ae(l)&&(l=Te({},l)),t.style=Cs(l))}const v=ke(e)?1:ph(e)?128:Xh(e)?64:ye(e)?4:ce(e)?2:0;return he(e,t,i,r,o,v,d,!0)}function Qh(e){return e?No(e)||Ds in e?Te({},e):e:null}function ii(e,t,i=!1){const{props:r,ref:o,patchFlag:d,children:v}=e,s=t?tc(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:s,key:s&&ga(s),ref:t&&t.ref?i&&o?ae(o)?o.concat(os(t)):[o,os(t)]:os(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:v,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==xe?d===-1?16:d|16:d,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ii(e.ssContent),ssFallback:e.ssFallback&&ii(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce}}function St(e=" ",t=0){return Fe(Ls,null,e,t)}function ec(e,t){const i=Fe(ns,null,e);return i.staticCount=t,i}function Xi(e="",t=!1){return t?(Le(),ps(Rt,null,e)):Fe(Rt,null,e)}function st(e){return e==null||typeof e=="boolean"?Fe(Rt):ae(e)?Fe(xe,null,e.slice()):typeof e=="object"?vt(e):Fe(Ls,null,String(e))}function vt(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ii(e)}function Kr(e,t){let i=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(ae(t))i=16;else if(typeof t=="object")if(r&65){const o=t.default;o&&(o._c&&(o._d=!1),Kr(e,o()),o._c&&(o._d=!0));return}else{i=32;const o=t._;!o&&!(Ds in t)?t._ctx=Be:o===3&&Be&&(Be.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ce(t)?(t={default:t,_ctx:Be},i=32):(t=String(t),r&64?(i=16,t=[St(t)]):i=8);e.children=t,e.shapeFlag|=i}function tc(...e){const t={};for(let i=0;i<e.length;i++){const r=e[i];for(const o in r)if(o==="class")t.class!==r.class&&(t.class=rt([t.class,r.class]));else if(o==="style")t.style=Cs([t.style,r.style]);else if(Ss(o)){const d=t[o],v=r[o];v&&d!==v&&!(ae(d)&&d.includes(v))&&(t[o]=d?[].concat(d,v):v)}else o!==""&&(t[o]=r[o])}return t}function tt(e,t,i,r=null){Qe(e,t,7,[i,r])}const ic=aa();let sc=0;function rc(e,t,i){const r=e.type,o=(t?t.appContext:e.appContext)||ic,d={uid:sc++,vnode:e,type:r,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new wl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ha(r,o),emitsOptions:Go(r,o),emit:null,emitted:null,propsDefaults:we,inheritAttrs:r.inheritAttrs,ctx:we,data:we,props:we,attrs:we,slots:we,refs:we,setupState:we,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=t?t.root:d,d.emit=ch.bind(null,d),e.ce&&e.ce(d),d}let De=null,Zr,jt,En="__VUE_INSTANCE_SETTERS__";(jt=ir()[En])||(jt=ir()[En]=[]),jt.push(e=>De=e),Zr=e=>{jt.length>1?jt.forEach(t=>t(e)):jt[0](e)};const si=e=>{Zr(e),e.scope.on()},Ft=()=>{De&&De.scope.off(),Zr(null)};function va(e){return e.vnode.shapeFlag&4}let Ti=!1;function nc(e,t=!1){Ti=t;const{props:i,children:r}=e.vnode,o=va(e);zh(e,i,o,t),Kh(e,r);const d=o?oc(e,t):void 0;return Ti=!1,d}function oc(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=Wo(new Proxy(e.ctx,Mh));const{setup:r}=i;if(r){const o=e.setupContext=r.length>1?lc(e):null;si(e),ai();const d=yt(r,e,0,[e.props,o]);if(li(),Ft(),Eo(d)){if(d.then(Ft,Ft),t)return d.then(v=>{xn(e,v,t)}).catch(v=>{xs(v,e,0)});e.asyncDep=d}else xn(e,d,t)}else ma(e,t)}function xn(e,t,i){ce(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:ye(t)&&(e.setupState=jo(t)),ma(e,i)}let kn;function ma(e,t,i){const r=e.type;if(!e.render){if(!t&&kn&&!r.render){const o=r.template||$r(e).template;if(o){const{isCustomElement:d,compilerOptions:v}=e.appContext.config,{delimiters:s,compilerOptions:l}=r,a=Te(Te({isCustomElement:d,delimiters:s},v),l);r.render=kn(o,a)}}e.render=r.render||Je}si(e),ai(),Oh(e),li(),Ft()}function ac(e){return e.attrsProxy||(e.attrsProxy=new Proxy(e.attrs,{get(t,i){return We(e,"get","$attrs"),t[i]}}))}function lc(e){const t=i=>{e.exposed=i||{}};return{get attrs(){return ac(e)},slots:e.slots,emit:e.emit,expose:t}}function qr(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(jo(Wo(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in wi)return wi[i](e)},has(t,i){return i in t||i in wi}}))}function hc(e,t=!0){return ce(e)?e.displayName||e.name:e.name||t&&e.__name}function cc(e){return ce(e)&&"__vccOpts"in e}const ur=(e,t)=>sh(e,t,Ti),dc=Symbol.for("v-scx"),fc=()=>rs(dc),_c="3.3.4",uc="http://www.w3.org/2000/svg",Mt=typeof document<"u"?document:null,Rn=Mt&&Mt.createElement("template"),pc={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,r)=>{const o=t?Mt.createElementNS(uc,e):Mt.createElement(e,i?{is:i}:void 0);return e==="select"&&r&&r.multiple!=null&&o.setAttribute("multiple",r.multiple),o},createText:e=>Mt.createTextNode(e),createComment:e=>Mt.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Mt.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,r,o,d){const v=i?i.previousSibling:t.lastChild;if(o&&(o===d||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),i),!(o===d||!(o=o.nextSibling)););else{Rn.innerHTML=r?`<svg>${e}</svg>`:e;const s=Rn.content;if(r){const l=s.firstChild;for(;l.firstChild;)s.appendChild(l.firstChild);s.removeChild(l)}t.insertBefore(s,i)}return[v?v.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}};function gc(e,t,i){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}function vc(e,t,i){const r=e.style,o=ke(i);if(i&&!o){if(t&&!ke(t))for(const d in t)i[d]==null&&pr(r,d,"");for(const d in i)pr(r,d,i[d])}else{const d=r.display;o?t!==i&&(r.cssText=i):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=d)}}const An=/\s*!important$/;function pr(e,t,i){if(ae(i))i.forEach(r=>pr(e,t,r));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const r=mc(e,t);An.test(i)?e.setProperty(oi(r),i.replace(An,""),"important"):e[r]=i}}const Ln=["Webkit","Moz","ms"],Ns={};function mc(e,t){const i=Ns[t];if(i)return i;let r=ht(t);if(r!=="filter"&&r in e)return Ns[t]=r;r=ys(r);for(let o=0;o<Ln.length;o++){const d=Ln[o]+r;if(d in e)return Ns[t]=d}return t}const Dn="http://www.w3.org/1999/xlink";function Sc(e,t,i,r,o){if(r&&t.startsWith("xlink:"))i==null?e.removeAttributeNS(Dn,t.slice(6,t.length)):e.setAttributeNS(Dn,t,i);else{const d=bl(t);i==null||d&&!Ro(i)?e.removeAttribute(t):e.setAttribute(t,d?"":i)}}function bc(e,t,i,r,o,d,v){if(t==="innerHTML"||t==="textContent"){r&&v(r,o,d),e[t]=i??"";return}const s=e.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){e._value=i;const a=s==="OPTION"?e.getAttribute("value"):e.value,u=i??"";a!==u&&(e.value=u),i==null&&e.removeAttribute(t);return}let l=!1;if(i===""||i==null){const a=typeof e[t];a==="boolean"?i=Ro(i):i==null&&a==="string"?(i="",l=!0):a==="number"&&(i=0,l=!0)}try{e[t]=i}catch{}l&&e.removeAttribute(t)}function wc(e,t,i,r){e.addEventListener(t,i,r)}function yc(e,t,i,r){e.removeEventListener(t,i,r)}function Cc(e,t,i,r,o=null){const d=e._vei||(e._vei={}),v=d[t];if(r&&v)v.value=r;else{const[s,l]=Ec(t);if(r){const a=d[t]=Rc(r,o);wc(e,s,a,l)}else v&&(yc(e,s,v,l),d[t]=void 0)}}const Tn=/(?:Once|Passive|Capture)$/;function Ec(e){let t;if(Tn.test(e)){t={};let r;for(;r=e.match(Tn);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):oi(e.slice(2)),t]}let Ws=0;const xc=Promise.resolve(),kc=()=>Ws||(xc.then(()=>Ws=0),Ws=Date.now());function Rc(e,t){const i=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=i.attached)return;Qe(Ac(r,i.value),t,5,[r])};return i.value=e,i.attached=kc(),i}function Ac(e,t){if(ae(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(r=>o=>!o._stopped&&r&&r(o))}else return t}const In=/^on[a-z]/,Lc=(e,t,i,r,o=!1,d,v,s,l)=>{t==="class"?gc(e,r,o):t==="style"?vc(e,i,r):Ss(t)?Ar(t)||Cc(e,t,i,r,v):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Dc(e,t,r,o))?bc(e,t,r,d,v,s,l):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),Sc(e,t,r,o))};function Dc(e,t,i,r){return r?!!(t==="innerHTML"||t==="textContent"||t in e&&In.test(t)&&ce(i)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||In.test(t)&&ke(i)?!1:t in e}const Tc=Te({patchProp:Lc},pc);let Mn;function Ic(){return Mn||(Mn=qh(Tc))}const Mc=(...e)=>{const t=Ic().createApp(...e),{mount:i}=t;return t.mount=r=>{const o=Oc(r);if(!o)return;const d=t._component;!ce(d)&&!d.render&&!d.template&&(d.template=o.innerHTML),o.innerHTML="";const v=i(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),v},t};function Oc(e){return ke(e)?document.querySelector(e):e}const zt=(e,t)=>{const i=e.__vccOpts||e;for(const[r,o]of t)i[r]=o;return i},Pc={},Bc={width:"25",height:"25",viewBox:"0 0 25 25",fill:"none",version:"1.1",id:"svg22",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"},Hc=ec('<defs id="defs26"></defs><path d="M11 9L14 9L14 6L11 6L11 9Z" id="path2" style="fill:#fe8a2c;"></path><path d="M11.1603 3L13.7405 3L16.4198 3L19 3L19 1.3166e-06L16.4198 1.09104e-06L13.7405 8.56799e-07L11.1603 6.31236e-07L8.58016 4.05671e-07L6 1.80107e-07L6 3L8.58016 3L11.1603 3Z" id="path4" style="fill:#fe8a2c;"></path><path d="M13.7405 22L11.1603 22L8.58016 22L6 22L6 25L8.58016 25L11.1603 25L13.7405 25L16.4198 25L19 25L19 22L16.4198 22L13.7405 22Z" id="path6" style="fill:#fe8a2c;"></path><path d="M14 17.038L14 13.962L14 11L11 11L11 13.962L11 17.038L11 20L14 20L14 17.038Z" id="path8" style="fill:#fe8a2c;"></path><path d="M3 19L3 16.4198L3 13.8397L3 11.1603L3 8.58014L3 6L-5.55968e-08 6L-2.8116e-07 8.58014L-5.06725e-07 11.1603L-7.40965e-07 13.8397L-9.66529e-07 16.4198L-1.19209e-06 19L3 19Z" id="path10" style="fill:#fe8a2c;"></path><path d="M19 22L22 22L22 19L19 19L19 22Z" id="path12" style="fill:#fe8a2c;"></path><path d="M19 6L22 6L22 3L19 3L19 6Z" id="path14" style="fill:#fe8a2c;"></path><path d="M3 6L6 6L6 3L3 3L3 6Z" id="path16" style="fill:#fe8a2c;"></path><path d="M3 22L6 22L6 19L3 19L3 22Z" id="path18" style="fill:#fe8a2c;"></path><path d="M22 11.1603L22 13.8397L22 16.4198L22 19L25 19L25 16.4198L25 13.8397L25 11.1603L25 8.58014L25 6L22 6L22 8.58014L22 11.1603Z" id="path20" style="fill:#fe8a2c;"></path>',11),Fc=[Hc];function Uc(e,t,i,r,o,d){return Le(),je("svg",Bc,Fc)}const Nc=zt(Pc,[["render",Uc]]),Wc={},zc={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",version:"1.1",id:"svg3680",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"},$c=he("defs",{id:"defs3684"},null,-1),jc=he("path",{id:"path3666",style:{fill:"#fe8a2c",stroke:"none"},d:"m 10,7 v 3 h 3 V 7 Z m 3,3 v 3 h 3 v -3 z m 3,3 v 3 h 3 v -3 z m 3,3 v 3 h 3 V 16 Z M 10,10 H 7 v 3 h 3 z M 7,13 H 4 v 3 H 7 Z M 4,16 H 1 v 3 h 3 z"},null,-1),Kc=[$c,jc];function Zc(e,t,i,r,o,d){return Le(),je("svg",zc,Kc)}const qc=zt(Wc,[["render",Zc]]),Vc={},Gc={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",version:"1.1",id:"svg3680",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"},Xc=he("defs",{id:"defs3684"},null,-1),Yc=he("path",{id:"path3666",style:{fill:"#fe8a2c"},d:"m 1,7 v 3 H 4 V 7 Z m 3,3 v 3 h 3 v -3 z m 3,3 v 3 h 3 v -3 z m 3,3 v 3 h 3 v -3 z m 3,0 h 3 v -3 h -3 z m 3,-3 h 3 v -3 h -3 z m 3,-3 h 3 V 7 h -3 z"},null,-1),Jc=[Xc,Yc];function Qc(e,t,i,r,o,d){return Le(),je("svg",Gc,Jc)}const ed=zt(Vc,[["render",Qc]]);function Sa(e){const t=Yl(e),i=()=>t.value;return i.set=r=>{t.value=r},i.update=r=>{t.value=r(t.value)},i.mutate=r=>{r(t.value),Ql(t)},i}const ba=Sa("WAITING FOR DEVICES ..."),as=Sa([]),td={props:{version:String},components:{Info:Nc,ArrowUp:qc,ArrowDown:ed},computed:{message(){return ba()},logs(){return as()}},data(){return{showLogs:!0}},methods:{toggleLogs(){this.showLogs=!this.showLogs},onSelectVersion(e){this.$emit("update:version",e)}}},id={class:"flex w-full h-full justify-center items-center px-8 py-6"},sd={class:"flex flex-col w-full lg:w-3/6 rounded-lg border-2 px-3 pb-3 bg-black border-flprborder"},rd={class:"flex justify-between items-center h-11"},nd=he("div",{class:"flex flex-row"},[he("div",{class:"rounded-full w-5 h-5 bg-close"}),he("div",{class:"rounded-full w-5 h-5 ml-3 bg-minimize"})],-1),od={class:"flex text-white text-xs items-center font-haxrcorp-4089 uppercase hidden"},ad=he("div",{class:"flex items-center flex-1 uppercase text-3xl md:text-3xl z-10 text-primary font-haxrcorp-4089 mr-2"}," PCB Version: ",-1),ld={class:"flex flex-1 flex-col justify-center items-center border-4 border-2 rounded-lg relative overflow-hidden border-primary text-white"},hd={class:"flex flex-1 w-full mt-3"},cd={class:"flex-none mr-3"},dd=he("div",{class:"absolute w-full h-full bg-primary opacity-10 hover:opacity-60 hover:cursor-pointer left-0 top-0 z-1"},null,-1),fd=he("div",{class:"z-10 ml-2"},"LOGS",-1),_d={class:"flex items-center bg-red-400 flex-1 uppercase text-3xl md:text-3xl z-10 text-primary font-haxrcorp-4089",style:{"background-color":"#442007"}},ud={class:"py-1 px-3"},pd=he("div",{class:"rounded-lg border-2 px-3 pb-3 bg-black border-flprborder h-44 p-2"},[he("div",{id:"terminal"})],-1),gd=[pd];function vd(e,t,i,r,o,d){const v=ss("ArrowUp"),s=ss("ArrowDown"),l=ss("Info");return Le(),je("div",id,[he("div",sd,[he("div",rd,[nd,he("div",null,[he("div",od,[ad,he("div",{class:rt(["relative flex rounded-md text-lg md:text-lg px-4 border-2 relative font-haxrcorp-4089 uppercase cursor-pointer",{"text-lightgreen border-lightgreen":i.version=="2.5","text-primary  border-primary":i.version!="2.5"}]),onClick:t[0]||(t[0]=a=>d.onSelectVersion("2.5"))},[he("div",{class:rt(["absolute w-full h-full opacity-20 left-0 top-0 z-0 hover:opacity-60 hover:cursor-pointer bg-primary",{"bg-lightgreen":i.version=="2.5"}])},null,2),St(" 2.5 ")],2),he("div",{class:rt(["ml-2 relative rounded-md text-lg md:text-lg px-4 border-2 relative font-haxrcorp-4089 uppercase cursor-pointer",{"text-lightgreen border-lightgreen":i.version=="2.5.1","text-primary  border-primary":i.version!="2.5.1"}]),onClick:t[1]||(t[1]=a=>d.onSelectVersion("2.5.1"))},[he("div",{class:rt(["absolute w-full h-full opacity-10 hover:opacity-60 hover:cursor-pointer left-0 top-0 z-1",{"bg-lightgreen":i.version=="2.5.1","bg-primary":i.version!="2.5.1"}])},null,2),St(" 2.5.1 ")],2)])])]),he("div",ld,[Ih(e.$slots,"default")]),he("div",hd,[he("div",cd,[he("div",{class:"cursor-pointer flex items-center text-primary rounded-md text-3xl md:text-3xl px-4 py-1 border-2 border-primary relative font-haxrcorp-4089 uppercase",style:{"background-color":"#442007"},onClick:t[2]||(t[2]=(...a)=>d.toggleLogs&&d.toggleLogs(...a))},[dd,o.showLogs?(Le(),ps(s,{key:1})):(Le(),ps(v,{key:0})),fd])]),he("div",_d,[Fe(l,{class:"ml-2"}),St(),he("span",ud,sr(d.message),1)])]),he("div",{id:"logs",class:rt(["logs w-full mt-3",{hidden:o.showLogs}])},gd,2)])])}const md=zt(td,[["render",vd]]),Sd="modulepreload",bd=function(e){return"/"+e},On={},Tt=function(t,i,r){if(!i||i.length===0)return t();const o=document.getElementsByTagName("link");return Promise.all(i.map(d=>{if(d=bd(d),d in On)return;On[d]=!0;const v=d.endsWith(".css"),s=v?'[rel="stylesheet"]':"";if(!!r)for(let u=o.length-1;u>=0;u--){const _=o[u];if(_.href===d&&(!v||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${s}`))return;const a=document.createElement("link");if(a.rel=v?"stylesheet":Sd,v||(a.as="script",a.crossOrigin=""),a.href=d,document.head.appendChild(a),v)return new Promise((u,_)=>{a.addEventListener("load",u),a.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})})).then(()=>t()).catch(d=>{const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=d,window.dispatchEvent(v),!v.defaultPrevented)throw d})};class Oe extends Error{}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const wd=4,Pn=0,Bn=1,yd=2;function hi(e){let t=e.length;for(;--t>=0;)e[t]=0}const Cd=0,wa=1,Ed=2,xd=3,kd=258,Vr=29,Ni=256,Ii=Ni+1+Vr,ei=30,Gr=19,ya=2*Ii+1,Ot=15,zs=16,Rd=7,Xr=256,Ca=16,Ea=17,xa=18,gr=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ls=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ad=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ka=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ld=512,ft=new Array((Ii+2)*2);hi(ft);const Ci=new Array(ei*2);hi(Ci);const Mi=new Array(Ld);hi(Mi);const Oi=new Array(kd-xd+1);hi(Oi);const Yr=new Array(Vr);hi(Yr);const gs=new Array(ei);hi(gs);function $s(e,t,i,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}let Ra,Aa,La;function js(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const Da=e=>e<256?Mi[e]:Mi[256+(e>>>7)],Pi=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Ne=(e,t,i)=>{e.bi_valid>zs-i?(e.bi_buf|=t<<e.bi_valid&65535,Pi(e,e.bi_buf),e.bi_buf=t>>zs-e.bi_valid,e.bi_valid+=i-zs):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},ot=(e,t,i)=>{Ne(e,i[t*2],i[t*2+1])},Ta=(e,t)=>{let i=0;do i|=e&1,e>>>=1,i<<=1;while(--t>0);return i>>>1},Dd=e=>{e.bi_valid===16?(Pi(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Td=(e,t)=>{const i=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,d=t.stat_desc.has_stree,v=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,l=t.stat_desc.max_length;let a,u,_,g,S,y,w=0;for(g=0;g<=Ot;g++)e.bl_count[g]=0;for(i[e.heap[e.heap_max]*2+1]=0,a=e.heap_max+1;a<ya;a++)u=e.heap[a],g=i[i[u*2+1]*2+1]+1,g>l&&(g=l,w++),i[u*2+1]=g,!(u>r)&&(e.bl_count[g]++,S=0,u>=s&&(S=v[u-s]),y=i[u*2],e.opt_len+=y*(g+S),d&&(e.static_len+=y*(o[u*2+1]+S)));if(w!==0){do{for(g=l-1;e.bl_count[g]===0;)g--;e.bl_count[g]--,e.bl_count[g+1]+=2,e.bl_count[l]--,w-=2}while(w>0);for(g=l;g!==0;g--)for(u=e.bl_count[g];u!==0;)_=e.heap[--a],!(_>r)&&(i[_*2+1]!==g&&(e.opt_len+=(g-i[_*2+1])*i[_*2],i[_*2+1]=g),u--)}},Ia=(e,t,i)=>{const r=new Array(Ot+1);let o=0,d,v;for(d=1;d<=Ot;d++)o=o+i[d-1]<<1,r[d]=o;for(v=0;v<=t;v++){let s=e[v*2+1];s!==0&&(e[v*2]=Ta(r[s]++,s))}},Id=()=>{let e,t,i,r,o;const d=new Array(Ot+1);for(i=0,r=0;r<Vr-1;r++)for(Yr[r]=i,e=0;e<1<<gr[r];e++)Oi[i++]=r;for(Oi[i-1]=r,o=0,r=0;r<16;r++)for(gs[r]=o,e=0;e<1<<ls[r];e++)Mi[o++]=r;for(o>>=7;r<ei;r++)for(gs[r]=o<<7,e=0;e<1<<ls[r]-7;e++)Mi[256+o++]=r;for(t=0;t<=Ot;t++)d[t]=0;for(e=0;e<=143;)ft[e*2+1]=8,e++,d[8]++;for(;e<=255;)ft[e*2+1]=9,e++,d[9]++;for(;e<=279;)ft[e*2+1]=7,e++,d[7]++;for(;e<=287;)ft[e*2+1]=8,e++,d[8]++;for(Ia(ft,Ii+1,d),e=0;e<ei;e++)Ci[e*2+1]=5,Ci[e*2]=Ta(e,5);Ra=new $s(ft,gr,Ni+1,Ii,Ot),Aa=new $s(Ci,ls,0,ei,Ot),La=new $s(new Array(0),Ad,0,Gr,Rd)},Ma=e=>{let t;for(t=0;t<Ii;t++)e.dyn_ltree[t*2]=0;for(t=0;t<ei;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Gr;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Xr*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Oa=e=>{e.bi_valid>8?Pi(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Hn=(e,t,i,r)=>{const o=t*2,d=i*2;return e[o]<e[d]||e[o]===e[d]&&r[t]<=r[i]},Ks=(e,t,i)=>{const r=e.heap[i];let o=i<<1;for(;o<=e.heap_len&&(o<e.heap_len&&Hn(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!Hn(t,r,e.heap[o],e.depth));)e.heap[i]=e.heap[o],i=o,o<<=1;e.heap[i]=r},Fn=(e,t,i)=>{let r,o,d=0,v,s;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+d++]&255,r+=(e.pending_buf[e.sym_buf+d++]&255)<<8,o=e.pending_buf[e.sym_buf+d++],r===0?ot(e,o,t):(v=Oi[o],ot(e,v+Ni+1,t),s=gr[v],s!==0&&(o-=Yr[v],Ne(e,o,s)),r--,v=Da(r),ot(e,v,i),s=ls[v],s!==0&&(r-=gs[v],Ne(e,r,s)));while(d<e.sym_next);ot(e,Xr,t)},vr=(e,t)=>{const i=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,d=t.stat_desc.elems;let v,s,l=-1,a;for(e.heap_len=0,e.heap_max=ya,v=0;v<d;v++)i[v*2]!==0?(e.heap[++e.heap_len]=l=v,e.depth[v]=0):i[v*2+1]=0;for(;e.heap_len<2;)a=e.heap[++e.heap_len]=l<2?++l:0,i[a*2]=1,e.depth[a]=0,e.opt_len--,o&&(e.static_len-=r[a*2+1]);for(t.max_code=l,v=e.heap_len>>1;v>=1;v--)Ks(e,i,v);a=d;do v=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ks(e,i,1),s=e.heap[1],e.heap[--e.heap_max]=v,e.heap[--e.heap_max]=s,i[a*2]=i[v*2]+i[s*2],e.depth[a]=(e.depth[v]>=e.depth[s]?e.depth[v]:e.depth[s])+1,i[v*2+1]=i[s*2+1]=a,e.heap[1]=a++,Ks(e,i,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Td(e,t),Ia(i,l,e.bl_count)},Un=(e,t,i)=>{let r,o=-1,d,v=t[0*2+1],s=0,l=7,a=4;for(v===0&&(l=138,a=3),t[(i+1)*2+1]=65535,r=0;r<=i;r++)d=v,v=t[(r+1)*2+1],!(++s<l&&d===v)&&(s<a?e.bl_tree[d*2]+=s:d!==0?(d!==o&&e.bl_tree[d*2]++,e.bl_tree[Ca*2]++):s<=10?e.bl_tree[Ea*2]++:e.bl_tree[xa*2]++,s=0,o=d,v===0?(l=138,a=3):d===v?(l=6,a=3):(l=7,a=4))},Nn=(e,t,i)=>{let r,o=-1,d,v=t[0*2+1],s=0,l=7,a=4;for(v===0&&(l=138,a=3),r=0;r<=i;r++)if(d=v,v=t[(r+1)*2+1],!(++s<l&&d===v)){if(s<a)do ot(e,d,e.bl_tree);while(--s!==0);else d!==0?(d!==o&&(ot(e,d,e.bl_tree),s--),ot(e,Ca,e.bl_tree),Ne(e,s-3,2)):s<=10?(ot(e,Ea,e.bl_tree),Ne(e,s-3,3)):(ot(e,xa,e.bl_tree),Ne(e,s-11,7));s=0,o=d,v===0?(l=138,a=3):d===v?(l=6,a=3):(l=7,a=4)}},Md=e=>{let t;for(Un(e,e.dyn_ltree,e.l_desc.max_code),Un(e,e.dyn_dtree,e.d_desc.max_code),vr(e,e.bl_desc),t=Gr-1;t>=3&&e.bl_tree[ka[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},Od=(e,t,i,r)=>{let o;for(Ne(e,t-257,5),Ne(e,i-1,5),Ne(e,r-4,4),o=0;o<r;o++)Ne(e,e.bl_tree[ka[o]*2+1],3);Nn(e,e.dyn_ltree,t-1),Nn(e,e.dyn_dtree,i-1)},Pd=e=>{let t=4093624447,i;for(i=0;i<=31;i++,t>>>=1)if(t&1&&e.dyn_ltree[i*2]!==0)return Pn;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Bn;for(i=32;i<Ni;i++)if(e.dyn_ltree[i*2]!==0)return Bn;return Pn};let Wn=!1;const Bd=e=>{Wn||(Id(),Wn=!0),e.l_desc=new js(e.dyn_ltree,Ra),e.d_desc=new js(e.dyn_dtree,Aa),e.bl_desc=new js(e.bl_tree,La),e.bi_buf=0,e.bi_valid=0,Ma(e)},Pa=(e,t,i,r)=>{Ne(e,(Cd<<1)+(r?1:0),3),Oa(e),Pi(e,i),Pi(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i},Hd=e=>{Ne(e,wa<<1,3),ot(e,Xr,ft),Dd(e)},Fd=(e,t,i,r)=>{let o,d,v=0;e.level>0?(e.strm.data_type===yd&&(e.strm.data_type=Pd(e)),vr(e,e.l_desc),vr(e,e.d_desc),v=Md(e),o=e.opt_len+3+7>>>3,d=e.static_len+3+7>>>3,d<=o&&(o=d)):o=d=i+5,i+4<=o&&t!==-1?Pa(e,t,i,r):e.strategy===wd||d===o?(Ne(e,(wa<<1)+(r?1:0),3),Fn(e,ft,Ci)):(Ne(e,(Ed<<1)+(r?1:0),3),Od(e,e.l_desc.max_code+1,e.d_desc.max_code+1,v+1),Fn(e,e.dyn_ltree,e.dyn_dtree)),Ma(e),r&&Oa(e)},Ud=(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,t===0?e.dyn_ltree[i*2]++:(e.matches++,t--,e.dyn_ltree[(Oi[i]+Ni+1)*2]++,e.dyn_dtree[Da(t)*2]++),e.sym_next===e.sym_end);var Nd=Bd,Wd=Pa,zd=Fd,$d=Ud,jd=Hd,Kd={_tr_init:Nd,_tr_stored_block:Wd,_tr_flush_block:zd,_tr_tally:$d,_tr_align:jd};const Zd=(e,t,i,r)=>{let o=e&65535|0,d=e>>>16&65535|0,v=0;for(;i!==0;){v=i>2e3?2e3:i,i-=v;do o=o+t[r++]|0,d=d+o|0;while(--v);o%=65521,d%=65521}return o|d<<16|0};var Bi=Zd;const qd=()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[i]=e}return t},Vd=new Uint32Array(qd()),Gd=(e,t,i,r)=>{const o=Vd,d=r+i;e^=-1;for(let v=r;v<d;v++)e=e>>>8^o[(e^t[v])&255];return e^-1};var Ee=Gd,Ut={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ci={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Xd,_tr_stored_block:mr,_tr_flush_block:Yd,_tr_tally:Ct,_tr_align:Jd}=Kd,{Z_NO_FLUSH:Et,Z_PARTIAL_FLUSH:Qd,Z_FULL_FLUSH:ef,Z_FINISH:qe,Z_BLOCK:zn,Z_OK:Ae,Z_STREAM_END:$n,Z_STREAM_ERROR:at,Z_DATA_ERROR:tf,Z_BUF_ERROR:Zs,Z_DEFAULT_COMPRESSION:sf,Z_FILTERED:rf,Z_HUFFMAN_ONLY:Yi,Z_RLE:nf,Z_FIXED:of,Z_DEFAULT_STRATEGY:af,Z_UNKNOWN:lf,Z_DEFLATED:Ts}=ci,hf=9,cf=15,df=8,ff=29,_f=256,Sr=_f+1+ff,uf=30,pf=19,gf=2*Sr+1,vf=15,fe=3,bt=258,lt=bt+fe+1,mf=32,ri=42,Jr=57,br=69,wr=73,yr=91,Cr=103,Pt=113,mi=666,He=1,di=2,Nt=3,fi=4,Sf=3,Bt=(e,t)=>(e.msg=Ut[t],t),jn=e=>e*2-(e>4?9:0),mt=e=>{let t=e.length;for(;--t>=0;)e[t]=0},bf=e=>{let t,i,r,o=e.w_size;t=e.hash_size,r=t;do i=e.head[--r],e.head[r]=i>=o?i-o:0;while(--t);t=o,r=t;do i=e.prev[--r],e.prev[r]=i>=o?i-o:0;while(--t)};let wf=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask,xt=wf;const $e=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),i!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,t.pending===0&&(t.pending_out=0))},Ke=(e,t)=>{Yd(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,$e(e.strm)},pe=(e,t)=>{e.pending_buf[e.pending++]=t},ui=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},Er=(e,t,i,r)=>{let o=e.avail_in;return o>r&&(o=r),o===0?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),i),e.state.wrap===1?e.adler=Bi(e.adler,t,o,i):e.state.wrap===2&&(e.adler=Ee(e.adler,t,o,i)),e.next_in+=o,e.total_in+=o,o)},Ba=(e,t)=>{let i=e.max_chain_length,r=e.strstart,o,d,v=e.prev_length,s=e.nice_match;const l=e.strstart>e.w_size-lt?e.strstart-(e.w_size-lt):0,a=e.window,u=e.w_mask,_=e.prev,g=e.strstart+bt;let S=a[r+v-1],y=a[r+v];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do if(o=t,!(a[o+v]!==y||a[o+v-1]!==S||a[o]!==a[r]||a[++o]!==a[r+1])){r+=2,o++;do;while(a[++r]===a[++o]&&a[++r]===a[++o]&&a[++r]===a[++o]&&a[++r]===a[++o]&&a[++r]===a[++o]&&a[++r]===a[++o]&&a[++r]===a[++o]&&a[++r]===a[++o]&&r<g);if(d=bt-(g-r),r=g-bt,d>v){if(e.match_start=t,v=d,d>=s)break;S=a[r+v-1],y=a[r+v]}}while((t=_[t&u])>l&&--i!==0);return v<=e.lookahead?v:e.lookahead},ni=e=>{const t=e.w_size;let i,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-lt)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),bf(e),r+=t),e.strm.avail_in===0)break;if(i=Er(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=i,e.lookahead+e.insert>=fe)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=xt(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=xt(e,e.ins_h,e.window[o+fe-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<fe)););}while(e.lookahead<lt&&e.strm.avail_in!==0)},Ha=(e,t)=>{let i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,o,d,v=0,s=e.strm.avail_in;do{if(r=65535,d=e.bi_valid+42>>3,e.strm.avail_out<d||(d=e.strm.avail_out-d,o=e.strstart-e.block_start,r>o+e.strm.avail_in&&(r=o+e.strm.avail_in),r>d&&(r=d),r<i&&(r===0&&t!==qe||t===Et||r!==o+e.strm.avail_in)))break;v=t===qe&&r===o+e.strm.avail_in?1:0,mr(e,0,0,v),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,$e(e.strm),o&&(o>r&&(o=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+o),e.strm.next_out),e.strm.next_out+=o,e.strm.avail_out-=o,e.strm.total_out+=o,e.block_start+=o,r-=o),r&&(Er(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(v===0);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),v?fi:t!==Et&&t!==qe&&e.strm.avail_in===0&&e.strstart===e.block_start?di:(d=e.window_size-e.strstart,e.strm.avail_in>d&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,d+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),d>e.strm.avail_in&&(d=e.strm.avail_in),d&&(Er(e.strm,e.window,e.strstart,d),e.strstart+=d,e.insert+=d>e.w_size-e.insert?e.w_size-e.insert:d),e.high_water<e.strstart&&(e.high_water=e.strstart),d=e.bi_valid+42>>3,d=e.pending_buf_size-d>65535?65535:e.pending_buf_size-d,i=d>e.w_size?e.w_size:d,o=e.strstart-e.block_start,(o>=i||(o||t===qe)&&t!==Et&&e.strm.avail_in===0&&o<=d)&&(r=o>d?d:o,v=t===qe&&e.strm.avail_in===0&&r===o?1:0,mr(e,e.block_start,r,v),e.block_start+=r,$e(e.strm)),v?Nt:He)},qs=(e,t)=>{let i,r;for(;;){if(e.lookahead<lt){if(ni(e),e.lookahead<lt&&t===Et)return He;if(e.lookahead===0)break}if(i=0,e.lookahead>=fe&&(e.ins_h=xt(e,e.ins_h,e.window[e.strstart+fe-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),i!==0&&e.strstart-i<=e.w_size-lt&&(e.match_length=Ba(e,i)),e.match_length>=fe)if(r=Ct(e,e.strstart-e.match_start,e.match_length-fe),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=fe){e.match_length--;do e.strstart++,e.ins_h=xt(e,e.ins_h,e.window[e.strstart+fe-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=xt(e,e.ins_h,e.window[e.strstart+1]);else r=Ct(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Ke(e,!1),e.strm.avail_out===0))return He}return e.insert=e.strstart<fe-1?e.strstart:fe-1,t===qe?(Ke(e,!0),e.strm.avail_out===0?Nt:fi):e.sym_next&&(Ke(e,!1),e.strm.avail_out===0)?He:di},Kt=(e,t)=>{let i,r,o;for(;;){if(e.lookahead<lt){if(ni(e),e.lookahead<lt&&t===Et)return He;if(e.lookahead===0)break}if(i=0,e.lookahead>=fe&&(e.ins_h=xt(e,e.ins_h,e.window[e.strstart+fe-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=fe-1,i!==0&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-lt&&(e.match_length=Ba(e,i),e.match_length<=5&&(e.strategy===rf||e.match_length===fe&&e.strstart-e.match_start>4096)&&(e.match_length=fe-1)),e.prev_length>=fe&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-fe,r=Ct(e,e.strstart-1-e.prev_match,e.prev_length-fe),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=xt(e,e.ins_h,e.window[e.strstart+fe-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=fe-1,e.strstart++,r&&(Ke(e,!1),e.strm.avail_out===0))return He}else if(e.match_available){if(r=Ct(e,0,e.window[e.strstart-1]),r&&Ke(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return He}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Ct(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<fe-1?e.strstart:fe-1,t===qe?(Ke(e,!0),e.strm.avail_out===0?Nt:fi):e.sym_next&&(Ke(e,!1),e.strm.avail_out===0)?He:di},yf=(e,t)=>{let i,r,o,d;const v=e.window;for(;;){if(e.lookahead<=bt){if(ni(e),e.lookahead<=bt&&t===Et)return He;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=fe&&e.strstart>0&&(o=e.strstart-1,r=v[o],r===v[++o]&&r===v[++o]&&r===v[++o])){d=e.strstart+bt;do;while(r===v[++o]&&r===v[++o]&&r===v[++o]&&r===v[++o]&&r===v[++o]&&r===v[++o]&&r===v[++o]&&r===v[++o]&&o<d);e.match_length=bt-(d-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=fe?(i=Ct(e,1,e.match_length-fe),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=Ct(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(Ke(e,!1),e.strm.avail_out===0))return He}return e.insert=0,t===qe?(Ke(e,!0),e.strm.avail_out===0?Nt:fi):e.sym_next&&(Ke(e,!1),e.strm.avail_out===0)?He:di},Cf=(e,t)=>{let i;for(;;){if(e.lookahead===0&&(ni(e),e.lookahead===0)){if(t===Et)return He;break}if(e.match_length=0,i=Ct(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(Ke(e,!1),e.strm.avail_out===0))return He}return e.insert=0,t===qe?(Ke(e,!0),e.strm.avail_out===0?Nt:fi):e.sym_next&&(Ke(e,!1),e.strm.avail_out===0)?He:di};function it(e,t,i,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=o}const Si=[new it(0,0,0,0,Ha),new it(4,4,8,4,qs),new it(4,5,16,8,qs),new it(4,6,32,32,qs),new it(4,4,16,16,Kt),new it(8,16,32,32,Kt),new it(8,16,128,128,Kt),new it(8,32,128,256,Kt),new it(32,128,258,1024,Kt),new it(32,258,258,4096,Kt)],Ef=e=>{e.window_size=2*e.w_size,mt(e.head),e.max_lazy_match=Si[e.level].max_lazy,e.good_match=Si[e.level].good_length,e.nice_match=Si[e.level].nice_length,e.max_chain_length=Si[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=fe-1,e.match_available=0,e.ins_h=0};function xf(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ts,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(gf*2),this.dyn_dtree=new Uint16Array((2*uf+1)*2),this.bl_tree=new Uint16Array((2*pf+1)*2),mt(this.dyn_ltree),mt(this.dyn_dtree),mt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(vf+1),this.heap=new Uint16Array(2*Sr+1),mt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Sr+1),mt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Wi=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==ri&&t.status!==Jr&&t.status!==br&&t.status!==wr&&t.status!==yr&&t.status!==Cr&&t.status!==Pt&&t.status!==mi?1:0},Fa=e=>{if(Wi(e))return Bt(e,at);e.total_in=e.total_out=0,e.data_type=lf;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?Jr:t.wrap?ri:Pt,e.adler=t.wrap===2?0:1,t.last_flush=-2,Xd(t),Ae},Ua=e=>{const t=Fa(e);return t===Ae&&Ef(e.state),t},kf=(e,t)=>Wi(e)||e.state.wrap!==2?at:(e.state.gzhead=t,Ae),Na=(e,t,i,r,o,d)=>{if(!e)return at;let v=1;if(t===sf&&(t=6),r<0?(v=0,r=-r):r>15&&(v=2,r-=16),o<1||o>hf||i!==Ts||r<8||r>15||t<0||t>9||d<0||d>of||r===8&&v!==1)return Bt(e,at);r===8&&(r=9);const s=new xf;return e.state=s,s.strm=e,s.status=ri,s.wrap=v,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+fe-1)/fe),s.window=new Uint8Array(s.w_size*2),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=s.lit_bufsize*4,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=(s.lit_bufsize-1)*3,s.level=t,s.strategy=d,s.method=i,Ua(e)},Rf=(e,t)=>Na(e,t,Ts,cf,df,af),Af=(e,t)=>{if(Wi(e)||t>zn||t<0)return e?Bt(e,at):at;const i=e.state;if(!e.output||e.avail_in!==0&&!e.input||i.status===mi&&t!==qe)return Bt(e,e.avail_out===0?Zs:at);const r=i.last_flush;if(i.last_flush=t,i.pending!==0){if($e(e),e.avail_out===0)return i.last_flush=-1,Ae}else if(e.avail_in===0&&jn(t)<=jn(r)&&t!==qe)return Bt(e,Zs);if(i.status===mi&&e.avail_in!==0)return Bt(e,Zs);if(i.status===ri&&i.wrap===0&&(i.status=Pt),i.status===ri){let o=Ts+(i.w_bits-8<<4)<<8,d=-1;if(i.strategy>=Yi||i.level<2?d=0:i.level<6?d=1:i.level===6?d=2:d=3,o|=d<<6,i.strstart!==0&&(o|=mf),o+=31-o%31,ui(i,o),i.strstart!==0&&(ui(i,e.adler>>>16),ui(i,e.adler&65535)),e.adler=1,i.status=Pt,$e(e),i.pending!==0)return i.last_flush=-1,Ae}if(i.status===Jr){if(e.adler=0,pe(i,31),pe(i,139),pe(i,8),i.gzhead)pe(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),pe(i,i.gzhead.time&255),pe(i,i.gzhead.time>>8&255),pe(i,i.gzhead.time>>16&255),pe(i,i.gzhead.time>>24&255),pe(i,i.level===9?2:i.strategy>=Yi||i.level<2?4:0),pe(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(pe(i,i.gzhead.extra.length&255),pe(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=Ee(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=br;else if(pe(i,0),pe(i,0),pe(i,0),pe(i,0),pe(i,0),pe(i,i.level===9?2:i.strategy>=Yi||i.level<2?4:0),pe(i,Sf),i.status=Pt,$e(e),i.pending!==0)return i.last_flush=-1,Ae}if(i.status===br){if(i.gzhead.extra){let o=i.pending,d=(i.gzhead.extra.length&65535)-i.gzindex;for(;i.pending+d>i.pending_buf_size;){let s=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+s),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>o&&(e.adler=Ee(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex+=s,$e(e),i.pending!==0)return i.last_flush=-1,Ae;o=0,d-=s}let v=new Uint8Array(i.gzhead.extra);i.pending_buf.set(v.subarray(i.gzindex,i.gzindex+d),i.pending),i.pending+=d,i.gzhead.hcrc&&i.pending>o&&(e.adler=Ee(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex=0}i.status=wr}if(i.status===wr){if(i.gzhead.name){let o=i.pending,d;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>o&&(e.adler=Ee(e.adler,i.pending_buf,i.pending-o,o)),$e(e),i.pending!==0)return i.last_flush=-1,Ae;o=0}i.gzindex<i.gzhead.name.length?d=i.gzhead.name.charCodeAt(i.gzindex++)&255:d=0,pe(i,d)}while(d!==0);i.gzhead.hcrc&&i.pending>o&&(e.adler=Ee(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex=0}i.status=yr}if(i.status===yr){if(i.gzhead.comment){let o=i.pending,d;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>o&&(e.adler=Ee(e.adler,i.pending_buf,i.pending-o,o)),$e(e),i.pending!==0)return i.last_flush=-1,Ae;o=0}i.gzindex<i.gzhead.comment.length?d=i.gzhead.comment.charCodeAt(i.gzindex++)&255:d=0,pe(i,d)}while(d!==0);i.gzhead.hcrc&&i.pending>o&&(e.adler=Ee(e.adler,i.pending_buf,i.pending-o,o))}i.status=Cr}if(i.status===Cr){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&($e(e),i.pending!==0))return i.last_flush=-1,Ae;pe(i,e.adler&255),pe(i,e.adler>>8&255),e.adler=0}if(i.status=Pt,$e(e),i.pending!==0)return i.last_flush=-1,Ae}if(e.avail_in!==0||i.lookahead!==0||t!==Et&&i.status!==mi){let o=i.level===0?Ha(i,t):i.strategy===Yi?Cf(i,t):i.strategy===nf?yf(i,t):Si[i.level].func(i,t);if((o===Nt||o===fi)&&(i.status=mi),o===He||o===Nt)return e.avail_out===0&&(i.last_flush=-1),Ae;if(o===di&&(t===Qd?Jd(i):t!==zn&&(mr(i,0,0,!1),t===ef&&(mt(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),$e(e),e.avail_out===0))return i.last_flush=-1,Ae}return t!==qe?Ae:i.wrap<=0?$n:(i.wrap===2?(pe(i,e.adler&255),pe(i,e.adler>>8&255),pe(i,e.adler>>16&255),pe(i,e.adler>>24&255),pe(i,e.total_in&255),pe(i,e.total_in>>8&255),pe(i,e.total_in>>16&255),pe(i,e.total_in>>24&255)):(ui(i,e.adler>>>16),ui(i,e.adler&65535)),$e(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ae:$n)},Lf=e=>{if(Wi(e))return at;const t=e.state.status;return e.state=null,t===Pt?Bt(e,tf):Ae},Df=(e,t)=>{let i=t.length;if(Wi(e))return at;const r=e.state,o=r.wrap;if(o===2||o===1&&r.status!==ri||r.lookahead)return at;if(o===1&&(e.adler=Bi(e.adler,t,i,0)),r.wrap=0,i>=r.w_size){o===0&&(mt(r.head),r.strstart=0,r.block_start=0,r.insert=0);let l=new Uint8Array(r.w_size);l.set(t.subarray(i-r.w_size,i),0),t=l,i=r.w_size}const d=e.avail_in,v=e.next_in,s=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,ni(r);r.lookahead>=fe;){let l=r.strstart,a=r.lookahead-(fe-1);do r.ins_h=xt(r,r.ins_h,r.window[l+fe-1]),r.prev[l&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=l,l++;while(--a);r.strstart=l,r.lookahead=fe-1,ni(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=fe-1,r.match_available=0,e.next_in=v,e.input=s,e.avail_in=d,r.wrap=o,Ae};var Tf=Rf,If=Na,Mf=Ua,Of=Fa,Pf=kf,Bf=Af,Hf=Lf,Ff=Df,Uf="pako deflate (from Nodeca project)",Ei={deflateInit:Tf,deflateInit2:If,deflateReset:Mf,deflateResetKeep:Of,deflateSetHeader:Pf,deflate:Bf,deflateEnd:Hf,deflateSetDictionary:Ff,deflateInfo:Uf};const Nf=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Wf=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const i=t.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(const r in i)Nf(i,r)&&(e[r]=i[r])}}return e},zf=e=>{let t=0;for(let r=0,o=e.length;r<o;r++)t+=e[r].length;const i=new Uint8Array(t);for(let r=0,o=0,d=e.length;r<d;r++){let v=e[r];i.set(v,o),o+=v.length}return i},Is={assign:Wf,flattenChunks:zf};let Wa=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Wa=!1}const Hi=new Uint8Array(256);for(let e=0;e<256;e++)Hi[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Hi[254]=Hi[254]=1;var $f=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,i,r,o,d,v=e.length,s=0;for(o=0;o<v;o++)i=e.charCodeAt(o),(i&64512)===55296&&o+1<v&&(r=e.charCodeAt(o+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),o++)),s+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(s),d=0,o=0;d<s;o++)i=e.charCodeAt(o),(i&64512)===55296&&o+1<v&&(r=e.charCodeAt(o+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),o++)),i<128?t[d++]=i:i<2048?(t[d++]=192|i>>>6,t[d++]=128|i&63):i<65536?(t[d++]=224|i>>>12,t[d++]=128|i>>>6&63,t[d++]=128|i&63):(t[d++]=240|i>>>18,t[d++]=128|i>>>12&63,t[d++]=128|i>>>6&63,t[d++]=128|i&63);return t};const jf=(e,t)=>{if(t<65534&&e.subarray&&Wa)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let r=0;r<t;r++)i+=String.fromCharCode(e[r]);return i};var Kf=(e,t)=>{const i=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,o;const d=new Array(i*2);for(o=0,r=0;r<i;){let v=e[r++];if(v<128){d[o++]=v;continue}let s=Hi[v];if(s>4){d[o++]=65533,r+=s-1;continue}for(v&=s===2?31:s===3?15:7;s>1&&r<i;)v=v<<6|e[r++]&63,s--;if(s>1){d[o++]=65533;continue}v<65536?d[o++]=v:(v-=65536,d[o++]=55296|v>>10&1023,d[o++]=56320|v&1023)}return jf(d,o)},Zf=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let i=t-1;for(;i>=0&&(e[i]&192)===128;)i--;return i<0||i===0?t:i+Hi[e[i]]>t?i:t},Fi={string2buf:$f,buf2string:Kf,utf8border:Zf};function qf(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var za=qf;const $a=Object.prototype.toString,{Z_NO_FLUSH:Vf,Z_SYNC_FLUSH:Gf,Z_FULL_FLUSH:Xf,Z_FINISH:Yf,Z_OK:vs,Z_STREAM_END:Jf,Z_DEFAULT_COMPRESSION:Qf,Z_DEFAULT_STRATEGY:e_,Z_DEFLATED:t_}=ci;function zi(e){this.options=Is.assign({level:Qf,method:t_,chunkSize:16384,windowBits:15,memLevel:8,strategy:e_},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new za,this.strm.avail_out=0;let i=Ei.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==vs)throw new Error(Ut[i]);if(t.header&&Ei.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=Fi.string2buf(t.dictionary):$a.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,i=Ei.deflateSetDictionary(this.strm,r),i!==vs)throw new Error(Ut[i]);this._dict_set=!0}}zi.prototype.push=function(e,t){const i=this.strm,r=this.options.chunkSize;let o,d;if(this.ended)return!1;for(t===~~t?d=t:d=t===!0?Yf:Vf,typeof e=="string"?i.input=Fi.string2buf(e):$a.call(e)==="[object ArrayBuffer]"?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){if(i.avail_out===0&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),(d===Gf||d===Xf)&&i.avail_out<=6){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(o=Ei.deflate(i,d),o===Jf)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),o=Ei.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===vs;if(i.avail_out===0){this.onData(i.output);continue}if(d>0&&i.next_out>0){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(i.avail_in===0)break}return!0};zi.prototype.onData=function(e){this.chunks.push(e)};zi.prototype.onEnd=function(e){e===vs&&(this.result=Is.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Qr(e,t){const i=new zi(t);if(i.push(e,!0),i.err)throw i.msg||Ut[i.err];return i.result}function i_(e,t){return t=t||{},t.raw=!0,Qr(e,t)}function s_(e,t){return t=t||{},t.gzip=!0,Qr(e,t)}var r_=zi,n_=Qr,o_=i_,a_=s_,l_=ci,h_={Deflate:r_,deflate:n_,deflateRaw:o_,gzip:a_,constants:l_};const Ji=16209,c_=16191;var d_=function(t,i){let r,o,d,v,s,l,a,u,_,g,S,y,w,n,f,h,c,p,b,E,x,m,C,A;const T=t.state;r=t.next_in,C=t.input,o=r+(t.avail_in-5),d=t.next_out,A=t.output,v=d-(i-t.avail_out),s=d+(t.avail_out-257),l=T.dmax,a=T.wsize,u=T.whave,_=T.wnext,g=T.window,S=T.hold,y=T.bits,w=T.lencode,n=T.distcode,f=(1<<T.lenbits)-1,h=(1<<T.distbits)-1;e:do{y<15&&(S+=C[r++]<<y,y+=8,S+=C[r++]<<y,y+=8),c=w[S&f];t:for(;;){if(p=c>>>24,S>>>=p,y-=p,p=c>>>16&255,p===0)A[d++]=c&65535;else if(p&16){b=c&65535,p&=15,p&&(y<p&&(S+=C[r++]<<y,y+=8),b+=S&(1<<p)-1,S>>>=p,y-=p),y<15&&(S+=C[r++]<<y,y+=8,S+=C[r++]<<y,y+=8),c=n[S&h];i:for(;;){if(p=c>>>24,S>>>=p,y-=p,p=c>>>16&255,p&16){if(E=c&65535,p&=15,y<p&&(S+=C[r++]<<y,y+=8,y<p&&(S+=C[r++]<<y,y+=8)),E+=S&(1<<p)-1,E>l){t.msg="invalid distance too far back",T.mode=Ji;break e}if(S>>>=p,y-=p,p=d-v,E>p){if(p=E-p,p>u&&T.sane){t.msg="invalid distance too far back",T.mode=Ji;break e}if(x=0,m=g,_===0){if(x+=a-p,p<b){b-=p;do A[d++]=g[x++];while(--p);x=d-E,m=A}}else if(_<p){if(x+=a+_-p,p-=_,p<b){b-=p;do A[d++]=g[x++];while(--p);if(x=0,_<b){p=_,b-=p;do A[d++]=g[x++];while(--p);x=d-E,m=A}}}else if(x+=_-p,p<b){b-=p;do A[d++]=g[x++];while(--p);x=d-E,m=A}for(;b>2;)A[d++]=m[x++],A[d++]=m[x++],A[d++]=m[x++],b-=3;b&&(A[d++]=m[x++],b>1&&(A[d++]=m[x++]))}else{x=d-E;do A[d++]=A[x++],A[d++]=A[x++],A[d++]=A[x++],b-=3;while(b>2);b&&(A[d++]=A[x++],b>1&&(A[d++]=A[x++]))}}else if(p&64){t.msg="invalid distance code",T.mode=Ji;break e}else{c=n[(c&65535)+(S&(1<<p)-1)];continue i}break}}else if(p&64)if(p&32){T.mode=c_;break e}else{t.msg="invalid literal/length code",T.mode=Ji;break e}else{c=w[(c&65535)+(S&(1<<p)-1)];continue t}break}}while(r<o&&d<s);b=y>>3,r-=b,y-=b<<3,S&=(1<<y)-1,t.next_in=r,t.next_out=d,t.avail_in=r<o?5+(o-r):5-(r-o),t.avail_out=d<s?257+(s-d):257-(d-s),T.hold=S,T.bits=y};const Zt=15,Kn=852,Zn=592,qn=0,Vs=1,Vn=2,f_=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),__=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),u_=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),p_=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),g_=(e,t,i,r,o,d,v,s)=>{const l=s.bits;let a=0,u=0,_=0,g=0,S=0,y=0,w=0,n=0,f=0,h=0,c,p,b,E,x,m=null,C;const A=new Uint16Array(Zt+1),T=new Uint16Array(Zt+1);let D=null,O,U,j;for(a=0;a<=Zt;a++)A[a]=0;for(u=0;u<r;u++)A[t[i+u]]++;for(S=l,g=Zt;g>=1&&A[g]===0;g--);if(S>g&&(S=g),g===0)return o[d++]=1<<24|64<<16|0,o[d++]=1<<24|64<<16|0,s.bits=1,0;for(_=1;_<g&&A[_]===0;_++);for(S<_&&(S=_),n=1,a=1;a<=Zt;a++)if(n<<=1,n-=A[a],n<0)return-1;if(n>0&&(e===qn||g!==1))return-1;for(T[1]=0,a=1;a<Zt;a++)T[a+1]=T[a]+A[a];for(u=0;u<r;u++)t[i+u]!==0&&(v[T[t[i+u]]++]=u);if(e===qn?(m=D=v,C=20):e===Vs?(m=f_,D=__,C=257):(m=u_,D=p_,C=0),h=0,u=0,a=_,x=d,y=S,w=0,b=-1,f=1<<S,E=f-1,e===Vs&&f>Kn||e===Vn&&f>Zn)return 1;for(;;){O=a-w,v[u]+1<C?(U=0,j=v[u]):v[u]>=C?(U=D[v[u]-C],j=m[v[u]-C]):(U=32+64,j=0),c=1<<a-w,p=1<<y,_=p;do p-=c,o[x+(h>>w)+p]=O<<24|U<<16|j|0;while(p!==0);for(c=1<<a-1;h&c;)c>>=1;if(c!==0?(h&=c-1,h+=c):h=0,u++,--A[a]===0){if(a===g)break;a=t[i+v[u]]}if(a>S&&(h&E)!==b){for(w===0&&(w=S),x+=_,y=a-w,n=1<<y;y+w<g&&(n-=A[y+w],!(n<=0));)y++,n<<=1;if(f+=1<<y,e===Vs&&f>Kn||e===Vn&&f>Zn)return 1;b=h&E,o[b]=S<<24|y<<16|x-d|0}}return h!==0&&(o[x+h]=a-w<<24|64<<16|0),s.bits=S,0};var xi=g_;const v_=0,ja=1,Ka=2,{Z_FINISH:Gn,Z_BLOCK:m_,Z_TREES:Qi,Z_OK:Wt,Z_STREAM_END:S_,Z_NEED_DICT:b_,Z_STREAM_ERROR:Ve,Z_DATA_ERROR:Za,Z_MEM_ERROR:qa,Z_BUF_ERROR:w_,Z_DEFLATED:Xn}=ci,Ms=16180,Yn=16181,Jn=16182,Qn=16183,eo=16184,to=16185,io=16186,so=16187,ro=16188,no=16189,ms=16190,ct=16191,Gs=16192,oo=16193,Xs=16194,ao=16195,lo=16196,ho=16197,co=16198,es=16199,ts=16200,fo=16201,_o=16202,uo=16203,po=16204,go=16205,Ys=16206,vo=16207,mo=16208,be=16209,Va=16210,Ga=16211,y_=852,C_=592,E_=15,x_=E_,So=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function k_(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const $t=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Ms||t.mode>Ga?1:0},Xa=e=>{if($t(e))return Ve;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Ms,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(y_),t.distcode=t.distdyn=new Int32Array(C_),t.sane=1,t.back=-1,Wt},Ya=e=>{if($t(e))return Ve;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Xa(e)},Ja=(e,t)=>{let i;if($t(e))return Ve;const r=e.state;return t<0?(i=0,t=-t):(i=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ve:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,Ya(e))},Qa=(e,t)=>{if(!e)return Ve;const i=new k_;e.state=i,i.strm=e,i.window=null,i.mode=Ms;const r=Ja(e,t);return r!==Wt&&(e.state=null),r},R_=e=>Qa(e,x_);let bo=!0,Js,Qs;const A_=e=>{if(bo){Js=new Int32Array(512),Qs=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(xi(ja,e.lens,0,288,Js,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;xi(Ka,e.lens,0,32,Qs,0,e.work,{bits:5}),bo=!1}e.lencode=Js,e.lenbits=9,e.distcode=Qs,e.distbits=5},el=(e,t,i,r)=>{let o;const d=e.state;return d.window===null&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new Uint8Array(d.wsize)),r>=d.wsize?(d.window.set(t.subarray(i-d.wsize,i),0),d.wnext=0,d.whave=d.wsize):(o=d.wsize-d.wnext,o>r&&(o=r),d.window.set(t.subarray(i-r,i-r+o),d.wnext),r-=o,r?(d.window.set(t.subarray(i-r,i),0),d.wnext=r,d.whave=d.wsize):(d.wnext+=o,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=o))),0},L_=(e,t)=>{let i,r,o,d,v,s,l,a,u,_,g,S,y,w,n=0,f,h,c,p,b,E,x,m;const C=new Uint8Array(4);let A,T;const D=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($t(e)||!e.output||!e.input&&e.avail_in!==0)return Ve;i=e.state,i.mode===ct&&(i.mode=Gs),v=e.next_out,o=e.output,l=e.avail_out,d=e.next_in,r=e.input,s=e.avail_in,a=i.hold,u=i.bits,_=s,g=l,m=Wt;e:for(;;)switch(i.mode){case Ms:if(i.wrap===0){i.mode=Gs;break}for(;u<16;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(i.wrap&2&&a===35615){i.wbits===0&&(i.wbits=15),i.check=0,C[0]=a&255,C[1]=a>>>8&255,i.check=Ee(i.check,C,2,0),a=0,u=0,i.mode=Yn;break}if(i.head&&(i.head.done=!1),!(i.wrap&1)||(((a&255)<<8)+(a>>8))%31){e.msg="incorrect header check",i.mode=be;break}if((a&15)!==Xn){e.msg="unknown compression method",i.mode=be;break}if(a>>>=4,u-=4,x=(a&15)+8,i.wbits===0&&(i.wbits=x),x>15||x>i.wbits){e.msg="invalid window size",i.mode=be;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=a&512?no:ct,a=0,u=0;break;case Yn:for(;u<16;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(i.flags=a,(i.flags&255)!==Xn){e.msg="unknown compression method",i.mode=be;break}if(i.flags&57344){e.msg="unknown header flags set",i.mode=be;break}i.head&&(i.head.text=a>>8&1),i.flags&512&&i.wrap&4&&(C[0]=a&255,C[1]=a>>>8&255,i.check=Ee(i.check,C,2,0)),a=0,u=0,i.mode=Jn;case Jn:for(;u<32;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}i.head&&(i.head.time=a),i.flags&512&&i.wrap&4&&(C[0]=a&255,C[1]=a>>>8&255,C[2]=a>>>16&255,C[3]=a>>>24&255,i.check=Ee(i.check,C,4,0)),a=0,u=0,i.mode=Qn;case Qn:for(;u<16;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}i.head&&(i.head.xflags=a&255,i.head.os=a>>8),i.flags&512&&i.wrap&4&&(C[0]=a&255,C[1]=a>>>8&255,i.check=Ee(i.check,C,2,0)),a=0,u=0,i.mode=eo;case eo:if(i.flags&1024){for(;u<16;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}i.length=a,i.head&&(i.head.extra_len=a),i.flags&512&&i.wrap&4&&(C[0]=a&255,C[1]=a>>>8&255,i.check=Ee(i.check,C,2,0)),a=0,u=0}else i.head&&(i.head.extra=null);i.mode=to;case to:if(i.flags&1024&&(S=i.length,S>s&&(S=s),S&&(i.head&&(x=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(r.subarray(d,d+S),x)),i.flags&512&&i.wrap&4&&(i.check=Ee(i.check,r,S,d)),s-=S,d+=S,i.length-=S),i.length))break e;i.length=0,i.mode=io;case io:if(i.flags&2048){if(s===0)break e;S=0;do x=r[d+S++],i.head&&x&&i.length<65536&&(i.head.name+=String.fromCharCode(x));while(x&&S<s);if(i.flags&512&&i.wrap&4&&(i.check=Ee(i.check,r,S,d)),s-=S,d+=S,x)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=so;case so:if(i.flags&4096){if(s===0)break e;S=0;do x=r[d+S++],i.head&&x&&i.length<65536&&(i.head.comment+=String.fromCharCode(x));while(x&&S<s);if(i.flags&512&&i.wrap&4&&(i.check=Ee(i.check,r,S,d)),s-=S,d+=S,x)break e}else i.head&&(i.head.comment=null);i.mode=ro;case ro:if(i.flags&512){for(;u<16;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(i.wrap&4&&a!==(i.check&65535)){e.msg="header crc mismatch",i.mode=be;break}a=0,u=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=ct;break;case no:for(;u<32;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}e.adler=i.check=So(a),a=0,u=0,i.mode=ms;case ms:if(i.havedict===0)return e.next_out=v,e.avail_out=l,e.next_in=d,e.avail_in=s,i.hold=a,i.bits=u,b_;e.adler=i.check=1,i.mode=ct;case ct:if(t===m_||t===Qi)break e;case Gs:if(i.last){a>>>=u&7,u-=u&7,i.mode=Ys;break}for(;u<3;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}switch(i.last=a&1,a>>>=1,u-=1,a&3){case 0:i.mode=oo;break;case 1:if(A_(i),i.mode=es,t===Qi){a>>>=2,u-=2;break e}break;case 2:i.mode=lo;break;case 3:e.msg="invalid block type",i.mode=be}a>>>=2,u-=2;break;case oo:for(a>>>=u&7,u-=u&7;u<32;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if((a&65535)!==(a>>>16^65535)){e.msg="invalid stored block lengths",i.mode=be;break}if(i.length=a&65535,a=0,u=0,i.mode=Xs,t===Qi)break e;case Xs:i.mode=ao;case ao:if(S=i.length,S){if(S>s&&(S=s),S>l&&(S=l),S===0)break e;o.set(r.subarray(d,d+S),v),s-=S,d+=S,l-=S,v+=S,i.length-=S;break}i.mode=ct;break;case lo:for(;u<14;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(i.nlen=(a&31)+257,a>>>=5,u-=5,i.ndist=(a&31)+1,a>>>=5,u-=5,i.ncode=(a&15)+4,a>>>=4,u-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=be;break}i.have=0,i.mode=ho;case ho:for(;i.have<i.ncode;){for(;u<3;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}i.lens[D[i.have++]]=a&7,a>>>=3,u-=3}for(;i.have<19;)i.lens[D[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,A={bits:i.lenbits},m=xi(v_,i.lens,0,19,i.lencode,0,i.work,A),i.lenbits=A.bits,m){e.msg="invalid code lengths set",i.mode=be;break}i.have=0,i.mode=co;case co:for(;i.have<i.nlen+i.ndist;){for(;n=i.lencode[a&(1<<i.lenbits)-1],f=n>>>24,h=n>>>16&255,c=n&65535,!(f<=u);){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(c<16)a>>>=f,u-=f,i.lens[i.have++]=c;else{if(c===16){for(T=f+2;u<T;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(a>>>=f,u-=f,i.have===0){e.msg="invalid bit length repeat",i.mode=be;break}x=i.lens[i.have-1],S=3+(a&3),a>>>=2,u-=2}else if(c===17){for(T=f+3;u<T;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}a>>>=f,u-=f,x=0,S=3+(a&7),a>>>=3,u-=3}else{for(T=f+7;u<T;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}a>>>=f,u-=f,x=0,S=11+(a&127),a>>>=7,u-=7}if(i.have+S>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=be;break}for(;S--;)i.lens[i.have++]=x}}if(i.mode===be)break;if(i.lens[256]===0){e.msg="invalid code -- missing end-of-block",i.mode=be;break}if(i.lenbits=9,A={bits:i.lenbits},m=xi(ja,i.lens,0,i.nlen,i.lencode,0,i.work,A),i.lenbits=A.bits,m){e.msg="invalid literal/lengths set",i.mode=be;break}if(i.distbits=6,i.distcode=i.distdyn,A={bits:i.distbits},m=xi(Ka,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,A),i.distbits=A.bits,m){e.msg="invalid distances set",i.mode=be;break}if(i.mode=es,t===Qi)break e;case es:i.mode=ts;case ts:if(s>=6&&l>=258){e.next_out=v,e.avail_out=l,e.next_in=d,e.avail_in=s,i.hold=a,i.bits=u,d_(e,g),v=e.next_out,o=e.output,l=e.avail_out,d=e.next_in,r=e.input,s=e.avail_in,a=i.hold,u=i.bits,i.mode===ct&&(i.back=-1);break}for(i.back=0;n=i.lencode[a&(1<<i.lenbits)-1],f=n>>>24,h=n>>>16&255,c=n&65535,!(f<=u);){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(h&&!(h&240)){for(p=f,b=h,E=c;n=i.lencode[E+((a&(1<<p+b)-1)>>p)],f=n>>>24,h=n>>>16&255,c=n&65535,!(p+f<=u);){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}a>>>=p,u-=p,i.back+=p}if(a>>>=f,u-=f,i.back+=f,i.length=c,h===0){i.mode=go;break}if(h&32){i.back=-1,i.mode=ct;break}if(h&64){e.msg="invalid literal/length code",i.mode=be;break}i.extra=h&15,i.mode=fo;case fo:if(i.extra){for(T=i.extra;u<T;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}i.length+=a&(1<<i.extra)-1,a>>>=i.extra,u-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=_o;case _o:for(;n=i.distcode[a&(1<<i.distbits)-1],f=n>>>24,h=n>>>16&255,c=n&65535,!(f<=u);){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(!(h&240)){for(p=f,b=h,E=c;n=i.distcode[E+((a&(1<<p+b)-1)>>p)],f=n>>>24,h=n>>>16&255,c=n&65535,!(p+f<=u);){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}a>>>=p,u-=p,i.back+=p}if(a>>>=f,u-=f,i.back+=f,h&64){e.msg="invalid distance code",i.mode=be;break}i.offset=c,i.extra=h&15,i.mode=uo;case uo:if(i.extra){for(T=i.extra;u<T;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}i.offset+=a&(1<<i.extra)-1,a>>>=i.extra,u-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=be;break}i.mode=po;case po:if(l===0)break e;if(S=g-l,i.offset>S){if(S=i.offset-S,S>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=be;break}S>i.wnext?(S-=i.wnext,y=i.wsize-S):y=i.wnext-S,S>i.length&&(S=i.length),w=i.window}else w=o,y=v-i.offset,S=i.length;S>l&&(S=l),l-=S,i.length-=S;do o[v++]=w[y++];while(--S);i.length===0&&(i.mode=ts);break;case go:if(l===0)break e;o[v++]=i.length,l--,i.mode=ts;break;case Ys:if(i.wrap){for(;u<32;){if(s===0)break e;s--,a|=r[d++]<<u,u+=8}if(g-=l,e.total_out+=g,i.total+=g,i.wrap&4&&g&&(e.adler=i.check=i.flags?Ee(i.check,o,g,v-g):Bi(i.check,o,g,v-g)),g=l,i.wrap&4&&(i.flags?a:So(a))!==i.check){e.msg="incorrect data check",i.mode=be;break}a=0,u=0}i.mode=vo;case vo:if(i.wrap&&i.flags){for(;u<32;){if(s===0)break e;s--,a+=r[d++]<<u,u+=8}if(i.wrap&4&&a!==(i.total&4294967295)){e.msg="incorrect length check",i.mode=be;break}a=0,u=0}i.mode=mo;case mo:m=S_;break e;case be:m=Za;break e;case Va:return qa;case Ga:default:return Ve}return e.next_out=v,e.avail_out=l,e.next_in=d,e.avail_in=s,i.hold=a,i.bits=u,(i.wsize||g!==e.avail_out&&i.mode<be&&(i.mode<Ys||t!==Gn))&&el(e,e.output,e.next_out,g-e.avail_out),_-=e.avail_in,g-=e.avail_out,e.total_in+=_,e.total_out+=g,i.total+=g,i.wrap&4&&g&&(e.adler=i.check=i.flags?Ee(i.check,o,g,e.next_out-g):Bi(i.check,o,g,e.next_out-g)),e.data_type=i.bits+(i.last?64:0)+(i.mode===ct?128:0)+(i.mode===es||i.mode===Xs?256:0),(_===0&&g===0||t===Gn)&&m===Wt&&(m=w_),m},D_=e=>{if($t(e))return Ve;let t=e.state;return t.window&&(t.window=null),e.state=null,Wt},T_=(e,t)=>{if($t(e))return Ve;const i=e.state;return i.wrap&2?(i.head=t,t.done=!1,Wt):Ve},I_=(e,t)=>{const i=t.length;let r,o,d;return $t(e)||(r=e.state,r.wrap!==0&&r.mode!==ms)?Ve:r.mode===ms&&(o=1,o=Bi(o,t,i,0),o!==r.check)?Za:(d=el(e,t,i,i),d?(r.mode=Va,qa):(r.havedict=1,Wt))};var M_=Ya,O_=Ja,P_=Xa,B_=R_,H_=Qa,F_=L_,U_=D_,N_=T_,W_=I_,z_="pako inflate (from Nodeca project)",_t={inflateReset:M_,inflateReset2:O_,inflateResetKeep:P_,inflateInit:B_,inflateInit2:H_,inflate:F_,inflateEnd:U_,inflateGetHeader:N_,inflateSetDictionary:W_,inflateInfo:z_};function $_(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var j_=$_;const tl=Object.prototype.toString,{Z_NO_FLUSH:K_,Z_FINISH:Z_,Z_OK:Ui,Z_STREAM_END:er,Z_NEED_DICT:tr,Z_STREAM_ERROR:q_,Z_DATA_ERROR:wo,Z_MEM_ERROR:V_}=ci;function $i(e){this.options=Is.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new za,this.strm.avail_out=0;let i=_t.inflateInit2(this.strm,t.windowBits);if(i!==Ui)throw new Error(Ut[i]);if(this.header=new j_,_t.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Fi.string2buf(t.dictionary):tl.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=_t.inflateSetDictionary(this.strm,t.dictionary),i!==Ui)))throw new Error(Ut[i])}$i.prototype.push=function(e,t){const i=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let d,v,s;if(this.ended)return!1;for(t===~~t?v=t:v=t===!0?Z_:K_,tl.call(e)==="[object ArrayBuffer]"?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),d=_t.inflate(i,v),d===tr&&o&&(d=_t.inflateSetDictionary(i,o),d===Ui?d=_t.inflate(i,v):d===wo&&(d=tr));i.avail_in>0&&d===er&&i.state.wrap>0&&e[i.next_in]!==0;)_t.inflateReset(i),d=_t.inflate(i,v);switch(d){case q_:case wo:case tr:case V_:return this.onEnd(d),this.ended=!0,!1}if(s=i.avail_out,i.next_out&&(i.avail_out===0||d===er))if(this.options.to==="string"){let l=Fi.utf8border(i.output,i.next_out),a=i.next_out-l,u=Fi.buf2string(i.output,l);i.next_out=a,i.avail_out=r-a,a&&i.output.set(i.output.subarray(l,l+a),0),this.onData(u)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(!(d===Ui&&s===0)){if(d===er)return d=_t.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,!0;if(i.avail_in===0)break}}return!0};$i.prototype.onData=function(e){this.chunks.push(e)};$i.prototype.onEnd=function(e){e===Ui&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Is.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function en(e,t){const i=new $i(t);if(i.push(e),i.err)throw i.msg||Ut[i.err];return i.result}function G_(e,t){return t=t||{},t.raw=!0,en(e,t)}var X_=$i,Y_=en,J_=G_,Q_=en,eu=ci,tu={Inflate:X_,inflate:Y_,inflateRaw:J_,ungzip:Q_,constants:eu};const{Deflate:Hu,deflate:iu,deflateRaw:Fu,gzip:Uu}=h_,{Inflate:su,inflate:Nu,inflateRaw:Wu,ungzip:zu}=tu;var ru=iu,nu=su;class il{constructor(t){this.device=t,this.slip_reader_enabled=!1,this.left_over=new Uint8Array(0),this.baudrate=0,this._DTR_state=!1}get_info(){const t=this.device.getInfo();return t.usbVendorId&&t.usbProductId?`WebSerial VendorID 0x${t.usbVendorId.toString(16)} ProductID 0x${t.usbProductId.toString(16)}`:""}get_pid(){return this.device.getInfo().usbProductId}slip_writer(t){let i=0,r=0,o=0;for(r=0;r<t.length;r++)(t[r]===192||t[r]===219)&&i++;const d=new Uint8Array(2+i+t.length);for(d[0]=192,o=1,r=0;r<t.length;r++,o++){if(t[r]===192){d[o++]=219,d[o]=220;continue}if(t[r]===219){d[o++]=219,d[o]=221;continue}d[o]=t[r]}return d[o]=192,d}async write(t){const i=this.slip_writer(t);if(this.device.writable){const r=this.device.writable.getWriter();await r.write(i),r.releaseLock()}}_appendBuffer(t,i){const r=new Uint8Array(t.byteLength+i.byteLength);return r.set(new Uint8Array(t),0),r.set(new Uint8Array(i),t.byteLength),r.buffer}slip_reader(t){let i=0,r=0,o=0,d="init";for(;i<t.length;){if(d==="init"&&t[i]==192){r=i+1,d="valid_data",i++;continue}if(d==="valid_data"&&t[i]==192){o=i-1,d="packet_complete";break}i++}if(d!=="packet_complete")return this.left_over=t,new Uint8Array(0);this.left_over=t.slice(o+2);const v=new Uint8Array(o-r+1);let s=0;for(i=r;i<=o;i++,s++){if(t[i]===219&&t[i+1]===220){v[s]=192,i++;continue}if(t[i]===219&&t[i+1]===221){v[s]=219,i++;continue}v[s]=t[i]}return v.slice(0,s)}async read(t=0,i=12){let r,o=this.left_over;if(this.left_over=new Uint8Array(0),this.slip_reader_enabled){const v=this.slip_reader(o);if(v.length>0)return v;o=this.left_over,this.left_over=new Uint8Array(0)}if(this.device.readable==null)return this.left_over;const d=this.device.readable.getReader();try{t>0&&(r=setTimeout(function(){d.cancel()},t));do{const{value:v,done:s}=await d.read();if(s)throw this.left_over=o,new Error("Timeout");o=new Uint8Array(this._appendBuffer(o.buffer,v.buffer))}while(o.length<i)}finally{t>0&&clearTimeout(r),d.releaseLock()}return this.slip_reader_enabled?this.slip_reader(o):o}async rawRead(t=0){if(this.left_over.length!=0){const o=this.left_over;return this.left_over=new Uint8Array(0),o}if(!this.device.readable)return this.left_over;const i=this.device.readable.getReader();let r;try{t>0&&(r=setTimeout(function(){i.cancel()},t));const{value:o,done:d}=await i.read();if(d)throw new Error("Timeout");return o}finally{t>0&&clearTimeout(r),i.releaseLock()}}async setRTS(t){await this.device.setSignals({requestToSend:t}),await this.setDTR(this._DTR_state)}async setDTR(t){this._DTR_state=t,await this.device.setSignals({dataTerminalReady:t})}async connect(t=115200){await this.device.open({baudRate:t}),this.baudrate=t,this.left_over=new Uint8Array(0)}async sleep(t){return new Promise(i=>setTimeout(i,t))}async waitForUnlock(t){for(;this.device.readable&&this.device.readable.locked||this.device.writable&&this.device.writable.locked;)await this.sleep(t)}async disconnect(){await this.waitForUnlock(400),await this.device.close()}}function hs(e){return new Promise(t=>setTimeout(t,e))}async function ou(e){await e.setRTS(!1),await e.setDTR(!1),await hs(100),await e.setDTR(!0),await e.setRTS(!1),await hs(100),await e.setRTS(!0),await e.setDTR(!1),await e.setRTS(!0),await hs(100),await e.setRTS(!1),await e.setDTR(!1)}function au(e){const t=["D","R","W"],i=e.split("|");for(const r of i){const o=r[0],d=r.slice(1);if(!t.includes(o))return!1;if(o==="D"||o==="R"){if(d!=="0"&&d!=="1")return!1}else if(o==="W"){const v=parseInt(d);if(isNaN(v)||v<=0)return!1}}return!0}async function lu(e,t){const i={D:async r=>await e.setDTR(r),R:async r=>await e.setRTS(r),W:async r=>await hs(r)};try{if(!au(t))return;const o=t.split("|");for(const d of o){const v=d[0],s=d.slice(1);v==="W"?await i.W(Number(s)):(v==="D"||v==="R")&&await i[v](s==="1")}}catch{throw new Error("Invalid custom reset sequence")}}async function hu(e){switch(e){case 15736195:{const{ESP32ROM:t}=await Tt(()=>import("/mc3/esp32-ea6ce03f.js"),["mc3/assets/esp32-ea6ce03f.js","mc3/assets/rom-74524d0c.js"]);return new t}case 1763790959:case 456216687:{const{ESP32C3ROM:t}=await Tt(()=>import("/mc3/assets/esp32c3-b5062337.js"),["mc3/assets/esp32c3-b5062337.js","mc3/assets/rom-74524d0c.js"]);return new t}case 752910447:{const{ESP32C6ROM:t}=await Tt(()=>import("/mc3/esp32c6-a0e48e87.js"),["mc3/assets/esp32c6-a0e48e87.js","mc3/assets/rom-74524d0c.js"]);return new t}case 3619110528:{const{ESP32H2ROM:t}=await Tt(()=>import("/mc3/esp32h2-8d04281c.js"),["mc3/assets/esp32h2-8d04281c.js","mc3/assets/rom-74524d0c.js"]);return new t}case 9:{const{ESP32S3ROM:t}=await Tt(()=>import("/mc3/esp32s3-0049c7aa.js"),["mc3/assets/esp32s3-0049c7aa.js","mc3/assets/rom-74524d0c.js"]);return new t}case 1990:{const{ESP32S2ROM:t}=await Tt(()=>import("/mc3/assets/esp32s2-a8038710.js"),["mc3/assets/esp32s2-a8038710.js","mc3/assets/rom-74524d0c.js"]);return new t}case 4293968129:{const{ESP8266ROM:t}=await Tt(()=>import("./esp8266-5b2b537a.js"),["mc3/assets/esp8266-5b2b537a.js","mc3/assets/rom-74524d0c.js"]);return new t}default:return null}}class cu{constructor(t){this.ESP_RAM_BLOCK=6144,this.ESP_FLASH_BEGIN=2,this.ESP_FLASH_DATA=3,this.ESP_FLASH_END=4,this.ESP_MEM_BEGIN=5,this.ESP_MEM_END=6,this.ESP_MEM_DATA=7,this.ESP_WRITE_REG=9,this.ESP_READ_REG=10,this.ESP_SPI_ATTACH=13,this.ESP_CHANGE_BAUDRATE=15,this.ESP_FLASH_DEFL_BEGIN=16,this.ESP_FLASH_DEFL_DATA=17,this.ESP_FLASH_DEFL_END=18,this.ESP_SPI_FLASH_MD5=19,this.ESP_ERASE_FLASH=208,this.ESP_ERASE_REGION=209,this.ESP_READ_FLASH=210,this.ESP_RUN_USER_CODE=211,this.ESP_IMAGE_MAGIC=233,this.ESP_CHECKSUM_MAGIC=239,this.ROM_INVALID_RECV_MSG=5,this.ERASE_REGION_TIMEOUT_PER_MB=3e4,this.ERASE_WRITE_TIMEOUT_PER_MB=4e4,this.MD5_TIMEOUT_PER_MB=8e3,this.CHIP_ERASE_TIMEOUT=12e4,this.FLASH_READ_TIMEOUT=1e5,this.MAX_TIMEOUT=this.CHIP_ERASE_TIMEOUT*2,this.CHIP_DETECT_MAGIC_REG_ADDR=1073745920,this.DETECTED_FLASH_SIZES={18:"256KB",19:"512KB",20:"1MB",21:"2MB",22:"4MB",23:"8MB",24:"16MB"},this.DETECTED_FLASH_SIZES_NUM={18:256,19:512,20:1024,21:2048,22:4096,23:8192,24:16384},this.USB_JTAG_SERIAL_PID=4097,this.romBaudrate=115200,this.debugLogging=!1,this.checksum=function(i){let r,o=239;for(r=0;r<i.length;r++)o^=i[r];return o},this.timeout_per_mb=function(i,r){const o=i*(r/1e6);return o<3e3?3e3:o},this.flash_size_bytes=function(i){let r=-1;return i.indexOf("KB")!==-1?r=parseInt(i.slice(0,i.indexOf("KB")))*1024:i.indexOf("MB")!==-1&&(r=parseInt(i.slice(0,i.indexOf("MB")))*1024*1024),r},this.IS_STUB=!1,this.FLASH_WRITE_SIZE=16384,this.transport=t.transport,this.baudrate=t.baudrate,t.romBaudrate&&(this.romBaudrate=t.romBaudrate),t.terminal&&(this.terminal=t.terminal,this.terminal.clean()),t.debugLogging&&(this.debugLogging=t.debugLogging),t.port&&(this.transport=new il(t.port)),this.info("esptool.js"),this.info("Serial port "+this.transport.get_info())}_sleep(t){return new Promise(i=>setTimeout(i,t))}write(t,i=!0){this.terminal?i?this.terminal.writeLine(t):this.terminal.write(t):console.log(t)}error(t,i=!0){this.write(`Error: ${t}`,i)}info(t,i=!0){this.write(t,i)}debug(t,i=!0){this.debugLogging&&this.write(`Debug: ${t}`,i)}_short_to_bytearray(t){return new Uint8Array([t&255,t>>8&255])}_int_to_bytearray(t){return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}_bytearray_to_short(t,i){return t|i>>8}_bytearray_to_int(t,i,r,o){return t|i<<8|r<<16|o<<24}_appendBuffer(t,i){const r=new Uint8Array(t.byteLength+i.byteLength);return r.set(new Uint8Array(t),0),r.set(new Uint8Array(i),t.byteLength),r.buffer}_appendArray(t,i){const r=new Uint8Array(t.length+i.length);return r.set(t,0),r.set(i,t.length),r}ui8ToBstr(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i}bstrToUi8(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}async flush_input(){try{await this.transport.rawRead(200)}catch(t){this.error(t.message)}}async read_packet(t=null,i=3e3){for(let r=0;r<100;r++){const o=await this.transport.read(i),d=o[0],v=o[1],s=this._bytearray_to_int(o[4],o[5],o[6],o[7]),l=o.slice(8);if(d==1){if(t==null||v==t)return[s,l];if(l[0]!=0&&l[1]==this.ROM_INVALID_RECV_MSG)throw await this.flush_input(),new Oe("unsupported command error")}}throw new Oe("invalid response")}async command(t=null,i=new Uint8Array(0),r=0,o=!0,d=3e3){if(t!=null){const v=new Uint8Array(8+i.length);v[0]=0,v[1]=t,v[2]=this._short_to_bytearray(i.length)[0],v[3]=this._short_to_bytearray(i.length)[1],v[4]=this._int_to_bytearray(r)[0],v[5]=this._int_to_bytearray(r)[1],v[6]=this._int_to_bytearray(r)[2],v[7]=this._int_to_bytearray(r)[3];let s;for(s=0;s<i.length;s++)v[8+s]=i[s];await this.transport.write(v)}return o?this.read_packet(t,d):[0,new Uint8Array(0)]}async read_reg(t,i=3e3){const r=this._int_to_bytearray(t);return(await this.command(this.ESP_READ_REG,r,void 0,void 0,i))[0]}async write_reg(t,i,r=4294967295,o=0,d=0){let v=this._appendArray(this._int_to_bytearray(t),this._int_to_bytearray(i));v=this._appendArray(v,this._int_to_bytearray(r)),v=this._appendArray(v,this._int_to_bytearray(o)),d>0&&(v=this._appendArray(v,this._int_to_bytearray(this.chip.UART_DATE_REG_ADDR)),v=this._appendArray(v,this._int_to_bytearray(0)),v=this._appendArray(v,this._int_to_bytearray(0)),v=this._appendArray(v,this._int_to_bytearray(d))),await this.check_command("write target memory",this.ESP_WRITE_REG,v)}async sync(){this.debug("Sync");const t=new Uint8Array(36);let i;for(t[0]=7,t[1]=7,t[2]=18,t[3]=32,i=0;i<32;i++)t[4+i]=85;try{return await this.command(8,t,void 0,void 0,100)}catch(r){throw this.debug("Sync err "+r),r}}async _connect_attempt(t="default_reset",i=!1){if(this.debug("_connect_attempt "+t+" "+i),t!=="no_reset")if(this.transport.get_pid()===this.USB_JTAG_SERIAL_PID)await ou(this.transport);else{const d=i?"D0|R1|W100|W2000|D1|R0|W50|D0":"D0|R1|W100|D1|R0|W50|D0";await lu(this.transport,d)}let r=0,o=!0;for(;o;){try{const d=await this.transport.read(1e3);r+=d.length}catch(d){if(this.debug(d.message),d instanceof Error){o=!1;break}}await this._sleep(50)}for(this.transport.slip_reader_enabled=!0,r=7;r--;){try{const d=await this.sync();return this.debug(d[0].toString()),"success"}catch(d){d instanceof Error&&(i?this.info("_",!1):this.info(".",!1))}await this._sleep(50)}return"error"}async connect(t="default_reset",i=7,r=!1){let o,d;for(this.info("Connecting...",!1),await this.transport.connect(this.romBaudrate),o=0;o<i&&(d=await this._connect_attempt(t,!1),!(d==="success"||(d=await this._connect_attempt(t,!0),d==="success")));o++);if(d!=="success")throw new Oe("Failed to connect with the device");if(this.info(`
\r`,!1),!r){const v=await this.read_reg(1073745920)>>>0;this.debug("Chip Magic "+v.toString(16));const s=await hu(v);if(this.chip===null)throw new Oe(`Unexpected CHIP magic value ${v}. Failed to autodetect chip type.`);this.chip=s}}async detect_chip(t="default_reset"){await this.connect(t),this.info("Detecting chip type... ",!1),this.chip!=null?this.info(this.chip.CHIP_NAME):this.info("unknown!")}async check_command(t="",i=null,r=new Uint8Array(0),o=0,d=3e3){this.debug("check_command "+t);const v=await this.command(i,r,o,void 0,d);return v[1].length>4?v[1]:v[0]}async mem_begin(t,i,r,o){this.debug("mem_begin "+t+" "+i+" "+r+" "+o.toString(16));let d=this._appendArray(this._int_to_bytearray(t),this._int_to_bytearray(i));d=this._appendArray(d,this._int_to_bytearray(r)),d=this._appendArray(d,this._int_to_bytearray(o)),await this.check_command("enter RAM download mode",this.ESP_MEM_BEGIN,d)}async mem_block(t,i){let r=this._appendArray(this._int_to_bytearray(t.length),this._int_to_bytearray(i));r=this._appendArray(r,this._int_to_bytearray(0)),r=this._appendArray(r,this._int_to_bytearray(0)),r=this._appendArray(r,t);const o=this.checksum(t);await this.check_command("write to target RAM",this.ESP_MEM_DATA,r,o)}async mem_finish(t){const i=t===0?1:0,r=this._appendArray(this._int_to_bytearray(i),this._int_to_bytearray(t));await this.check_command("leave RAM download mode",this.ESP_MEM_END,r,void 0,50)}async flash_spi_attach(t){const i=this._int_to_bytearray(t);await this.check_command("configure SPI flash pins",this.ESP_SPI_ATTACH,i)}async flash_begin(t,i){const r=Math.floor((t+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),o=this.chip.get_erase_size(i,t),d=new Date,v=d.getTime();let s=3e3;this.IS_STUB==!1&&(s=this.timeout_per_mb(this.ERASE_REGION_TIMEOUT_PER_MB,t)),this.debug("flash begin "+o+" "+r+" "+this.FLASH_WRITE_SIZE+" "+i+" "+t);let l=this._appendArray(this._int_to_bytearray(o),this._int_to_bytearray(r));l=this._appendArray(l,this._int_to_bytearray(this.FLASH_WRITE_SIZE)),l=this._appendArray(l,this._int_to_bytearray(i)),this.IS_STUB==!1&&(l=this._appendArray(l,this._int_to_bytearray(0))),await this.check_command("enter Flash download mode",this.ESP_FLASH_BEGIN,l,void 0,s);const a=d.getTime();return t!=0&&this.IS_STUB==!1&&this.info("Took "+(a-v)/1e3+"."+(a-v)%1e3+"s to erase flash block"),r}async flash_defl_begin(t,i,r){const o=Math.floor((i+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),d=Math.floor((t+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),v=new Date,s=v.getTime();let l,a;this.IS_STUB?(l=t,a=3e3):(l=d*this.FLASH_WRITE_SIZE,a=this.timeout_per_mb(this.ERASE_REGION_TIMEOUT_PER_MB,l)),this.info("Compressed "+t+" bytes to "+i+"...");let u=this._appendArray(this._int_to_bytearray(l),this._int_to_bytearray(o));u=this._appendArray(u,this._int_to_bytearray(this.FLASH_WRITE_SIZE)),u=this._appendArray(u,this._int_to_bytearray(r)),(this.chip.CHIP_NAME==="ESP32-S2"||this.chip.CHIP_NAME==="ESP32-S3"||this.chip.CHIP_NAME==="ESP32-C3")&&this.IS_STUB===!1&&(u=this._appendArray(u,this._int_to_bytearray(0))),await this.check_command("enter compressed flash mode",this.ESP_FLASH_DEFL_BEGIN,u,void 0,a);const _=v.getTime();return t!=0&&this.IS_STUB===!1&&this.info("Took "+(_-s)/1e3+"."+(_-s)%1e3+"s to erase flash block"),o}async flash_block(t,i,r){let o=this._appendArray(this._int_to_bytearray(t.length),this._int_to_bytearray(i));o=this._appendArray(o,this._int_to_bytearray(0)),o=this._appendArray(o,this._int_to_bytearray(0)),o=this._appendArray(o,t);const d=this.checksum(t);await this.check_command("write to target Flash after seq "+i,this.ESP_FLASH_DATA,o,d,r)}async flash_defl_block(t,i,r){let o=this._appendArray(this._int_to_bytearray(t.length),this._int_to_bytearray(i));o=this._appendArray(o,this._int_to_bytearray(0)),o=this._appendArray(o,this._int_to_bytearray(0)),o=this._appendArray(o,t);const d=this.checksum(t);this.debug("flash_defl_block "+t[0].toString(16)+" "+t[1].toString(16)),await this.check_command("write compressed data to flash after seq "+i,this.ESP_FLASH_DEFL_DATA,o,d,r)}async flash_finish(t=!1){const i=t?0:1,r=this._int_to_bytearray(i);await this.check_command("leave Flash mode",this.ESP_FLASH_END,r)}async flash_defl_finish(t=!1){const i=t?0:1,r=this._int_to_bytearray(i);await this.check_command("leave compressed flash mode",this.ESP_FLASH_DEFL_END,r)}async run_spiflash_command(t,i,r){const s=this.chip.SPI_REG_BASE,l=s+0,a=s+this.chip.SPI_USR_OFFS,u=s+this.chip.SPI_USR1_OFFS,_=s+this.chip.SPI_USR2_OFFS,g=s+this.chip.SPI_W0_OFFS;let S;this.chip.SPI_MOSI_DLEN_OFFS!=null?S=async(x,m)=>{const C=s+this.chip.SPI_MOSI_DLEN_OFFS,A=s+this.chip.SPI_MISO_DLEN_OFFS;x>0&&await this.write_reg(C,x-1),m>0&&await this.write_reg(A,m-1)}:S=async(x,m)=>{const C=u,A=17,T=8,D=x===0?0:x-1,U=(m===0?0:m-1)<<T|D<<A;await this.write_reg(C,U)};const y=1<<18,w=28;if(r>32)throw new Oe("Reading more than 32 bits back from a SPI flash operation is unsupported");if(i.length>64)throw new Oe("Writing more than 64 bytes of data with one SPI command is unsupported");const n=i.length*8,f=await this.read_reg(a),h=await this.read_reg(_);let c=-2147483648,p;r>0&&(c|=268435456),n>0&&(c|=134217728),await S(n,r),await this.write_reg(a,c);let b=7<<w|t;if(await this.write_reg(_,b),n==0)await this.write_reg(g,0);else{if(i.length%4!=0){const m=new Uint8Array(i.length%4);i=this._appendArray(i,m)}let x=g;for(p=0;p<i.length-4;p+=4)b=this._bytearray_to_int(i[p],i[p+1],i[p+2],i[p+3]),await this.write_reg(x,b),x+=4}for(await this.write_reg(l,y),p=0;p<10&&(b=await this.read_reg(l)&y,b!=0);p++);if(p===10)throw new Oe("SPI command did not complete in time");const E=await this.read_reg(g);return await this.write_reg(a,f),await this.write_reg(_,h),E}async read_flash_id(){const i=new Uint8Array(0);return await this.run_spiflash_command(159,i,24)}async erase_flash(){this.info("Erasing flash (this may take a while)...");let t=new Date;const i=t.getTime(),r=await this.check_command("erase flash",this.ESP_ERASE_FLASH,void 0,void 0,this.CHIP_ERASE_TIMEOUT);t=new Date;const o=t.getTime();return this.info("Chip erase completed successfully in "+(o-i)/1e3+"s"),r}toHex(t){return Array.prototype.map.call(t,i=>("00"+i.toString(16)).slice(-2)).join("")}async flash_md5sum(t,i){const r=this.timeout_per_mb(this.MD5_TIMEOUT_PER_MB,i);let o=this._appendArray(this._int_to_bytearray(t),this._int_to_bytearray(i));o=this._appendArray(o,this._int_to_bytearray(0)),o=this._appendArray(o,this._int_to_bytearray(0));let d=await this.check_command("calculate md5sum",this.ESP_SPI_FLASH_MD5,o,void 0,r);return d instanceof Uint8Array&&d.length>16&&(d=d.slice(0,16)),this.toHex(d)}async read_flash(t,i,r=null){let o=this._appendArray(this._int_to_bytearray(t),this._int_to_bytearray(i));o=this._appendArray(o,this._int_to_bytearray(4096)),o=this._appendArray(o,this._int_to_bytearray(1024));const d=await this.check_command("read flash",this.ESP_READ_FLASH,o);if(d!=0)throw new Oe("Failed to read memory: "+d);let v=new Uint8Array(0);for(;v.length<i;){const s=await this.transport.read(this.FLASH_READ_TIMEOUT);if(s instanceof Uint8Array)s.length>0&&(v=this._appendArray(v,s),await this.transport.write(this._int_to_bytearray(v.length)),r&&r(s,v.length,i));else throw new Oe("Failed to read memory: "+s)}return v}async run_stub(){this.info("Uploading stub...");let t=atob(this.chip.ROM_TEXT),i=t.split("").map(function(s){return s.charCodeAt(0)});const r=new Uint8Array(i);t=atob(this.chip.ROM_DATA),i=t.split("").map(function(s){return s.charCodeAt(0)});const o=new Uint8Array(i);let d=Math.floor((r.length+this.ESP_RAM_BLOCK-1)/this.ESP_RAM_BLOCK),v;for(await this.mem_begin(r.length,d,this.ESP_RAM_BLOCK,this.chip.TEXT_START),v=0;v<d;v++){const s=v*this.ESP_RAM_BLOCK,l=s+this.ESP_RAM_BLOCK;await this.mem_block(r.slice(s,l),v)}for(d=Math.floor((o.length+this.ESP_RAM_BLOCK-1)/this.ESP_RAM_BLOCK),await this.mem_begin(o.length,d,this.ESP_RAM_BLOCK,this.chip.DATA_START),v=0;v<d;v++){const s=v*this.ESP_RAM_BLOCK,l=s+this.ESP_RAM_BLOCK;await this.mem_block(o.slice(s,l),v)}this.info("Running stub..."),await this.mem_finish(this.chip.ENTRY);for(let s=0;s<100;s++){const l=await this.transport.read(1e3,6);if(l[0]===79&&l[1]===72&&l[2]===65&&l[3]===73)return this.info("Stub running..."),this.IS_STUB=!0,this.FLASH_WRITE_SIZE=16384,this.chip}throw new Oe("Failed to start stub. Unexpected response")}async change_baud(){this.info("Changing baudrate to "+this.baudrate);const t=this.IS_STUB?this.transport.baudrate:0,i=this._appendArray(this._int_to_bytearray(this.baudrate),this._int_to_bytearray(t)),r=await this.command(this.ESP_CHANGE_BAUDRATE,i);this.debug(r[0].toString()),this.info("Changed"),await this.transport.disconnect(),await this._sleep(50),await this.transport.connect(this.baudrate);try{let o=64;for(;o--;){try{await this.sync();break}catch(d){this.debug(d.message)}await this._sleep(10)}}catch(o){this.debug(o.message)}}async main_fn(t="default_reset"){await this.detect_chip(t);const i=await this.chip.get_chip_description(this);return this.info("Chip is "+i),this.info("Features: "+await this.chip.get_chip_features(this)),this.info("Crystal is "+await this.chip.get_crystal_freq(this)+"MHz"),this.info("MAC: "+await this.chip.read_mac(this)),await this.chip.read_mac(this),typeof this.chip._post_connect<"u"&&await this.chip._post_connect(this),await this.run_stub(),this.romBaudrate!==this.baudrate&&await this.change_baud(),i}parse_flash_size_arg(t){if(typeof this.chip.FLASH_SIZES[t]>"u")throw new Oe("Flash size "+t+" is not supported by this chip type. Supported sizes: "+this.chip.FLASH_SIZES);return this.chip.FLASH_SIZES[t]}_update_image_flash_params(t,i,r,o,d){if(this.debug("_update_image_flash_params "+r+" "+o+" "+d),t.length<8||i!=this.chip.BOOTLOADER_FLASH_OFFSET)return t;if(r==="keep"&&o==="keep"&&d==="keep")return this.info("Not changing the image"),t;const v=parseInt(t[0]);let s=parseInt(t[2]);const l=parseInt(t[3]);if(v!==this.ESP_IMAGE_MAGIC)return this.info("Warning: Image file at 0x"+i.toString(16)+" doesn't look like an image file, so not changing any flash settings."),t;o!=="keep"&&(s={qio:0,qout:1,dio:2,dout:3}[o]);let a=l&15;d!=="keep"&&(a={"40m":0,"26m":1,"20m":2,"80m":15}[d]);let u=l&240;r!=="keep"&&(u=this.parse_flash_size_arg(r));const _=s<<8|a+u;return this.info("Flash params set to "+_.toString(16)),parseInt(t[2])!==s<<8&&(t=t.substring(0,2)+(s<<8).toString()+t.substring(2+1)),parseInt(t[3])!==a+u&&(t=t.substring(0,3)+(a+u).toString()+t.substring(3+1)),t}async write_flash(t){if(this.debug("EspLoader program"),t.flashSize!=="keep"){const o=this.flash_size_bytes(t.flashSize);for(let d=0;d<t.fileArray.length;d++)if(t.fileArray[d].data.length+t.fileArray[d].address>o)throw new Oe(`File ${d+1} doesn't fit in the available flash`)}this.IS_STUB===!0&&t.eraseAll===!0&&await this.erase_flash();let i,r;for(let o=0;o<t.fileArray.length;o++){this.debug("Data Length "+t.fileArray[o].data.length),i=t.fileArray[o].data;const d=t.fileArray[o].data.length%4;if(d>0&&(i+="".substring(4-d)),r=t.fileArray[o].address,this.debug("Image Length "+i.length),i.length===0){this.debug("Warning: File is empty");continue}i=this._update_image_flash_params(i,r,t.flashSize,t.flashMode,t.flashFreq);let v=null;t.calculateMD5Hash&&(v=t.calculateMD5Hash(i),this.debug("Image MD5 "+v));const s=i.length;let l;if(t.compress){const h=this.bstrToUi8(i);i=this.ui8ToBstr(ru(h,{level:9})),l=await this.flash_defl_begin(s,i.length,r)}else l=await this.flash_begin(s,r);let a=0,u=0;const _=i.length;t.reportProgress&&t.reportProgress(o,0,_);let g=new Date;const S=g.getTime();let y=5e3;const w=new nu({chunkSize:1});let n=0;for(w.onData=function(h){n+=h.byteLength};i.length>0;){this.debug("Write loop "+r+" "+a+" "+l),this.info("Writing at 0x"+(r+n).toString(16)+"... ("+Math.floor(100*(a+1)/l)+"%)");const h=this.bstrToUi8(i.slice(0,this.FLASH_WRITE_SIZE));if(t.compress){const c=n;w.push(h,!1);const p=n-c;let b=3e3;this.timeout_per_mb(this.ERASE_WRITE_TIMEOUT_PER_MB,p)>3e3&&(b=this.timeout_per_mb(this.ERASE_WRITE_TIMEOUT_PER_MB,p)),this.IS_STUB===!1&&(y=b),await this.flash_defl_block(h,a,y),this.IS_STUB&&(y=b)}else throw new Oe("Yet to handle Non Compressed writes");u+=h.length,i=i.slice(this.FLASH_WRITE_SIZE,i.length),a++,t.reportProgress&&t.reportProgress(o,u,_)}this.IS_STUB&&await this.read_reg(this.CHIP_DETECT_MAGIC_REG_ADDR,y),g=new Date;const f=g.getTime()-S;if(t.compress&&this.info("Wrote "+s+" bytes ("+u+" compressed) at 0x"+r.toString(16)+" in "+f/1e3+" seconds."),v){const h=await this.flash_md5sum(r,s);if(new String(h).valueOf()!=new String(v).valueOf())throw this.info("File  md5: "+v),this.info("Flash md5: "+h),new Oe("MD5 of file does not match data in flash!");this.info("Hash of data verified.")}}this.info("Leaving..."),this.IS_STUB&&(await this.flash_begin(0,0),t.compress?await this.flash_defl_finish():await this.flash_finish())}async flash_id(){this.debug("flash_id");const t=await this.read_flash_id();this.info("Manufacturer: "+(t&255).toString(16));const i=t>>16&255;this.info("Device: "+(t>>8&255).toString(16)+i.toString(16)),this.info("Detected flash size: "+this.DETECTED_FLASH_SIZES[i])}async get_flash_size(){this.debug("flash_id");const i=await this.read_flash_id()>>16&255;return this.DETECTED_FLASH_SIZES_NUM[i]}async hard_reset(){await this.transport.setRTS(!0),await this._sleep(100),await this.transport.setRTS(!1)}async soft_reset(){if(!this.IS_STUB)await this.flash_begin(0,0),await this.flash_finish(!1);else{if(this.chip.CHIP_NAME!="ESP8266")throw new Oe("Soft resetting is currently only supported on ESP8266");await this.command(this.ESP_RUN_USER_CODE,void 0,void 0,!1)}}}const Re={INITIALIZING:"initializing",PREPARING:"preparing",ERASING:"erasing",WRITING:"writing",FINISHED:"finished",ERROR:"error"},pi={FAILED_INITIALIZING:"failed_initialize",FAILED_MANIFEST_FETCH:"fetch_manifest_failed",NOT_SUPPORTED:"not_supported",FAILED_FIRMWARE_DOWNLOAD:"failed_firmware_download",WRITE_FAILED:"write_failed"},xr=e=>new Promise(t=>setTimeout(t,e));var sl={exports:{}};(function(e,t){(function(i,r){e.exports=r()})(self,()=>(()=>{var i={4567:function(v,s,l){var a=this&&this.__decorate||function(c,p,b,E){var x,m=arguments.length,C=m<3?p:E===null?E=Object.getOwnPropertyDescriptor(p,b):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(c,p,b,E);else for(var A=c.length-1;A>=0;A--)(x=c[A])&&(C=(m<3?x(C):m>3?x(p,b,C):x(p,b))||C);return m>3&&C&&Object.defineProperty(p,b,C),C},u=this&&this.__param||function(c,p){return function(b,E){p(b,E,c)}};Object.defineProperty(s,"__esModule",{value:!0}),s.AccessibilityManager=void 0;const _=l(9042),g=l(6114),S=l(9924),y=l(844),w=l(5596),n=l(4725),f=l(3656);let h=s.AccessibilityManager=class extends y.Disposable{constructor(c,p){super(),this._terminal=c,this._renderService=p,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let b=0;b<this._terminal.rows;b++)this._rowElements[b]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[b]);if(this._topBoundaryFocusListener=b=>this._handleBoundaryFocus(b,0),this._bottomBoundaryFocusListener=b=>this._handleBoundaryFocus(b,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new S.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(b=>this._handleResize(b.rows))),this.register(this._terminal.onRender(b=>this._refreshRows(b.start,b.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(b=>this._handleChar(b))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(b=>this._handleTab(b))),this.register(this._terminal.onKey(b=>this._handleKey(b.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new w.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,f.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,y.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(c){for(let p=0;p<c;p++)this._handleChar(" ")}_handleChar(c){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==c&&(this._charsToAnnounce+=c):this._charsToAnnounce+=c,c===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=_.tooMuchOutput)),g.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,g.isMac&&this._liveRegion.remove()}_handleKey(c){this._clearLiveRegion(),/\p{Control}/u.test(c)||this._charsToConsume.push(c)}_refreshRows(c,p){this._liveRegionDebouncer.refresh(c,p,this._terminal.rows)}_renderRows(c,p){const b=this._terminal.buffer,E=b.lines.length.toString();for(let x=c;x<=p;x++){const m=b.translateBufferLineToString(b.ydisp+x,!0),C=(b.ydisp+x+1).toString(),A=this._rowElements[x];A&&(m.length===0?A.innerText="":A.textContent=m,A.setAttribute("aria-posinset",C),A.setAttribute("aria-setsize",E))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(c,p){const b=c.target,E=this._rowElements[p===0?1:this._rowElements.length-2];if(b.getAttribute("aria-posinset")===(p===0?"1":`${this._terminal.buffer.lines.length}`)||c.relatedTarget!==E)return;let x,m;if(p===0?(x=b,m=this._rowElements.pop(),this._rowContainer.removeChild(m)):(x=this._rowElements.shift(),m=b,this._rowContainer.removeChild(x)),x.removeEventListener("focus",this._topBoundaryFocusListener),m.removeEventListener("focus",this._bottomBoundaryFocusListener),p===0){const C=this._createAccessibilityTreeNode();this._rowElements.unshift(C),this._rowContainer.insertAdjacentElement("afterbegin",C)}else{const C=this._createAccessibilityTreeNode();this._rowElements.push(C),this._rowContainer.appendChild(C)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(p===0?-1:1),this._rowElements[p===0?1:this._rowElements.length-2].focus(),c.preventDefault(),c.stopImmediatePropagation()}_handleResize(c){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let p=this._rowContainer.children.length;p<this._terminal.rows;p++)this._rowElements[p]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[p]);for(;this._rowElements.length>c;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const c=document.createElement("div");return c.setAttribute("role","listitem"),c.tabIndex=-1,this._refreshRowDimensions(c),c}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let c=0;c<this._terminal.rows;c++)this._refreshRowDimensions(this._rowElements[c])}}_refreshRowDimensions(c){c.style.height=`${this._renderService.dimensions.css.cell.height}px`}};s.AccessibilityManager=h=a([u(1,n.IRenderService)],h)},3614:(v,s)=>{function l(g){return g.replace(/\r?\n/g,"\r")}function a(g,S){return S?"\x1B[200~"+g+"\x1B[201~":g}function u(g,S,y,w){g=a(g=l(g),y.decPrivateModes.bracketedPasteMode&&w.rawOptions.ignoreBracketedPasteMode!==!0),y.triggerDataEvent(g,!0),S.value=""}function _(g,S,y){const w=y.getBoundingClientRect(),n=g.clientX-w.left-10,f=g.clientY-w.top-10;S.style.width="20px",S.style.height="20px",S.style.left=`${n}px`,S.style.top=`${f}px`,S.style.zIndex="1000",S.focus()}Object.defineProperty(s,"__esModule",{value:!0}),s.rightClickHandler=s.moveTextAreaUnderMouseCursor=s.paste=s.handlePasteEvent=s.copyHandler=s.bracketTextForPaste=s.prepareTextForTerminal=void 0,s.prepareTextForTerminal=l,s.bracketTextForPaste=a,s.copyHandler=function(g,S){g.clipboardData&&g.clipboardData.setData("text/plain",S.selectionText),g.preventDefault()},s.handlePasteEvent=function(g,S,y,w){g.stopPropagation(),g.clipboardData&&u(g.clipboardData.getData("text/plain"),S,y,w)},s.paste=u,s.moveTextAreaUnderMouseCursor=_,s.rightClickHandler=function(g,S,y,w,n){_(g,S,y),n&&w.rightClickSelect(g),S.value=w.selectionText,S.select()}},7239:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorContrastCache=void 0;const a=l(1505);s.ColorContrastCache=class{constructor(){this._color=new a.TwoKeyMap,this._css=new a.TwoKeyMap}setCss(u,_,g){this._css.set(u,_,g)}getCss(u,_){return this._css.get(u,_)}setColor(u,_,g){this._color.set(u,_,g)}getColor(u,_){return this._color.get(u,_)}clear(){this._color.clear(),this._css.clear()}}},3656:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.addDisposableDomListener=void 0,s.addDisposableDomListener=function(l,a,u,_){l.addEventListener(a,u,_);let g=!1;return{dispose:()=>{g||(g=!0,l.removeEventListener(a,u,_))}}}},6465:function(v,s,l){var a=this&&this.__decorate||function(n,f,h,c){var p,b=arguments.length,E=b<3?f:c===null?c=Object.getOwnPropertyDescriptor(f,h):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(n,f,h,c);else for(var x=n.length-1;x>=0;x--)(p=n[x])&&(E=(b<3?p(E):b>3?p(f,h,E):p(f,h))||E);return b>3&&E&&Object.defineProperty(f,h,E),E},u=this&&this.__param||function(n,f){return function(h,c){f(h,c,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Linkifier2=void 0;const _=l(3656),g=l(8460),S=l(844),y=l(2585);let w=s.Linkifier2=class extends S.Disposable{get currentLink(){return this._currentLink}constructor(n){super(),this._bufferService=n,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new g.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new g.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,S.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,S.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(n){return this._linkProviders.push(n),{dispose:()=>{const f=this._linkProviders.indexOf(n);f!==-1&&this._linkProviders.splice(f,1)}}}attachToDom(n,f,h){this._element=n,this._mouseService=f,this._renderService=h,this.register((0,_.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,_.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,_.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,_.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(n){if(this._lastMouseEvent=n,!this._element||!this._mouseService)return;const f=this._positionFromMouseEvent(n,this._element,this._mouseService);if(!f)return;this._isMouseOut=!1;const h=n.composedPath();for(let c=0;c<h.length;c++){const p=h[c];if(p.classList.contains("xterm"))break;if(p.classList.contains("xterm-hover"))return}this._lastBufferCell&&f.x===this._lastBufferCell.x&&f.y===this._lastBufferCell.y||(this._handleHover(f),this._lastBufferCell=f)}_handleHover(n){if(this._activeLine!==n.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(n,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,n)||(this._clearCurrentLink(),this._askForLink(n,!0))}_askForLink(n,f){var h,c;this._activeProviderReplies&&f||((h=this._activeProviderReplies)===null||h===void 0||h.forEach(b=>{b==null||b.forEach(E=>{E.link.dispose&&E.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=n.y);let p=!1;for(const[b,E]of this._linkProviders.entries())f?!((c=this._activeProviderReplies)===null||c===void 0)&&c.get(b)&&(p=this._checkLinkProviderResult(b,n,p)):E.provideLinks(n.y,x=>{var m,C;if(this._isMouseOut)return;const A=x==null?void 0:x.map(T=>({link:T}));(m=this._activeProviderReplies)===null||m===void 0||m.set(b,A),p=this._checkLinkProviderResult(b,n,p),((C=this._activeProviderReplies)===null||C===void 0?void 0:C.size)===this._linkProviders.length&&this._removeIntersectingLinks(n.y,this._activeProviderReplies)})}_removeIntersectingLinks(n,f){const h=new Set;for(let c=0;c<f.size;c++){const p=f.get(c);if(p)for(let b=0;b<p.length;b++){const E=p[b],x=E.link.range.start.y<n?0:E.link.range.start.x,m=E.link.range.end.y>n?this._bufferService.cols:E.link.range.end.x;for(let C=x;C<=m;C++){if(h.has(C)){p.splice(b--,1);break}h.add(C)}}}}_checkLinkProviderResult(n,f,h){var c;if(!this._activeProviderReplies)return h;const p=this._activeProviderReplies.get(n);let b=!1;for(let E=0;E<n;E++)this._activeProviderReplies.has(E)&&!this._activeProviderReplies.get(E)||(b=!0);if(!b&&p){const E=p.find(x=>this._linkAtPosition(x.link,f));E&&(h=!0,this._handleNewLink(E))}if(this._activeProviderReplies.size===this._linkProviders.length&&!h)for(let E=0;E<this._activeProviderReplies.size;E++){const x=(c=this._activeProviderReplies.get(E))===null||c===void 0?void 0:c.find(m=>this._linkAtPosition(m.link,f));if(x){h=!0,this._handleNewLink(x);break}}return h}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(n){if(!this._element||!this._mouseService||!this._currentLink)return;const f=this._positionFromMouseEvent(n,this._element,this._mouseService);f&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,f)&&this._currentLink.link.activate(n,this._currentLink.link.text)}_clearCurrentLink(n,f){this._element&&this._currentLink&&this._lastMouseEvent&&(!n||!f||this._currentLink.link.range.start.y>=n&&this._currentLink.link.range.end.y<=f)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,S.disposeArray)(this._linkCacheDisposables))}_handleNewLink(n){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const f=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);f&&this._linkAtPosition(n.link,f)&&(this._currentLink=n,this._currentLink.state={decorations:{underline:n.link.decorations===void 0||n.link.decorations.underline,pointerCursor:n.link.decorations===void 0||n.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,n.link,this._lastMouseEvent),n.link.decorations={},Object.defineProperties(n.link.decorations,{pointerCursor:{get:()=>{var h,c;return(c=(h=this._currentLink)===null||h===void 0?void 0:h.state)===null||c===void 0?void 0:c.decorations.pointerCursor},set:h=>{var c,p;!((c=this._currentLink)===null||c===void 0)&&c.state&&this._currentLink.state.decorations.pointerCursor!==h&&(this._currentLink.state.decorations.pointerCursor=h,this._currentLink.state.isHovered&&((p=this._element)===null||p===void 0||p.classList.toggle("xterm-cursor-pointer",h)))}},underline:{get:()=>{var h,c;return(c=(h=this._currentLink)===null||h===void 0?void 0:h.state)===null||c===void 0?void 0:c.decorations.underline},set:h=>{var c,p,b;!((c=this._currentLink)===null||c===void 0)&&c.state&&((b=(p=this._currentLink)===null||p===void 0?void 0:p.state)===null||b===void 0?void 0:b.decorations.underline)!==h&&(this._currentLink.state.decorations.underline=h,this._currentLink.state.isHovered&&this._fireUnderlineEvent(n.link,h))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(h=>{if(!this._currentLink)return;const c=h.start===0?0:h.start+1+this._bufferService.buffer.ydisp,p=this._bufferService.buffer.ydisp+1+h.end;if(this._currentLink.link.range.start.y>=c&&this._currentLink.link.range.end.y<=p&&(this._clearCurrentLink(c,p),this._lastMouseEvent&&this._element)){const b=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);b&&this._askForLink(b,!1)}})))}_linkHover(n,f,h){var c;!((c=this._currentLink)===null||c===void 0)&&c.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(f,!0),this._currentLink.state.decorations.pointerCursor&&n.classList.add("xterm-cursor-pointer")),f.hover&&f.hover(h,f.text)}_fireUnderlineEvent(n,f){const h=n.range,c=this._bufferService.buffer.ydisp,p=this._createLinkUnderlineEvent(h.start.x-1,h.start.y-c-1,h.end.x,h.end.y-c-1,void 0);(f?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(p)}_linkLeave(n,f,h){var c;!((c=this._currentLink)===null||c===void 0)&&c.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(f,!1),this._currentLink.state.decorations.pointerCursor&&n.classList.remove("xterm-cursor-pointer")),f.leave&&f.leave(h,f.text)}_linkAtPosition(n,f){const h=n.range.start.y*this._bufferService.cols+n.range.start.x,c=n.range.end.y*this._bufferService.cols+n.range.end.x,p=f.y*this._bufferService.cols+f.x;return h<=p&&p<=c}_positionFromMouseEvent(n,f,h){const c=h.getCoords(n,f,this._bufferService.cols,this._bufferService.rows);if(c)return{x:c[0],y:c[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(n,f,h,c,p){return{x1:n,y1:f,x2:h,y2:c,cols:this._bufferService.cols,fg:p}}};s.Linkifier2=w=a([u(0,y.IBufferService)],w)},9042:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.tooMuchOutput=s.promptLabel=void 0,s.promptLabel="Terminal input",s.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(v,s,l){var a=this&&this.__decorate||function(w,n,f,h){var c,p=arguments.length,b=p<3?n:h===null?h=Object.getOwnPropertyDescriptor(n,f):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(w,n,f,h);else for(var E=w.length-1;E>=0;E--)(c=w[E])&&(b=(p<3?c(b):p>3?c(n,f,b):c(n,f))||b);return p>3&&b&&Object.defineProperty(n,f,b),b},u=this&&this.__param||function(w,n){return function(f,h){n(f,h,w)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkProvider=void 0;const _=l(511),g=l(2585);let S=s.OscLinkProvider=class{constructor(w,n,f){this._bufferService=w,this._optionsService=n,this._oscLinkService=f}provideLinks(w,n){var f;const h=this._bufferService.buffer.lines.get(w-1);if(!h)return void n(void 0);const c=[],p=this._optionsService.rawOptions.linkHandler,b=new _.CellData,E=h.getTrimmedLength();let x=-1,m=-1,C=!1;for(let A=0;A<E;A++)if(m!==-1||h.hasContent(A)){if(h.loadCell(A,b),b.hasExtendedAttrs()&&b.extended.urlId){if(m===-1){m=A,x=b.extended.urlId;continue}C=b.extended.urlId!==x}else m!==-1&&(C=!0);if(C||m!==-1&&A===E-1){const T=(f=this._oscLinkService.getLinkData(x))===null||f===void 0?void 0:f.uri;if(T){const D={start:{x:m+1,y:w},end:{x:A+(C||A!==E-1?0:1),y:w}};let O=!1;if(!(p!=null&&p.allowNonHttpProtocols))try{const U=new URL(T);["http:","https:"].includes(U.protocol)||(O=!0)}catch{O=!0}O||c.push({text:T,range:D,activate:(U,j)=>p?p.activate(U,j,D):y(0,j),hover:(U,j)=>{var Z;return(Z=p==null?void 0:p.hover)===null||Z===void 0?void 0:Z.call(p,U,j,D)},leave:(U,j)=>{var Z;return(Z=p==null?void 0:p.leave)===null||Z===void 0?void 0:Z.call(p,U,j,D)}})}C=!1,b.hasExtendedAttrs()&&b.extended.urlId?(m=A,x=b.extended.urlId):(m=-1,x=-1)}}n(c)}};function y(w,n){if(confirm(`Do you want to navigate to ${n}?

WARNING: This link could potentially be dangerous`)){const f=window.open();if(f){try{f.opener=null}catch{}f.location.href=n}else console.warn("Opening link blocked as opener could not be cleared")}}s.OscLinkProvider=S=a([u(0,g.IBufferService),u(1,g.IOptionsService),u(2,g.IOscLinkService)],S)},6193:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.RenderDebouncer=void 0,s.RenderDebouncer=class{constructor(l,a){this._parentWindow=l,this._renderCallback=a,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(l){return this._refreshCallbacks.push(l),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(l,a,u){this._rowCount=u,l=l!==void 0?l:0,a=a!==void 0?a:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,a):a,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const l=Math.max(this._rowStart,0),a=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,a),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const l of this._refreshCallbacks)l(0);this._refreshCallbacks=[]}}},5596:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ScreenDprMonitor=void 0;const a=l(844);class u extends a.Disposable{constructor(g){super(),this._parentWindow=g,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,a.toDisposable)(()=>{this.clearListener()}))}setListener(g){this._listener&&this.clearListener(),this._listener=g,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var g;this._outerListener&&((g=this._resolutionMediaMatchList)===null||g===void 0||g.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}s.ScreenDprMonitor=u},3236:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Terminal=void 0;const a=l(3614),u=l(3656),_=l(6465),g=l(9042),S=l(3730),y=l(1680),w=l(3107),n=l(5744),f=l(2950),h=l(1296),c=l(428),p=l(4269),b=l(5114),E=l(8934),x=l(3230),m=l(9312),C=l(4725),A=l(6731),T=l(8055),D=l(8969),O=l(8460),U=l(844),j=l(6114),Z=l(8437),N=l(2584),k=l(7399),I=l(5941),M=l(9074),B=l(2585),V=l(5435),Q=l(4567),ne=typeof window<"u"?window.document:null;class te extends D.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(R={}){super(R),this.browser=j,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new U.MutableDisposable),this._onCursorMove=this.register(new O.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new O.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new O.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new O.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new O.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new O.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new O.EventEmitter),this._onBlur=this.register(new O.EventEmitter),this._onA11yCharEmitter=this.register(new O.EventEmitter),this._onA11yTabEmitter=this.register(new O.EventEmitter),this._onWillOpen=this.register(new O.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(_.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(S.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(M.DecorationService),this._instantiationService.setService(B.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((H,z)=>this.refresh(H,z))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(H=>this._reportWindowsOptions(H))),this.register(this._inputHandler.onColor(H=>this._handleColorEvent(H))),this.register((0,O.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,O.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,O.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,O.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(H=>this._afterResize(H.cols,H.rows))),this.register((0,U.toDisposable)(()=>{var H,z;this._customKeyEventHandler=void 0,(z=(H=this.element)===null||H===void 0?void 0:H.parentNode)===null||z===void 0||z.removeChild(this.element)}))}_handleColorEvent(R){if(this._themeService)for(const H of R){let z,$="";switch(H.index){case 256:z="foreground",$="10";break;case 257:z="background",$="11";break;case 258:z="cursor",$="12";break;default:z="ansi",$="4;"+H.index}switch(H.type){case 0:const oe=T.color.toColorRGB(z==="ansi"?this._themeService.colors.ansi[H.index]:this._themeService.colors[z]);this.coreService.triggerDataEvent(`${N.C0.ESC}]${$};${(0,I.toRgbString)(oe)}${N.C1_ESCAPED.ST}`);break;case 1:if(z==="ansi")this._themeService.modifyColors(L=>L.ansi[H.index]=T.rgba.toColor(...H.color));else{const L=z;this._themeService.modifyColors(P=>P[L]=T.rgba.toColor(...H.color))}break;case 2:this._themeService.restoreColor(H.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(R){R?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Q.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(R){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(N.C0.ESC+"[I"),this.updateCursorStyle(R),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var R;return(R=this.textarea)===null||R===void 0?void 0:R.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(N.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const R=this.buffer.ybase+this.buffer.y,H=this.buffer.lines.get(R);if(!H)return;const z=Math.min(this.buffer.x,this.cols-1),$=this._renderService.dimensions.css.cell.height,oe=H.getWidth(z),L=this._renderService.dimensions.css.cell.width*oe,P=this.buffer.y*this._renderService.dimensions.css.cell.height,F=z*this._renderService.dimensions.css.cell.width;this.textarea.style.left=F+"px",this.textarea.style.top=P+"px",this.textarea.style.width=L+"px",this.textarea.style.height=$+"px",this.textarea.style.lineHeight=$+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,u.addDisposableDomListener)(this.element,"copy",H=>{this.hasSelection()&&(0,a.copyHandler)(H,this._selectionService)}));const R=H=>(0,a.handlePasteEvent)(H,this.textarea,this.coreService,this.optionsService);this.register((0,u.addDisposableDomListener)(this.textarea,"paste",R)),this.register((0,u.addDisposableDomListener)(this.element,"paste",R)),j.isFirefox?this.register((0,u.addDisposableDomListener)(this.element,"mousedown",H=>{H.button===2&&(0,a.rightClickHandler)(H,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,u.addDisposableDomListener)(this.element,"contextmenu",H=>{(0,a.rightClickHandler)(H,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),j.isLinux&&this.register((0,u.addDisposableDomListener)(this.element,"auxclick",H=>{H.button===1&&(0,a.moveTextAreaUnderMouseCursor)(H,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,u.addDisposableDomListener)(this.textarea,"keyup",R=>this._keyUp(R),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"keydown",R=>this._keyDown(R),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"keypress",R=>this._keyPress(R),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionupdate",R=>this._compositionHelper.compositionupdate(R))),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,u.addDisposableDomListener)(this.textarea,"input",R=>this._inputEvent(R),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(R){var H;if(!R)throw new Error("Terminal requires a parent element.");R.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=R.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),R.appendChild(this.element);const z=ne.createDocumentFragment();this._viewportElement=ne.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),z.appendChild(this._viewportElement),this._viewportScrollArea=ne.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=ne.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=ne.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),z.appendChild(this.screenElement),this.textarea=ne.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",g.promptLabel),j.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(b.CoreBrowserService,this.textarea,(H=this._document.defaultView)!==null&&H!==void 0?H:window),this._instantiationService.setService(C.ICoreBrowserService,this._coreBrowserService),this.register((0,u.addDisposableDomListener)(this.textarea,"focus",$=>this._handleTextAreaFocus($))),this.register((0,u.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(c.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(C.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(A.ThemeService),this._instantiationService.setService(C.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(p.CharacterJoinerService),this._instantiationService.setService(C.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(x.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(C.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange($=>this._onRender.fire($))),this.onResize($=>this._renderService.resize($.cols,$.rows)),this._compositionView=ne.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(f.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(z);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(C.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(y.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines($=>this.scrollLines($.amount,$.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(m.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(C.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines($=>this.scrollLines($.amount,$.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw($=>this._renderService.handleSelectionChanged($.start,$.end,$.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection($=>{this.textarea.value=$,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event($=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,u.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(w.BufferDecorationRenderer,this.screenElement)),this.register((0,u.addDisposableDomListener)(this.element,"mousedown",$=>this._selectionService.handleMouseDown($))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Q.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",$=>this._handleScreenReaderModeOptionChange($))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",$=>{!this._overviewRulerRenderer&&$&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(n.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(h.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const R=this,H=this.element;function z(L){const P=R._mouseService.getMouseReportCoords(L,R.screenElement);if(!P)return!1;let F,K;switch(L.overrideType||L.type){case"mousemove":K=32,L.buttons===void 0?(F=3,L.button!==void 0&&(F=L.button<3?L.button:3)):F=1&L.buttons?0:4&L.buttons?1:2&L.buttons?2:3;break;case"mouseup":K=0,F=L.button<3?L.button:3;break;case"mousedown":K=1,F=L.button<3?L.button:3;break;case"wheel":if(R.viewport.getLinesScrolled(L)===0)return!1;K=L.deltaY<0?0:1,F=4;break;default:return!1}return!(K===void 0||F===void 0||F>4)&&R.coreMouseService.triggerMouseEvent({col:P.col,row:P.row,x:P.x,y:P.y,button:F,action:K,ctrl:L.ctrlKey,alt:L.altKey,shift:L.shiftKey})}const $={mouseup:null,wheel:null,mousedrag:null,mousemove:null},oe={mouseup:L=>(z(L),L.buttons||(this._document.removeEventListener("mouseup",$.mouseup),$.mousedrag&&this._document.removeEventListener("mousemove",$.mousedrag)),this.cancel(L)),wheel:L=>(z(L),this.cancel(L,!0)),mousedrag:L=>{L.buttons&&z(L)},mousemove:L=>{L.buttons||z(L)}};this.register(this.coreMouseService.onProtocolChange(L=>{L?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(L)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&L?$.mousemove||(H.addEventListener("mousemove",oe.mousemove),$.mousemove=oe.mousemove):(H.removeEventListener("mousemove",$.mousemove),$.mousemove=null),16&L?$.wheel||(H.addEventListener("wheel",oe.wheel,{passive:!1}),$.wheel=oe.wheel):(H.removeEventListener("wheel",$.wheel),$.wheel=null),2&L?$.mouseup||(H.addEventListener("mouseup",oe.mouseup),$.mouseup=oe.mouseup):(this._document.removeEventListener("mouseup",$.mouseup),H.removeEventListener("mouseup",$.mouseup),$.mouseup=null),4&L?$.mousedrag||($.mousedrag=oe.mousedrag):(this._document.removeEventListener("mousemove",$.mousedrag),$.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,u.addDisposableDomListener)(H,"mousedown",L=>{if(L.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(L))return z(L),$.mouseup&&this._document.addEventListener("mouseup",$.mouseup),$.mousedrag&&this._document.addEventListener("mousemove",$.mousedrag),this.cancel(L)})),this.register((0,u.addDisposableDomListener)(H,"wheel",L=>{if(!$.wheel){if(!this.buffer.hasScrollback){const P=this.viewport.getLinesScrolled(L);if(P===0)return;const F=N.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(L.deltaY<0?"A":"B");let K="";for(let q=0;q<Math.abs(P);q++)K+=F;return this.coreService.triggerDataEvent(K,!0),this.cancel(L,!0)}return this.viewport.handleWheel(L)?this.cancel(L):void 0}},{passive:!1})),this.register((0,u.addDisposableDomListener)(H,"touchstart",L=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(L),this.cancel(L)},{passive:!0})),this.register((0,u.addDisposableDomListener)(H,"touchmove",L=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(L)?void 0:this.cancel(L)},{passive:!1}))}refresh(R,H){var z;(z=this._renderService)===null||z===void 0||z.refreshRows(R,H)}updateCursorStyle(R){var H;!((H=this._selectionService)===null||H===void 0)&&H.shouldColumnSelect(R)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(R,H,z=0){var $;z===1?(super.scrollLines(R,H,z),this.refresh(0,this.rows-1)):($=this.viewport)===null||$===void 0||$.scrollLines(R)}paste(R){(0,a.paste)(R,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(R){this._customKeyEventHandler=R}registerLinkProvider(R){return this.linkifier2.registerLinkProvider(R)}registerCharacterJoiner(R){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const H=this._characterJoinerService.register(R);return this.refresh(0,this.rows-1),H}deregisterCharacterJoiner(R){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(R)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(R){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+R)}registerDecoration(R){return this._decorationService.registerDecoration(R)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(R,H,z){this._selectionService.setSelection(R,H,z)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var R;(R=this._selectionService)===null||R===void 0||R.clearSelection()}selectAll(){var R;(R=this._selectionService)===null||R===void 0||R.selectAll()}selectLines(R,H){var z;(z=this._selectionService)===null||z===void 0||z.selectLines(R,H)}_keyDown(R){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1)return!1;const H=this.browser.isMac&&this.options.macOptionIsMeta&&R.altKey;if(!H&&!this._compositionHelper.keydown(R))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;H||R.key!=="Dead"&&R.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const z=(0,k.evaluateKeyboardEvent)(R,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(R),z.type===3||z.type===2){const $=this.rows-1;return this.scrollLines(z.type===2?-$:$),this.cancel(R,!0)}return z.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,R)||(z.cancel&&this.cancel(R,!0),!z.key||!!(R.key&&!R.ctrlKey&&!R.altKey&&!R.metaKey&&R.key.length===1&&R.key.charCodeAt(0)>=65&&R.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(z.key!==N.C0.ETX&&z.key!==N.C0.CR||(this.textarea.value=""),this._onKey.fire({key:z.key,domEvent:R}),this._showCursor(),this.coreService.triggerDataEvent(z.key,!0),!this.optionsService.rawOptions.screenReaderMode||R.altKey||R.ctrlKey?this.cancel(R,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(R,H){const z=R.isMac&&!this.options.macOptionIsMeta&&H.altKey&&!H.ctrlKey&&!H.metaKey||R.isWindows&&H.altKey&&H.ctrlKey&&!H.metaKey||R.isWindows&&H.getModifierState("AltGraph");return H.type==="keypress"?z:z&&(!H.keyCode||H.keyCode>47)}_keyUp(R){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1||(function(H){return H.keyCode===16||H.keyCode===17||H.keyCode===18}(R)||this.focus(),this.updateCursorStyle(R),this._keyPressHandled=!1)}_keyPress(R){let H;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(R)===!1)return!1;if(this.cancel(R),R.charCode)H=R.charCode;else if(R.which===null||R.which===void 0)H=R.keyCode;else{if(R.which===0||R.charCode===0)return!1;H=R.which}return!(!H||(R.altKey||R.ctrlKey||R.metaKey)&&!this._isThirdLevelShift(this.browser,R)||(H=String.fromCharCode(H),this._onKey.fire({key:H,domEvent:R}),this._showCursor(),this.coreService.triggerDataEvent(H,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(R){if(R.data&&R.inputType==="insertText"&&(!R.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const H=R.data;return this.coreService.triggerDataEvent(H,!0),this.cancel(R),!0}return!1}resize(R,H){R!==this.cols||H!==this.rows?super.resize(R,H):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(R,H){var z,$;(z=this._charSizeService)===null||z===void 0||z.measure(),($=this.viewport)===null||$===void 0||$.syncScrollArea(!0)}clear(){var R;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let H=1;H<this.rows;H++)this.buffer.lines.push(this.buffer.getBlankLine(Z.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(R=this.viewport)===null||R===void 0||R.reset(),this.refresh(0,this.rows-1)}}reset(){var R,H;this.options.rows=this.rows,this.options.cols=this.cols;const z=this._customKeyEventHandler;this._setup(),super.reset(),(R=this._selectionService)===null||R===void 0||R.reset(),this._decorationService.reset(),(H=this.viewport)===null||H===void 0||H.reset(),this._customKeyEventHandler=z,this.refresh(0,this.rows-1)}clearTextureAtlas(){var R;(R=this._renderService)===null||R===void 0||R.clearTextureAtlas()}_reportFocus(){var R;!((R=this.element)===null||R===void 0)&&R.classList.contains("focus")?this.coreService.triggerDataEvent(N.C0.ESC+"[I"):this.coreService.triggerDataEvent(N.C0.ESC+"[O")}_reportWindowsOptions(R){if(this._renderService)switch(R){case V.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const H=this._renderService.dimensions.css.canvas.width.toFixed(0),z=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${N.C0.ESC}[4;${z};${H}t`);break;case V.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const $=this._renderService.dimensions.css.cell.width.toFixed(0),oe=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${N.C0.ESC}[6;${oe};${$}t`)}}cancel(R,H){if(this.options.cancelEvents||H)return R.preventDefault(),R.stopPropagation(),!1}}s.Terminal=te},9924:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TimeBasedDebouncer=void 0,s.TimeBasedDebouncer=class{constructor(l,a=1e3){this._renderCallback=l,this._debounceThresholdMS=a,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(l,a,u){this._rowCount=u,l=l!==void 0?l:0,a=a!==void 0?a:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,a):a;const _=Date.now();if(_-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=_,this._innerRefresh();else if(!this._additionalRefreshRequested){const g=_-this._lastRefreshMs,S=this._debounceThresholdMS-g;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},S)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const l=Math.max(this._rowStart,0),a=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,a)}}},1680:function(v,s,l){var a=this&&this.__decorate||function(f,h,c,p){var b,E=arguments.length,x=E<3?h:p===null?p=Object.getOwnPropertyDescriptor(h,c):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(f,h,c,p);else for(var m=f.length-1;m>=0;m--)(b=f[m])&&(x=(E<3?b(x):E>3?b(h,c,x):b(h,c))||x);return E>3&&x&&Object.defineProperty(h,c,x),x},u=this&&this.__param||function(f,h){return function(c,p){h(c,p,f)}};Object.defineProperty(s,"__esModule",{value:!0}),s.Viewport=void 0;const _=l(3656),g=l(4725),S=l(8460),y=l(844),w=l(2585);let n=s.Viewport=class extends y.Disposable{constructor(f,h,c,p,b,E,x,m){super(),this._viewportElement=f,this._scrollArea=h,this._bufferService=c,this._optionsService=p,this._charSizeService=b,this._renderService=E,this._coreBrowserService=x,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new S.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,_.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(C=>this._activeBuffer=C.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(C=>this._renderDimensions=C)),this._handleThemeChange(m.colors),this.register(m.onChangeColors(C=>this._handleThemeChange(C))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(f){this._viewportElement.style.backgroundColor=f.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(f){if(f)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const h=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==h&&(this._lastRecordedBufferHeight=h,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const f=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==f&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=f),this._refreshAnimationFrame=null}syncScrollArea(f=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(f);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(f)}_handleScroll(f){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const h=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:h,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const f=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(f*(this._smoothScrollState.target-this._smoothScrollState.origin)),f<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(f,h){const c=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(h<0&&this._viewportElement.scrollTop!==0||h>0&&c<this._lastRecordedBufferHeight)||(f.cancelable&&f.preventDefault(),!1)}handleWheel(f){const h=this._getPixelsScrolled(f);return h!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+h:this._smoothScrollState.target+=h,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=h,this._bubbleScroll(f,h))}scrollLines(f){if(f!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const h=f*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+h,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:f,suppressScrollEvent:!1})}_getPixelsScrolled(f){if(f.deltaY===0||f.shiftKey)return 0;let h=this._applyScrollModifier(f.deltaY,f);return f.deltaMode===WheelEvent.DOM_DELTA_LINE?h*=this._currentRowHeight:f.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._currentRowHeight*this._bufferService.rows),h}getBufferElements(f,h){var c;let p,b="";const E=[],x=h??this._bufferService.buffer.lines.length,m=this._bufferService.buffer.lines;for(let C=f;C<x;C++){const A=m.get(C);if(!A)continue;const T=(c=m.get(C+1))===null||c===void 0?void 0:c.isWrapped;if(b+=A.translateToString(!T),!T||C===m.length-1){const D=document.createElement("div");D.textContent=b,E.push(D),b.length>0&&(p=D),b=""}}return{bufferElements:E,cursorElement:p}}getLinesScrolled(f){if(f.deltaY===0||f.shiftKey)return 0;let h=this._applyScrollModifier(f.deltaY,f);return f.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(h/=this._currentRowHeight+0,this._wheelPartialScroll+=h,h=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):f.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._bufferService.rows),h}_applyScrollModifier(f,h){const c=this._optionsService.rawOptions.fastScrollModifier;return c==="alt"&&h.altKey||c==="ctrl"&&h.ctrlKey||c==="shift"&&h.shiftKey?f*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:f*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(f){this._lastTouchY=f.touches[0].pageY}handleTouchMove(f){const h=this._lastTouchY-f.touches[0].pageY;return this._lastTouchY=f.touches[0].pageY,h!==0&&(this._viewportElement.scrollTop+=h,this._bubbleScroll(f,h))}};s.Viewport=n=a([u(2,w.IBufferService),u(3,w.IOptionsService),u(4,g.ICharSizeService),u(5,g.IRenderService),u(6,g.ICoreBrowserService),u(7,g.IThemeService)],n)},3107:function(v,s,l){var a=this&&this.__decorate||function(n,f,h,c){var p,b=arguments.length,E=b<3?f:c===null?c=Object.getOwnPropertyDescriptor(f,h):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(n,f,h,c);else for(var x=n.length-1;x>=0;x--)(p=n[x])&&(E=(b<3?p(E):b>3?p(f,h,E):p(f,h))||E);return b>3&&E&&Object.defineProperty(f,h,E),E},u=this&&this.__param||function(n,f){return function(h,c){f(h,c,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferDecorationRenderer=void 0;const _=l(3656),g=l(4725),S=l(844),y=l(2585);let w=s.BufferDecorationRenderer=class extends S.Disposable{constructor(n,f,h,c){super(),this._screenElement=n,this._bufferService=f,this._decorationService=h,this._renderService=c,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,_.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(p=>this._removeDecoration(p))),this.register((0,S.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const n of this._decorationService.decorations)this._renderDecoration(n);this._dimensionsChanged=!1}_renderDecoration(n){this._refreshStyle(n),this._dimensionsChanged&&this._refreshXPosition(n)}_createElement(n){var f,h;const c=document.createElement("div");c.classList.add("xterm-decoration"),c.classList.toggle("xterm-decoration-top-layer",((f=n==null?void 0:n.options)===null||f===void 0?void 0:f.layer)==="top"),c.style.width=`${Math.round((n.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,c.style.height=(n.options.height||1)*this._renderService.dimensions.css.cell.height+"px",c.style.top=(n.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",c.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const p=(h=n.options.x)!==null&&h!==void 0?h:0;return p&&p>this._bufferService.cols&&(c.style.display="none"),this._refreshXPosition(n,c),c}_refreshStyle(n){const f=n.marker.line-this._bufferService.buffers.active.ydisp;if(f<0||f>=this._bufferService.rows)n.element&&(n.element.style.display="none",n.onRenderEmitter.fire(n.element));else{let h=this._decorationElements.get(n);h||(h=this._createElement(n),n.element=h,this._decorationElements.set(n,h),this._container.appendChild(h),n.onDispose(()=>{this._decorationElements.delete(n),h.remove()})),h.style.top=f*this._renderService.dimensions.css.cell.height+"px",h.style.display=this._altBufferIsActive?"none":"block",n.onRenderEmitter.fire(h)}}_refreshXPosition(n,f=n.element){var h;if(!f)return;const c=(h=n.options.x)!==null&&h!==void 0?h:0;(n.options.anchor||"left")==="right"?f.style.right=c?c*this._renderService.dimensions.css.cell.width+"px":"":f.style.left=c?c*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(n){var f;(f=this._decorationElements.get(n))===null||f===void 0||f.remove(),this._decorationElements.delete(n),n.dispose()}};s.BufferDecorationRenderer=w=a([u(1,y.IBufferService),u(2,y.IDecorationService),u(3,g.IRenderService)],w)},5871:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ColorZoneStore=void 0,s.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(l){if(l.options.overviewRulerOptions){for(const a of this._zones)if(a.color===l.options.overviewRulerOptions.color&&a.position===l.options.overviewRulerOptions.position){if(this._lineIntersectsZone(a,l.marker.line))return;if(this._lineAdjacentToZone(a,l.marker.line,l.options.overviewRulerOptions.position))return void this._addLineToZone(a,l.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=l.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=l.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=l.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=l.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:l.options.overviewRulerOptions.color,position:l.options.overviewRulerOptions.position,startBufferLine:l.marker.line,endBufferLine:l.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(l){this._linePadding=l}_lineIntersectsZone(l,a){return a>=l.startBufferLine&&a<=l.endBufferLine}_lineAdjacentToZone(l,a,u){return a>=l.startBufferLine-this._linePadding[u||"full"]&&a<=l.endBufferLine+this._linePadding[u||"full"]}_addLineToZone(l,a){l.startBufferLine=Math.min(l.startBufferLine,a),l.endBufferLine=Math.max(l.endBufferLine,a)}}},5744:function(v,s,l){var a=this&&this.__decorate||function(p,b,E,x){var m,C=arguments.length,A=C<3?b:x===null?x=Object.getOwnPropertyDescriptor(b,E):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(p,b,E,x);else for(var T=p.length-1;T>=0;T--)(m=p[T])&&(A=(C<3?m(A):C>3?m(b,E,A):m(b,E))||A);return C>3&&A&&Object.defineProperty(b,E,A),A},u=this&&this.__param||function(p,b){return function(E,x){b(E,x,p)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OverviewRulerRenderer=void 0;const _=l(5871),g=l(3656),S=l(4725),y=l(844),w=l(2585),n={full:0,left:0,center:0,right:0},f={full:0,left:0,center:0,right:0},h={full:0,left:0,center:0,right:0};let c=s.OverviewRulerRenderer=class extends y.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(p,b,E,x,m,C,A){var T;super(),this._viewportElement=p,this._screenElement=b,this._bufferService=E,this._decorationService=x,this._renderService=m,this._optionsService=C,this._coreBrowseService=A,this._colorZoneStore=new _.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(T=this._viewportElement.parentElement)===null||T===void 0||T.insertBefore(this._canvas,this._viewportElement);const D=this._canvas.getContext("2d");if(!D)throw new Error("Ctx cannot be null");this._ctx=D,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,y.toDisposable)(()=>{var O;(O=this._canvas)===null||O===void 0||O.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,g.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const p=Math.floor(this._canvas.width/3),b=Math.ceil(this._canvas.width/3);f.full=this._canvas.width,f.left=p,f.center=b,f.right=p,this._refreshDrawHeightConstants(),h.full=0,h.left=0,h.center=f.left,h.right=f.left+f.center}_refreshDrawHeightConstants(){n.full=Math.round(2*this._coreBrowseService.dpr);const p=this._canvas.height/this._bufferService.buffer.lines.length,b=Math.round(Math.max(Math.min(p,12),6)*this._coreBrowseService.dpr);n.left=b,n.center=b,n.right=b}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*n.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*n.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*n.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*n.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const b of this._decorationService.decorations)this._colorZoneStore.addDecoration(b);this._ctx.lineWidth=1;const p=this._colorZoneStore.zones;for(const b of p)b.position!=="full"&&this._renderColorZone(b);for(const b of p)b.position==="full"&&this._renderColorZone(b);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(p){this._ctx.fillStyle=p.color,this._ctx.fillRect(h[p.position||"full"],Math.round((this._canvas.height-1)*(p.startBufferLine/this._bufferService.buffers.active.lines.length)-n[p.position||"full"]/2),f[p.position||"full"],Math.round((this._canvas.height-1)*((p.endBufferLine-p.startBufferLine)/this._bufferService.buffers.active.lines.length)+n[p.position||"full"]))}_queueRefresh(p,b){this._shouldUpdateDimensions=p||this._shouldUpdateDimensions,this._shouldUpdateAnchor=b||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};s.OverviewRulerRenderer=c=a([u(2,w.IBufferService),u(3,w.IDecorationService),u(4,S.IRenderService),u(5,w.IOptionsService),u(6,S.ICoreBrowserService)],c)},2950:function(v,s,l){var a=this&&this.__decorate||function(w,n,f,h){var c,p=arguments.length,b=p<3?n:h===null?h=Object.getOwnPropertyDescriptor(n,f):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(w,n,f,h);else for(var E=w.length-1;E>=0;E--)(c=w[E])&&(b=(p<3?c(b):p>3?c(n,f,b):c(n,f))||b);return p>3&&b&&Object.defineProperty(n,f,b),b},u=this&&this.__param||function(w,n){return function(f,h){n(f,h,w)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CompositionHelper=void 0;const _=l(4725),g=l(2585),S=l(2584);let y=s.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(w,n,f,h,c,p){this._textarea=w,this._compositionView=n,this._bufferService=f,this._optionsService=h,this._coreService=c,this._renderService=p,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(w){this._compositionView.textContent=w.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(w){if(this._isComposing||this._isSendingComposition){if(w.keyCode===229||w.keyCode===16||w.keyCode===17||w.keyCode===18)return!1;this._finalizeComposition(!1)}return w.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(w){if(this._compositionView.classList.remove("active"),this._isComposing=!1,w){const n={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let f;this._isSendingComposition=!1,n.start+=this._dataAlreadySent.length,f=this._isComposing?this._textarea.value.substring(n.start,n.end):this._textarea.value.substring(n.start),f.length>0&&this._coreService.triggerDataEvent(f,!0)}},0)}else{this._isSendingComposition=!1;const n=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(n,!0)}}_handleAnyTextareaChanges(){const w=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const n=this._textarea.value,f=n.replace(w,"");this._dataAlreadySent=f,n.length>w.length?this._coreService.triggerDataEvent(f,!0):n.length<w.length?this._coreService.triggerDataEvent(`${S.C0.DEL}`,!0):n.length===w.length&&n!==w&&this._coreService.triggerDataEvent(n,!0)}},0)}updateCompositionElements(w){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const n=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),f=this._renderService.dimensions.css.cell.height,h=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,c=n*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=c+"px",this._compositionView.style.top=h+"px",this._compositionView.style.height=f+"px",this._compositionView.style.lineHeight=f+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const p=this._compositionView.getBoundingClientRect();this._textarea.style.left=c+"px",this._textarea.style.top=h+"px",this._textarea.style.width=Math.max(p.width,1)+"px",this._textarea.style.height=Math.max(p.height,1)+"px",this._textarea.style.lineHeight=p.height+"px"}w||setTimeout(()=>this.updateCompositionElements(!0),0)}}};s.CompositionHelper=y=a([u(2,g.IBufferService),u(3,g.IOptionsService),u(4,g.ICoreService),u(5,_.IRenderService)],y)},9806:(v,s)=>{function l(a,u,_){const g=_.getBoundingClientRect(),S=a.getComputedStyle(_),y=parseInt(S.getPropertyValue("padding-left")),w=parseInt(S.getPropertyValue("padding-top"));return[u.clientX-g.left-y,u.clientY-g.top-w]}Object.defineProperty(s,"__esModule",{value:!0}),s.getCoords=s.getCoordsRelativeToElement=void 0,s.getCoordsRelativeToElement=l,s.getCoords=function(a,u,_,g,S,y,w,n,f){if(!y)return;const h=l(a,u,_);return h?(h[0]=Math.ceil((h[0]+(f?w/2:0))/w),h[1]=Math.ceil(h[1]/n),h[0]=Math.min(Math.max(h[0],1),g+(f?1:0)),h[1]=Math.min(Math.max(h[1],1),S),h):void 0}},9504:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.moveToCellSequence=void 0;const a=l(2584);function u(n,f,h,c){const p=n-_(n,h),b=f-_(f,h),E=Math.abs(p-b)-function(x,m,C){let A=0;const T=x-_(x,C),D=m-_(m,C);for(let O=0;O<Math.abs(T-D);O++){const U=g(x,m)==="A"?-1:1,j=C.buffer.lines.get(T+U*O);j!=null&&j.isWrapped&&A++}return A}(n,f,h);return w(E,y(g(n,f),c))}function _(n,f){let h=0,c=f.buffer.lines.get(n),p=c==null?void 0:c.isWrapped;for(;p&&n>=0&&n<f.rows;)h++,c=f.buffer.lines.get(--n),p=c==null?void 0:c.isWrapped;return h}function g(n,f){return n>f?"A":"B"}function S(n,f,h,c,p,b){let E=n,x=f,m="";for(;E!==h||x!==c;)E+=p?1:-1,p&&E>b.cols-1?(m+=b.buffer.translateBufferLineToString(x,!1,n,E),E=0,n=0,x++):!p&&E<0&&(m+=b.buffer.translateBufferLineToString(x,!1,0,n+1),E=b.cols-1,n=E,x--);return m+b.buffer.translateBufferLineToString(x,!1,n,E)}function y(n,f){const h=f?"O":"[";return a.C0.ESC+h+n}function w(n,f){n=Math.floor(n);let h="";for(let c=0;c<n;c++)h+=f;return h}s.moveToCellSequence=function(n,f,h,c){const p=h.buffer.x,b=h.buffer.y;if(!h.buffer.hasScrollback)return function(m,C,A,T,D,O){return u(C,T,D,O).length===0?"":w(S(m,C,m,C-_(C,D),!1,D).length,y("D",O))}(p,b,0,f,h,c)+u(b,f,h,c)+function(m,C,A,T,D,O){let U;U=u(C,T,D,O).length>0?T-_(T,D):C;const j=T,Z=function(N,k,I,M,B,V){let Q;return Q=u(I,M,B,V).length>0?M-_(M,B):k,N<I&&Q<=M||N>=I&&Q<M?"C":"D"}(m,C,A,T,D,O);return w(S(m,U,A,j,Z==="C",D).length,y(Z,O))}(p,b,n,f,h,c);let E;if(b===f)return E=p>n?"D":"C",w(Math.abs(p-n),y(E,c));E=b>f?"D":"C";const x=Math.abs(b-f);return w(function(m,C){return C.cols-m}(b>f?n:p,h)+(x-1)*h.cols+1+((b>f?p:n)-1),y(E,c))}},1296:function(v,s,l){var a=this&&this.__decorate||function(D,O,U,j){var Z,N=arguments.length,k=N<3?O:j===null?j=Object.getOwnPropertyDescriptor(O,U):j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(D,O,U,j);else for(var I=D.length-1;I>=0;I--)(Z=D[I])&&(k=(N<3?Z(k):N>3?Z(O,U,k):Z(O,U))||k);return N>3&&k&&Object.defineProperty(O,U,k),k},u=this&&this.__param||function(D,O){return function(U,j){O(U,j,D)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRenderer=void 0;const _=l(3787),g=l(2550),S=l(2223),y=l(6171),w=l(4725),n=l(8055),f=l(8460),h=l(844),c=l(2585),p="xterm-dom-renderer-owner-",b="xterm-rows",E="xterm-fg-",x="xterm-bg-",m="xterm-focus",C="xterm-selection";let A=1,T=s.DomRenderer=class extends h.Disposable{constructor(D,O,U,j,Z,N,k,I,M,B){super(),this._element=D,this._screenElement=O,this._viewportElement=U,this._linkifier2=j,this._charSizeService=N,this._optionsService=k,this._bufferService=I,this._coreBrowserService=M,this._themeService=B,this._terminalClass=A++,this._rowElements=[],this.onRequestRedraw=this.register(new f.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(b),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(C),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,y.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(V=>this._injectCss(V))),this._injectCss(this._themeService.colors),this._rowFactory=Z.createInstance(_.DomRendererRowFactory,document),this._element.classList.add(p+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(V=>this._handleLinkHover(V))),this.register(this._linkifier2.onHideLinkUnderline(V=>this._handleLinkLeave(V))),this.register((0,h.toDisposable)(()=>{this._element.classList.remove(p+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new g.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const D=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*D,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*D),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/D),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/D),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const U of this._rowElements)U.style.width=`${this.dimensions.css.canvas.width}px`,U.style.height=`${this.dimensions.css.cell.height}px`,U.style.lineHeight=`${this.dimensions.css.cell.height}px`,U.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const O=`${this._terminalSelector} .${b} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=O,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(D){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let O=`${this._terminalSelector} .${b} { color: ${D.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;O+=`${this._terminalSelector} .${b} .xterm-dim { color: ${n.color.multiplyOpacity(D.foreground,.5).css};}`,O+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,O+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",O+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${D.cursor.css};  color: ${D.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${D.cursor.css}; }}`,O+=`${this._terminalSelector} .${b}.${m} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${b}.${m} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-block { background-color: ${D.cursor.css}; color: ${D.cursorAccent.css};}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${D.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${D.cursor.css} inset;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${D.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,O+=`${this._terminalSelector} .${C} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${C} div { position: absolute; background-color: ${D.selectionBackgroundOpaque.css};}${this._terminalSelector} .${C} div { position: absolute; background-color: ${D.selectionInactiveBackgroundOpaque.css};}`;for(const[U,j]of D.ansi.entries())O+=`${this._terminalSelector} .${E}${U} { color: ${j.css}; }${this._terminalSelector} .${E}${U}.xterm-dim { color: ${n.color.multiplyOpacity(j,.5).css}; }${this._terminalSelector} .${x}${U} { background-color: ${j.css}; }`;O+=`${this._terminalSelector} .${E}${S.INVERTED_DEFAULT_COLOR} { color: ${n.color.opaque(D.background).css}; }${this._terminalSelector} .${E}${S.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${n.color.multiplyOpacity(n.color.opaque(D.background),.5).css}; }${this._terminalSelector} .${x}${S.INVERTED_DEFAULT_COLOR} { background-color: ${D.foreground.css}; }`,this._themeStyleElement.textContent=O}_setDefaultSpacing(){const D=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${D}px`,this._rowFactory.defaultSpacing=D}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(D,O){for(let U=this._rowElements.length;U<=O;U++){const j=document.createElement("div");this._rowContainer.appendChild(j),this._rowElements.push(j)}for(;this._rowElements.length>O;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(D,O){this._refreshRowElements(D,O),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(m)}handleFocus(){this._rowContainer.classList.add(m),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(D,O,U){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(D,O,U),this.renderRows(0,this._bufferService.rows-1),!D||!O)return;const j=D[1]-this._bufferService.buffer.ydisp,Z=O[1]-this._bufferService.buffer.ydisp,N=Math.max(j,0),k=Math.min(Z,this._bufferService.rows-1);if(N>=this._bufferService.rows||k<0)return;const I=document.createDocumentFragment();if(U){const M=D[0]>O[0];I.appendChild(this._createSelectionElement(N,M?O[0]:D[0],M?D[0]:O[0],k-N+1))}else{const M=j===N?D[0]:0,B=N===Z?O[0]:this._bufferService.cols;I.appendChild(this._createSelectionElement(N,M,B));const V=k-N-1;if(I.appendChild(this._createSelectionElement(N+1,0,this._bufferService.cols,V)),N!==k){const Q=Z===k?O[0]:this._bufferService.cols;I.appendChild(this._createSelectionElement(k,0,Q))}}this._selectionContainer.appendChild(I)}_createSelectionElement(D,O,U,j=1){const Z=document.createElement("div");return Z.style.height=j*this.dimensions.css.cell.height+"px",Z.style.top=D*this.dimensions.css.cell.height+"px",Z.style.left=O*this.dimensions.css.cell.width+"px",Z.style.width=this.dimensions.css.cell.width*(U-O)+"px",Z}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const D of this._rowElements)D.replaceChildren()}renderRows(D,O){const U=this._bufferService.buffer,j=U.ybase+U.y,Z=Math.min(U.x,this._bufferService.cols-1),N=this._optionsService.rawOptions.cursorBlink,k=this._optionsService.rawOptions.cursorStyle,I=this._optionsService.rawOptions.cursorInactiveStyle;for(let M=D;M<=O;M++){const B=M+U.ydisp,V=this._rowElements[M],Q=U.lines.get(B);if(!V||!Q)break;V.replaceChildren(...this._rowFactory.createRow(Q,B,B===j,k,I,Z,N,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${p}${this._terminalClass}`}_handleLinkHover(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!0)}_handleLinkLeave(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!1)}_setCellUnderline(D,O,U,j,Z,N){U<0&&(D=0),j<0&&(O=0);const k=this._bufferService.rows-1;U=Math.max(Math.min(U,k),0),j=Math.max(Math.min(j,k),0),Z=Math.min(Z,this._bufferService.cols);const I=this._bufferService.buffer,M=I.ybase+I.y,B=Math.min(I.x,Z-1),V=this._optionsService.rawOptions.cursorBlink,Q=this._optionsService.rawOptions.cursorStyle,ne=this._optionsService.rawOptions.cursorInactiveStyle;for(let te=U;te<=j;++te){const _e=te+I.ydisp,R=this._rowElements[te],H=I.lines.get(_e);if(!R||!H)break;R.replaceChildren(...this._rowFactory.createRow(H,_e,_e===M,Q,ne,B,V,this.dimensions.css.cell.width,this._widthCache,N?te===U?D:0:-1,N?(te===j?O:Z)-1:-1))}}};s.DomRenderer=T=a([u(4,c.IInstantiationService),u(5,w.ICharSizeService),u(6,c.IOptionsService),u(7,c.IBufferService),u(8,w.ICoreBrowserService),u(9,w.IThemeService)],T)},3787:function(v,s,l){var a=this&&this.__decorate||function(E,x,m,C){var A,T=arguments.length,D=T<3?x:C===null?C=Object.getOwnPropertyDescriptor(x,m):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(E,x,m,C);else for(var O=E.length-1;O>=0;O--)(A=E[O])&&(D=(T<3?A(D):T>3?A(x,m,D):A(x,m))||D);return T>3&&D&&Object.defineProperty(x,m,D),D},u=this&&this.__param||function(E,x){return function(m,C){x(m,C,E)}};Object.defineProperty(s,"__esModule",{value:!0}),s.DomRendererRowFactory=void 0;const _=l(2223),g=l(643),S=l(511),y=l(2585),w=l(8055),n=l(4725),f=l(4269),h=l(6171),c=l(3734);let p=s.DomRendererRowFactory=class{constructor(E,x,m,C,A,T,D){this._document=E,this._characterJoinerService=x,this._optionsService=m,this._coreBrowserService=C,this._coreService=A,this._decorationService=T,this._themeService=D,this._workCell=new S.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(E,x,m){this._selectionStart=E,this._selectionEnd=x,this._columnSelectMode=m}createRow(E,x,m,C,A,T,D,O,U,j,Z){const N=[],k=this._characterJoinerService.getJoinedCharacters(x),I=this._themeService.colors;let M,B=E.getNoBgTrimmedLength();m&&B<T+1&&(B=T+1);let V=0,Q="",ne=0,te=0,_e=0,R=!1,H=0,z=!1,$=0;const oe=[],L=j!==-1&&Z!==-1;for(let P=0;P<B;P++){E.loadCell(P,this._workCell);let F=this._workCell.getWidth();if(F===0)continue;let K=!1,q=P,W=this._workCell;if(k.length>0&&P===k[0][0]){K=!0;const me=k.shift();W=new f.JoinedCellData(this._workCell,E.translateToString(!0,me[0],me[1]),me[1]-me[0]),q=me[1]-1,F=W.getWidth()}const J=this._isCellInSelection(P,x),X=m&&P===T,Y=L&&P>=j&&P<=Z;let G=!1;this._decorationService.forEachDecorationAtCell(P,x,void 0,me=>{G=!0});let se=W.getChars()||g.WHITESPACE_CELL_CHAR;if(se===" "&&(W.isUnderline()||W.isOverline())&&(se=""),$=F*O-U.get(se,W.isBold(),W.isItalic()),M){if(V&&(J&&z||!J&&!z&&W.bg===ne)&&(J&&z&&I.selectionForeground||W.fg===te)&&W.extended.ext===_e&&Y===R&&$===H&&!X&&!K&&!G){Q+=se,V++;continue}V&&(M.textContent=Q),M=this._document.createElement("span"),V=0,Q=""}else M=this._document.createElement("span");if(ne=W.bg,te=W.fg,_e=W.extended.ext,R=Y,H=$,z=J,K&&T>=P&&T<=q&&(T=P),!this._coreService.isCursorHidden&&X){if(oe.push("xterm-cursor"),this._coreBrowserService.isFocused)D&&oe.push("xterm-cursor-blink"),oe.push(C==="bar"?"xterm-cursor-bar":C==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(A)switch(A){case"outline":oe.push("xterm-cursor-outline");break;case"block":oe.push("xterm-cursor-block");break;case"bar":oe.push("xterm-cursor-bar");break;case"underline":oe.push("xterm-cursor-underline")}}if(W.isBold()&&oe.push("xterm-bold"),W.isItalic()&&oe.push("xterm-italic"),W.isDim()&&oe.push("xterm-dim"),Q=W.isInvisible()?g.WHITESPACE_CELL_CHAR:W.getChars()||g.WHITESPACE_CELL_CHAR,W.isUnderline()&&(oe.push(`xterm-underline-${W.extended.underlineStyle}`),Q===" "&&(Q=""),!W.isUnderlineColorDefault()))if(W.isUnderlineColorRGB())M.style.textDecorationColor=`rgb(${c.AttributeData.toColorRGB(W.getUnderlineColor()).join(",")})`;else{let me=W.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&W.isBold()&&me<8&&(me+=8),M.style.textDecorationColor=I.ansi[me].css}W.isOverline()&&(oe.push("xterm-overline"),Q===" "&&(Q="")),W.isStrikethrough()&&oe.push("xterm-strikethrough"),Y&&(M.style.textDecoration="underline");let ee=W.getFgColor(),ie=W.getFgColorMode(),re=W.getBgColor(),le=W.getBgColorMode();const ve=!!W.isInverse();if(ve){const me=ee;ee=re,re=me;const At=ie;ie=le,le=At}let de,Se,Ce,Ze=!1;switch(this._decorationService.forEachDecorationAtCell(P,x,void 0,me=>{me.options.layer!=="top"&&Ze||(me.backgroundColorRGB&&(le=50331648,re=me.backgroundColorRGB.rgba>>8&16777215,de=me.backgroundColorRGB),me.foregroundColorRGB&&(ie=50331648,ee=me.foregroundColorRGB.rgba>>8&16777215,Se=me.foregroundColorRGB),Ze=me.options.layer==="top")}),!Ze&&J&&(de=this._coreBrowserService.isFocused?I.selectionBackgroundOpaque:I.selectionInactiveBackgroundOpaque,re=de.rgba>>8&16777215,le=50331648,Ze=!0,I.selectionForeground&&(ie=50331648,ee=I.selectionForeground.rgba>>8&16777215,Se=I.selectionForeground)),Ze&&oe.push("xterm-decoration-top"),le){case 16777216:case 33554432:Ce=I.ansi[re],oe.push(`xterm-bg-${re}`);break;case 50331648:Ce=w.rgba.toColor(re>>16,re>>8&255,255&re),this._addStyle(M,`background-color:#${b((re>>>0).toString(16),"0",6)}`);break;default:ve?(Ce=I.foreground,oe.push(`xterm-bg-${_.INVERTED_DEFAULT_COLOR}`)):Ce=I.background}switch(de||W.isDim()&&(de=w.color.multiplyOpacity(Ce,.5)),ie){case 16777216:case 33554432:W.isBold()&&ee<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ee+=8),this._applyMinimumContrast(M,Ce,I.ansi[ee],W,de,void 0)||oe.push(`xterm-fg-${ee}`);break;case 50331648:const me=w.rgba.toColor(ee>>16&255,ee>>8&255,255&ee);this._applyMinimumContrast(M,Ce,me,W,de,Se)||this._addStyle(M,`color:#${b(ee.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(M,Ce,I.foreground,W,de,void 0)||ve&&oe.push(`xterm-fg-${_.INVERTED_DEFAULT_COLOR}`)}oe.length&&(M.className=oe.join(" "),oe.length=0),X||K||G?M.textContent=Q:V++,$!==this.defaultSpacing&&(M.style.letterSpacing=`${$}px`),N.push(M),P=q}return M&&V&&(M.textContent=Q),N}_applyMinimumContrast(E,x,m,C,A,T){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,h.excludeFromContrastRatioDemands)(C.getCode()))return!1;const D=this._getContrastCache(C);let O;if(A||T||(O=D.getColor(x.rgba,m.rgba)),O===void 0){const U=this._optionsService.rawOptions.minimumContrastRatio/(C.isDim()?2:1);O=w.color.ensureContrastRatio(A||x,T||m,U),D.setColor((A||x).rgba,(T||m).rgba,O??null)}return!!O&&(this._addStyle(E,`color:${O.css}`),!0)}_getContrastCache(E){return E.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(E,x){E.setAttribute("style",`${E.getAttribute("style")||""}${x};`)}_isCellInSelection(E,x){const m=this._selectionStart,C=this._selectionEnd;return!(!m||!C)&&(this._columnSelectMode?m[0]<=C[0]?E>=m[0]&&x>=m[1]&&E<C[0]&&x<=C[1]:E<m[0]&&x>=m[1]&&E>=C[0]&&x<=C[1]:x>m[1]&&x<C[1]||m[1]===C[1]&&x===m[1]&&E>=m[0]&&E<C[0]||m[1]<C[1]&&x===C[1]&&E<C[0]||m[1]<C[1]&&x===m[1]&&E>=m[0])}};function b(E,x,m){for(;E.length<m;)E=x+E;return E}s.DomRendererRowFactory=p=a([u(1,n.ICharacterJoinerService),u(2,y.IOptionsService),u(3,n.ICoreBrowserService),u(4,y.ICoreService),u(5,y.IDecorationService),u(6,n.IThemeService)],p)},2550:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WidthCache=void 0,s.WidthCache=class{constructor(l){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=l.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const a=l.createElement("span"),u=l.createElement("span");u.style.fontWeight="bold";const _=l.createElement("span");_.style.fontStyle="italic";const g=l.createElement("span");g.style.fontWeight="bold",g.style.fontStyle="italic",this._measureElements=[a,u,_,g],this._container.appendChild(a),this._container.appendChild(u),this._container.appendChild(_),this._container.appendChild(g),l.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(l,a,u,_){l===this._font&&a===this._fontSize&&u===this._weight&&_===this._weightBold||(this._font=l,this._fontSize=a,this._weight=u,this._weightBold=_,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${u}`,this._measureElements[1].style.fontWeight=`${_}`,this._measureElements[2].style.fontWeight=`${u}`,this._measureElements[3].style.fontWeight=`${_}`,this.clear())}get(l,a,u){let _=0;if(!a&&!u&&l.length===1&&(_=l.charCodeAt(0))<256)return this._flat[_]!==-9999?this._flat[_]:this._flat[_]=this._measure(l,0);let g=l;a&&(g+="B"),u&&(g+="I");let S=this._holey.get(g);if(S===void 0){let y=0;a&&(y|=1),u&&(y|=2),S=this._measure(l,y),this._holey.set(g,S)}return S}_measure(l,a){const u=this._measureElements[a];return u.textContent=l.repeat(32),u.offsetWidth/32}}},2223:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.TEXT_BASELINE=s.DIM_OPACITY=s.INVERTED_DEFAULT_COLOR=void 0;const a=l(6114);s.INVERTED_DEFAULT_COLOR=257,s.DIM_OPACITY=.5,s.TEXT_BASELINE=a.isFirefox||a.isLegacyEdge?"bottom":"ideographic"},6171:(v,s)=>{function l(a){return 57508<=a&&a<=57558}Object.defineProperty(s,"__esModule",{value:!0}),s.createRenderDimensions=s.excludeFromContrastRatioDemands=s.isRestrictedPowerlineGlyph=s.isPowerlineGlyph=s.throwIfFalsy=void 0,s.throwIfFalsy=function(a){if(!a)throw new Error("value must not be falsy");return a},s.isPowerlineGlyph=l,s.isRestrictedPowerlineGlyph=function(a){return 57520<=a&&a<=57527},s.excludeFromContrastRatioDemands=function(a){return l(a)||function(u){return 9472<=u&&u<=9631}(a)},s.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionModel=void 0,s.SelectionModel=class{constructor(l){this._bufferService=l,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?l%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)-1]:[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[l,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[Math.max(l,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const l=this.selectionStart,a=this.selectionEnd;return!(!l||!a)&&(l[1]>a[1]||l[1]===a[1]&&l[0]>a[0])}handleTrim(l){return this.selectionStart&&(this.selectionStart[1]-=l),this.selectionEnd&&(this.selectionEnd[1]-=l),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(v,s,l){var a=this&&this.__decorate||function(n,f,h,c){var p,b=arguments.length,E=b<3?f:c===null?c=Object.getOwnPropertyDescriptor(f,h):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(n,f,h,c);else for(var x=n.length-1;x>=0;x--)(p=n[x])&&(E=(b<3?p(E):b>3?p(f,h,E):p(f,h))||E);return b>3&&E&&Object.defineProperty(f,h,E),E},u=this&&this.__param||function(n,f){return function(h,c){f(h,c,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharSizeService=void 0;const _=l(2585),g=l(8460),S=l(844);let y=s.CharSizeService=class extends S.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(n,f,h){super(),this._optionsService=h,this.width=0,this.height=0,this._onCharSizeChange=this.register(new g.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new w(n,f,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const n=this._measureStrategy.measure();n.width===this.width&&n.height===this.height||(this.width=n.width,this.height=n.height,this._onCharSizeChange.fire())}};s.CharSizeService=y=a([u(2,_.IOptionsService)],y);class w{constructor(f,h,c){this._document=f,this._parentElement=h,this._optionsService=c,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const f={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return f.width!==0&&f.height!==0&&(this._result.width=f.width/32,this._result.height=Math.ceil(f.height)),this._result}}},4269:function(v,s,l){var a=this&&this.__decorate||function(f,h,c,p){var b,E=arguments.length,x=E<3?h:p===null?p=Object.getOwnPropertyDescriptor(h,c):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(f,h,c,p);else for(var m=f.length-1;m>=0;m--)(b=f[m])&&(x=(E<3?b(x):E>3?b(h,c,x):b(h,c))||x);return E>3&&x&&Object.defineProperty(h,c,x),x},u=this&&this.__param||function(f,h){return function(c,p){h(c,p,f)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CharacterJoinerService=s.JoinedCellData=void 0;const _=l(3734),g=l(643),S=l(511),y=l(2585);class w extends _.AttributeData{constructor(h,c,p){super(),this.content=0,this.combinedData="",this.fg=h.fg,this.bg=h.bg,this.combinedData=c,this._width=p}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(h){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.JoinedCellData=w;let n=s.CharacterJoinerService=class rl{constructor(h){this._bufferService=h,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new S.CellData}register(h){const c={id:this._nextCharacterJoinerId++,handler:h};return this._characterJoiners.push(c),c.id}deregister(h){for(let c=0;c<this._characterJoiners.length;c++)if(this._characterJoiners[c].id===h)return this._characterJoiners.splice(c,1),!0;return!1}getJoinedCharacters(h){if(this._characterJoiners.length===0)return[];const c=this._bufferService.buffer.lines.get(h);if(!c||c.length===0)return[];const p=[],b=c.translateToString(!0);let E=0,x=0,m=0,C=c.getFg(0),A=c.getBg(0);for(let T=0;T<c.getTrimmedLength();T++)if(c.loadCell(T,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==C||this._workCell.bg!==A){if(T-E>1){const D=this._getJoinedRanges(b,m,x,c,E);for(let O=0;O<D.length;O++)p.push(D[O])}E=T,m=x,C=this._workCell.fg,A=this._workCell.bg}x+=this._workCell.getChars().length||g.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-E>1){const T=this._getJoinedRanges(b,m,x,c,E);for(let D=0;D<T.length;D++)p.push(T[D])}return p}_getJoinedRanges(h,c,p,b,E){const x=h.substring(c,p);let m=[];try{m=this._characterJoiners[0].handler(x)}catch(C){console.error(C)}for(let C=1;C<this._characterJoiners.length;C++)try{const A=this._characterJoiners[C].handler(x);for(let T=0;T<A.length;T++)rl._mergeRanges(m,A[T])}catch(A){console.error(A)}return this._stringRangesToCellRanges(m,b,E),m}_stringRangesToCellRanges(h,c,p){let b=0,E=!1,x=0,m=h[b];if(m){for(let C=p;C<this._bufferService.cols;C++){const A=c.getWidth(C),T=c.getString(C).length||g.WHITESPACE_CELL_CHAR.length;if(A!==0){if(!E&&m[0]<=x&&(m[0]=C,E=!0),m[1]<=x){if(m[1]=C,m=h[++b],!m)break;m[0]<=x?(m[0]=C,E=!0):E=!1}x+=T}}m&&(m[1]=this._bufferService.cols)}}static _mergeRanges(h,c){let p=!1;for(let b=0;b<h.length;b++){const E=h[b];if(p){if(c[1]<=E[0])return h[b-1][1]=c[1],h;if(c[1]<=E[1])return h[b-1][1]=Math.max(c[1],E[1]),h.splice(b,1),h;h.splice(b,1),b--}else{if(c[1]<=E[0])return h.splice(b,0,c),h;if(c[1]<=E[1])return E[0]=Math.min(c[0],E[0]),h;c[0]<E[1]&&(E[0]=Math.min(c[0],E[0]),p=!0)}}return p?h[h.length-1][1]=c[1]:h.push(c),h}};s.CharacterJoinerService=n=a([u(0,y.IBufferService)],n)},5114:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreBrowserService=void 0,s.CoreBrowserService=class{constructor(l,a){this._textarea=l,this.window=a,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(v,s,l){var a=this&&this.__decorate||function(y,w,n,f){var h,c=arguments.length,p=c<3?w:f===null?f=Object.getOwnPropertyDescriptor(w,n):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(y,w,n,f);else for(var b=y.length-1;b>=0;b--)(h=y[b])&&(p=(c<3?h(p):c>3?h(w,n,p):h(w,n))||p);return c>3&&p&&Object.defineProperty(w,n,p),p},u=this&&this.__param||function(y,w){return function(n,f){w(n,f,y)}};Object.defineProperty(s,"__esModule",{value:!0}),s.MouseService=void 0;const _=l(4725),g=l(9806);let S=s.MouseService=class{constructor(y,w){this._renderService=y,this._charSizeService=w}getCoords(y,w,n,f,h){return(0,g.getCoords)(window,y,w,n,f,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,h)}getMouseReportCoords(y,w){const n=(0,g.getCoordsRelativeToElement)(window,y,w);if(this._charSizeService.hasValidSize)return n[0]=Math.min(Math.max(n[0],0),this._renderService.dimensions.css.canvas.width-1),n[1]=Math.min(Math.max(n[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(n[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(n[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(n[0]),y:Math.floor(n[1])}}};s.MouseService=S=a([u(0,_.IRenderService),u(1,_.ICharSizeService)],S)},3230:function(v,s,l){var a=this&&this.__decorate||function(p,b,E,x){var m,C=arguments.length,A=C<3?b:x===null?x=Object.getOwnPropertyDescriptor(b,E):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(p,b,E,x);else for(var T=p.length-1;T>=0;T--)(m=p[T])&&(A=(C<3?m(A):C>3?m(b,E,A):m(b,E))||A);return C>3&&A&&Object.defineProperty(b,E,A),A},u=this&&this.__param||function(p,b){return function(E,x){b(E,x,p)}};Object.defineProperty(s,"__esModule",{value:!0}),s.RenderService=void 0;const _=l(3656),g=l(6193),S=l(5596),y=l(4725),w=l(8460),n=l(844),f=l(7226),h=l(2585);let c=s.RenderService=class extends n.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(p,b,E,x,m,C,A,T){if(super(),this._rowCount=p,this._charSizeService=x,this._renderer=this.register(new n.MutableDisposable),this._pausedResizeTask=new f.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new w.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new w.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new w.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new w.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new g.RenderDebouncer(A.window,(D,O)=>this._renderRows(D,O)),this.register(this._renderDebouncer),this._screenDprMonitor=new S.ScreenDprMonitor(A.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(C.onResize(()=>this._fullRefresh())),this.register(C.buffers.onBufferActivate(()=>{var D;return(D=this._renderer.value)===null||D===void 0?void 0:D.clear()})),this.register(E.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(m.onDecorationRegistered(()=>this._fullRefresh())),this.register(m.onDecorationRemoved(()=>this._fullRefresh())),this.register(E.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(C.cols,C.rows),this._fullRefresh()})),this.register(E.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(C.buffer.y,C.buffer.y,!0))),this.register((0,_.addDisposableDomListener)(A.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(T.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in A.window){const D=new A.window.IntersectionObserver(O=>this._handleIntersectionChange(O[O.length-1]),{threshold:0});D.observe(b),this.register({dispose:()=>D.disconnect()})}}_handleIntersectionChange(p){this._isPaused=p.isIntersecting===void 0?p.intersectionRatio===0:!p.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(p,b,E=!1){this._isPaused?this._needsFullRefresh=!0:(E||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(p,b,this._rowCount))}_renderRows(p,b){this._renderer.value&&(p=Math.min(p,this._rowCount-1),b=Math.min(b,this._rowCount-1),this._renderer.value.renderRows(p,b),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:p,end:b}),this._onRender.fire({start:p,end:b}),this._isNextRenderRedrawOnly=!0)}resize(p,b){this._rowCount=b,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(p){this._renderer.value=p,this._renderer.value.onRequestRedraw(b=>this.refreshRows(b.start,b.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(p){return this._renderDebouncer.addRefreshCallback(p)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var p,b;this._renderer.value&&((b=(p=this._renderer.value).clearTextureAtlas)===null||b===void 0||b.call(p),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(p,b){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(p,b)):this._renderer.value.handleResize(p,b),this._fullRefresh())}handleCharSizeChanged(){var p;(p=this._renderer.value)===null||p===void 0||p.handleCharSizeChanged()}handleBlur(){var p;(p=this._renderer.value)===null||p===void 0||p.handleBlur()}handleFocus(){var p;(p=this._renderer.value)===null||p===void 0||p.handleFocus()}handleSelectionChanged(p,b,E){var x;this._selectionState.start=p,this._selectionState.end=b,this._selectionState.columnSelectMode=E,(x=this._renderer.value)===null||x===void 0||x.handleSelectionChanged(p,b,E)}handleCursorMove(){var p;(p=this._renderer.value)===null||p===void 0||p.handleCursorMove()}clear(){var p;(p=this._renderer.value)===null||p===void 0||p.clear()}};s.RenderService=c=a([u(2,h.IOptionsService),u(3,y.ICharSizeService),u(4,h.IDecorationService),u(5,h.IBufferService),u(6,y.ICoreBrowserService),u(7,y.IThemeService)],c)},9312:function(v,s,l){var a=this&&this.__decorate||function(m,C,A,T){var D,O=arguments.length,U=O<3?C:T===null?T=Object.getOwnPropertyDescriptor(C,A):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(m,C,A,T);else for(var j=m.length-1;j>=0;j--)(D=m[j])&&(U=(O<3?D(U):O>3?D(C,A,U):D(C,A))||U);return O>3&&U&&Object.defineProperty(C,A,U),U},u=this&&this.__param||function(m,C){return function(A,T){C(A,T,m)}};Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionService=void 0;const _=l(9806),g=l(9504),S=l(456),y=l(4725),w=l(8460),n=l(844),f=l(6114),h=l(4841),c=l(511),p=l(2585),b=String.fromCharCode(160),E=new RegExp(b,"g");let x=s.SelectionService=class extends n.Disposable{constructor(m,C,A,T,D,O,U,j,Z){super(),this._element=m,this._screenElement=C,this._linkifier=A,this._bufferService=T,this._coreService=D,this._mouseService=O,this._optionsService=U,this._renderService=j,this._coreBrowserService=Z,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new c.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new w.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new w.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new w.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new w.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=N=>this._handleMouseMove(N),this._mouseUpListener=N=>this._handleMouseUp(N),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(N=>this._handleTrim(N)),this.register(this._bufferService.buffers.onBufferActivate(N=>this._handleBufferActivate(N))),this.enable(),this._model=new S.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,n.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const m=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;return!(!m||!C||m[0]===C[0]&&m[1]===C[1])}get selectionText(){const m=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;if(!m||!C)return"";const A=this._bufferService.buffer,T=[];if(this._activeSelectionMode===3){if(m[0]===C[0])return"";const D=m[0]<C[0]?m[0]:C[0],O=m[0]<C[0]?C[0]:m[0];for(let U=m[1];U<=C[1];U++){const j=A.translateBufferLineToString(U,!0,D,O);T.push(j)}}else{const D=m[1]===C[1]?C[0]:void 0;T.push(A.translateBufferLineToString(m[1],!0,m[0],D));for(let O=m[1]+1;O<=C[1]-1;O++){const U=A.lines.get(O),j=A.translateBufferLineToString(O,!0);U!=null&&U.isWrapped?T[T.length-1]+=j:T.push(j)}if(m[1]!==C[1]){const O=A.lines.get(C[1]),U=A.translateBufferLineToString(C[1],!0,0,C[0]);O&&O.isWrapped?T[T.length-1]+=U:T.push(U)}}return T.map(D=>D.replace(E," ")).join(f.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(m){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),f.isLinux&&m&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(m){const C=this._getMouseBufferCoords(m),A=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!!(A&&T&&C)&&this._areCoordsInSelection(C,A,T)}isCellInSelection(m,C){const A=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!(!A||!T)&&this._areCoordsInSelection([m,C],A,T)}_areCoordsInSelection(m,C,A){return m[1]>C[1]&&m[1]<A[1]||C[1]===A[1]&&m[1]===C[1]&&m[0]>=C[0]&&m[0]<A[0]||C[1]<A[1]&&m[1]===A[1]&&m[0]<A[0]||C[1]<A[1]&&m[1]===C[1]&&m[0]>=C[0]}_selectWordAtCursor(m,C){var A,T;const D=(T=(A=this._linkifier.currentLink)===null||A===void 0?void 0:A.link)===null||T===void 0?void 0:T.range;if(D)return this._model.selectionStart=[D.start.x-1,D.start.y-1],this._model.selectionStartLength=(0,h.getRangeLength)(D,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const O=this._getMouseBufferCoords(m);return!!O&&(this._selectWordAt(O,C),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(m,C){this._model.clearSelection(),m=Math.max(m,0),C=Math.min(C,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,m],this._model.selectionEnd=[this._bufferService.cols,C],this.refresh(),this._onSelectionChange.fire()}_handleTrim(m){this._model.handleTrim(m)&&this.refresh()}_getMouseBufferCoords(m){const C=this._mouseService.getCoords(m,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(C)return C[0]--,C[1]--,C[1]+=this._bufferService.buffer.ydisp,C}_getMouseEventScrollAmount(m){let C=(0,_.getCoordsRelativeToElement)(this._coreBrowserService.window,m,this._screenElement)[1];const A=this._renderService.dimensions.css.canvas.height;return C>=0&&C<=A?0:(C>A&&(C-=A),C=Math.min(Math.max(C,-50),50),C/=50,C/Math.abs(C)+Math.round(14*C))}shouldForceSelection(m){return f.isMac?m.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:m.shiftKey}handleMouseDown(m){if(this._mouseDownTimeStamp=m.timeStamp,(m.button!==2||!this.hasSelection)&&m.button===0){if(!this._enabled){if(!this.shouldForceSelection(m))return;m.stopPropagation()}m.preventDefault(),this._dragScrollAmount=0,this._enabled&&m.shiftKey?this._handleIncrementalClick(m):m.detail===1?this._handleSingleClick(m):m.detail===2?this._handleDoubleClick(m):m.detail===3&&this._handleTripleClick(m),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(m){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(m))}_handleSingleClick(m){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(m)?3:0,this._model.selectionStart=this._getMouseBufferCoords(m),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const C=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);C&&C.length!==this._model.selectionStart[0]&&C.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(m){this._selectWordAtCursor(m,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(m){const C=this._getMouseBufferCoords(m);C&&(this._activeSelectionMode=2,this._selectLineAt(C[1]))}shouldColumnSelect(m){return m.altKey&&!(f.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(m){if(m.stopImmediatePropagation(),!this._model.selectionStart)return;const C=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(m),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(m),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const A=this._bufferService.buffer;if(this._model.selectionEnd[1]<A.lines.length){const T=A.lines.get(this._model.selectionEnd[1]);T&&T.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}C&&C[0]===this._model.selectionEnd[0]&&C[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const m=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(m.ydisp+this._bufferService.rows,m.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=m.ydisp),this.refresh()}}_handleMouseUp(m){const C=m.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&C<500&&m.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const A=this._mouseService.getCoords(m,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(A&&A[0]!==void 0&&A[1]!==void 0){const T=(0,g.moveToCellSequence)(A[0]-1,A[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(T,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const m=this._model.finalSelectionStart,C=this._model.finalSelectionEnd,A=!(!m||!C||m[0]===C[0]&&m[1]===C[1]);A?m&&C&&(this._oldSelectionStart&&this._oldSelectionEnd&&m[0]===this._oldSelectionStart[0]&&m[1]===this._oldSelectionStart[1]&&C[0]===this._oldSelectionEnd[0]&&C[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(m,C,A)):this._oldHasSelection&&this._fireOnSelectionChange(m,C,A)}_fireOnSelectionChange(m,C,A){this._oldSelectionStart=m,this._oldSelectionEnd=C,this._oldHasSelection=A,this._onSelectionChange.fire()}_handleBufferActivate(m){this.clearSelection(),this._trimListener.dispose(),this._trimListener=m.activeBuffer.lines.onTrim(C=>this._handleTrim(C))}_convertViewportColToCharacterIndex(m,C){let A=C;for(let T=0;C>=T;T++){const D=m.loadCell(T,this._workCell).getChars().length;this._workCell.getWidth()===0?A--:D>1&&C!==T&&(A+=D-1)}return A}setSelection(m,C,A){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[m,C],this._model.selectionStartLength=A,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(m){this._isClickInSelection(m)||(this._selectWordAtCursor(m,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(m,C,A=!0,T=!0){if(m[0]>=this._bufferService.cols)return;const D=this._bufferService.buffer,O=D.lines.get(m[1]);if(!O)return;const U=D.translateBufferLineToString(m[1],!1);let j=this._convertViewportColToCharacterIndex(O,m[0]),Z=j;const N=m[0]-j;let k=0,I=0,M=0,B=0;if(U.charAt(j)===" "){for(;j>0&&U.charAt(j-1)===" ";)j--;for(;Z<U.length&&U.charAt(Z+1)===" ";)Z++}else{let ne=m[0],te=m[0];O.getWidth(ne)===0&&(k++,ne--),O.getWidth(te)===2&&(I++,te++);const _e=O.getString(te).length;for(_e>1&&(B+=_e-1,Z+=_e-1);ne>0&&j>0&&!this._isCharWordSeparator(O.loadCell(ne-1,this._workCell));){O.loadCell(ne-1,this._workCell);const R=this._workCell.getChars().length;this._workCell.getWidth()===0?(k++,ne--):R>1&&(M+=R-1,j-=R-1),j--,ne--}for(;te<O.length&&Z+1<U.length&&!this._isCharWordSeparator(O.loadCell(te+1,this._workCell));){O.loadCell(te+1,this._workCell);const R=this._workCell.getChars().length;this._workCell.getWidth()===2?(I++,te++):R>1&&(B+=R-1,Z+=R-1),Z++,te++}}Z++;let V=j+N-k+M,Q=Math.min(this._bufferService.cols,Z-j+k+I-M-B);if(C||U.slice(j,Z).trim()!==""){if(A&&V===0&&O.getCodePoint(0)!==32){const ne=D.lines.get(m[1]-1);if(ne&&O.isWrapped&&ne.getCodePoint(this._bufferService.cols-1)!==32){const te=this._getWordAt([this._bufferService.cols-1,m[1]-1],!1,!0,!1);if(te){const _e=this._bufferService.cols-te.start;V-=_e,Q+=_e}}}if(T&&V+Q===this._bufferService.cols&&O.getCodePoint(this._bufferService.cols-1)!==32){const ne=D.lines.get(m[1]+1);if(ne!=null&&ne.isWrapped&&ne.getCodePoint(0)!==32){const te=this._getWordAt([0,m[1]+1],!1,!1,!0);te&&(Q+=te.length)}}return{start:V,length:Q}}}_selectWordAt(m,C){const A=this._getWordAt(m,C);if(A){for(;A.start<0;)A.start+=this._bufferService.cols,m[1]--;this._model.selectionStart=[A.start,m[1]],this._model.selectionStartLength=A.length}}_selectToWordAt(m){const C=this._getWordAt(m,!0);if(C){let A=m[1];for(;C.start<0;)C.start+=this._bufferService.cols,A--;if(!this._model.areSelectionValuesReversed())for(;C.start+C.length>this._bufferService.cols;)C.length-=this._bufferService.cols,A++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?C.start:C.start+C.length,A]}}_isCharWordSeparator(m){return m.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(m.getChars())>=0}_selectLineAt(m){const C=this._bufferService.buffer.getWrappedRangeForLine(m),A={start:{x:0,y:C.first},end:{x:this._bufferService.cols-1,y:C.last}};this._model.selectionStart=[0,C.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,h.getRangeLength)(A,this._bufferService.cols)}};s.SelectionService=x=a([u(3,p.IBufferService),u(4,p.ICoreService),u(5,y.IMouseService),u(6,p.IOptionsService),u(7,y.IRenderService),u(8,y.ICoreBrowserService)],x)},4725:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IThemeService=s.ICharacterJoinerService=s.ISelectionService=s.IRenderService=s.IMouseService=s.ICoreBrowserService=s.ICharSizeService=void 0;const a=l(8343);s.ICharSizeService=(0,a.createDecorator)("CharSizeService"),s.ICoreBrowserService=(0,a.createDecorator)("CoreBrowserService"),s.IMouseService=(0,a.createDecorator)("MouseService"),s.IRenderService=(0,a.createDecorator)("RenderService"),s.ISelectionService=(0,a.createDecorator)("SelectionService"),s.ICharacterJoinerService=(0,a.createDecorator)("CharacterJoinerService"),s.IThemeService=(0,a.createDecorator)("ThemeService")},6731:function(v,s,l){var a=this&&this.__decorate||function(x,m,C,A){var T,D=arguments.length,O=D<3?m:A===null?A=Object.getOwnPropertyDescriptor(m,C):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(x,m,C,A);else for(var U=x.length-1;U>=0;U--)(T=x[U])&&(O=(D<3?T(O):D>3?T(m,C,O):T(m,C))||O);return D>3&&O&&Object.defineProperty(m,C,O),O},u=this&&this.__param||function(x,m){return function(C,A){m(C,A,x)}};Object.defineProperty(s,"__esModule",{value:!0}),s.ThemeService=s.DEFAULT_ANSI_COLORS=void 0;const _=l(7239),g=l(8055),S=l(8460),y=l(844),w=l(2585),n=g.css.toColor("#ffffff"),f=g.css.toColor("#000000"),h=g.css.toColor("#ffffff"),c=g.css.toColor("#000000"),p={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};s.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const x=[g.css.toColor("#2e3436"),g.css.toColor("#cc0000"),g.css.toColor("#4e9a06"),g.css.toColor("#c4a000"),g.css.toColor("#3465a4"),g.css.toColor("#75507b"),g.css.toColor("#06989a"),g.css.toColor("#d3d7cf"),g.css.toColor("#555753"),g.css.toColor("#ef2929"),g.css.toColor("#8ae234"),g.css.toColor("#fce94f"),g.css.toColor("#729fcf"),g.css.toColor("#ad7fa8"),g.css.toColor("#34e2e2"),g.css.toColor("#eeeeec")],m=[0,95,135,175,215,255];for(let C=0;C<216;C++){const A=m[C/36%6|0],T=m[C/6%6|0],D=m[C%6];x.push({css:g.channels.toCss(A,T,D),rgba:g.channels.toRgba(A,T,D)})}for(let C=0;C<24;C++){const A=8+10*C;x.push({css:g.channels.toCss(A,A,A),rgba:g.channels.toRgba(A,A,A)})}return x})());let b=s.ThemeService=class extends y.Disposable{get colors(){return this._colors}constructor(x){super(),this._optionsService=x,this._contrastCache=new _.ColorContrastCache,this._halfContrastCache=new _.ColorContrastCache,this._onChangeColors=this.register(new S.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:n,background:f,cursor:h,cursorAccent:c,selectionForeground:void 0,selectionBackgroundTransparent:p,selectionBackgroundOpaque:g.color.blend(f,p),selectionInactiveBackgroundTransparent:p,selectionInactiveBackgroundOpaque:g.color.blend(f,p),ansi:s.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(x={}){const m=this._colors;if(m.foreground=E(x.foreground,n),m.background=E(x.background,f),m.cursor=E(x.cursor,h),m.cursorAccent=E(x.cursorAccent,c),m.selectionBackgroundTransparent=E(x.selectionBackground,p),m.selectionBackgroundOpaque=g.color.blend(m.background,m.selectionBackgroundTransparent),m.selectionInactiveBackgroundTransparent=E(x.selectionInactiveBackground,m.selectionBackgroundTransparent),m.selectionInactiveBackgroundOpaque=g.color.blend(m.background,m.selectionInactiveBackgroundTransparent),m.selectionForeground=x.selectionForeground?E(x.selectionForeground,g.NULL_COLOR):void 0,m.selectionForeground===g.NULL_COLOR&&(m.selectionForeground=void 0),g.color.isOpaque(m.selectionBackgroundTransparent)&&(m.selectionBackgroundTransparent=g.color.opacity(m.selectionBackgroundTransparent,.3)),g.color.isOpaque(m.selectionInactiveBackgroundTransparent)&&(m.selectionInactiveBackgroundTransparent=g.color.opacity(m.selectionInactiveBackgroundTransparent,.3)),m.ansi=s.DEFAULT_ANSI_COLORS.slice(),m.ansi[0]=E(x.black,s.DEFAULT_ANSI_COLORS[0]),m.ansi[1]=E(x.red,s.DEFAULT_ANSI_COLORS[1]),m.ansi[2]=E(x.green,s.DEFAULT_ANSI_COLORS[2]),m.ansi[3]=E(x.yellow,s.DEFAULT_ANSI_COLORS[3]),m.ansi[4]=E(x.blue,s.DEFAULT_ANSI_COLORS[4]),m.ansi[5]=E(x.magenta,s.DEFAULT_ANSI_COLORS[5]),m.ansi[6]=E(x.cyan,s.DEFAULT_ANSI_COLORS[6]),m.ansi[7]=E(x.white,s.DEFAULT_ANSI_COLORS[7]),m.ansi[8]=E(x.brightBlack,s.DEFAULT_ANSI_COLORS[8]),m.ansi[9]=E(x.brightRed,s.DEFAULT_ANSI_COLORS[9]),m.ansi[10]=E(x.brightGreen,s.DEFAULT_ANSI_COLORS[10]),m.ansi[11]=E(x.brightYellow,s.DEFAULT_ANSI_COLORS[11]),m.ansi[12]=E(x.brightBlue,s.DEFAULT_ANSI_COLORS[12]),m.ansi[13]=E(x.brightMagenta,s.DEFAULT_ANSI_COLORS[13]),m.ansi[14]=E(x.brightCyan,s.DEFAULT_ANSI_COLORS[14]),m.ansi[15]=E(x.brightWhite,s.DEFAULT_ANSI_COLORS[15]),x.extendedAnsi){const C=Math.min(m.ansi.length-16,x.extendedAnsi.length);for(let A=0;A<C;A++)m.ansi[A+16]=E(x.extendedAnsi[A],s.DEFAULT_ANSI_COLORS[A+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(x){this._restoreColor(x),this._onChangeColors.fire(this.colors)}_restoreColor(x){if(x!==void 0)switch(x){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[x]=this._restoreColors.ansi[x]}else for(let m=0;m<this._restoreColors.ansi.length;++m)this._colors.ansi[m]=this._restoreColors.ansi[m]}modifyColors(x){x(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function E(x,m){if(x!==void 0)try{return g.css.toColor(x)}catch{}return m}s.ThemeService=b=a([u(0,w.IOptionsService)],b)},6349:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CircularList=void 0;const a=l(8460),u=l(844);class _ extends u.Disposable{constructor(S){super(),this._maxLength=S,this.onDeleteEmitter=this.register(new a.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new a.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new a.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(S){if(this._maxLength===S)return;const y=new Array(S);for(let w=0;w<Math.min(S,this.length);w++)y[w]=this._array[this._getCyclicIndex(w)];this._array=y,this._maxLength=S,this._startIndex=0}get length(){return this._length}set length(S){if(S>this._length)for(let y=this._length;y<S;y++)this._array[y]=void 0;this._length=S}get(S){return this._array[this._getCyclicIndex(S)]}set(S,y){this._array[this._getCyclicIndex(S)]=y}push(S){this._array[this._getCyclicIndex(this._length)]=S,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(S,y,...w){if(y){for(let n=S;n<this._length-y;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+y)];this._length-=y,this.onDeleteEmitter.fire({index:S,amount:y})}for(let n=this._length-1;n>=S;n--)this._array[this._getCyclicIndex(n+w.length)]=this._array[this._getCyclicIndex(n)];for(let n=0;n<w.length;n++)this._array[this._getCyclicIndex(S+n)]=w[n];if(w.length&&this.onInsertEmitter.fire({index:S,amount:w.length}),this._length+w.length>this._maxLength){const n=this._length+w.length-this._maxLength;this._startIndex+=n,this._length=this._maxLength,this.onTrimEmitter.fire(n)}else this._length+=w.length}trimStart(S){S>this._length&&(S=this._length),this._startIndex+=S,this._length-=S,this.onTrimEmitter.fire(S)}shiftElements(S,y,w){if(!(y<=0)){if(S<0||S>=this._length)throw new Error("start argument out of range");if(S+w<0)throw new Error("Cannot shift elements in list beyond index 0");if(w>0){for(let f=y-1;f>=0;f--)this.set(S+f+w,this.get(S+f));const n=S+y+w-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let n=0;n<y;n++)this.set(S+n+w,this.get(S+n))}}_getCyclicIndex(S){return(this._startIndex+S)%this._maxLength}}s.CircularList=_},1439:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.clone=void 0,s.clone=function l(a,u=5){if(typeof a!="object")return a;const _=Array.isArray(a)?[]:{};for(const g in a)_[g]=u<=1?a[g]:a[g]&&l(a[g],u-1);return _}},8055:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.contrastRatio=s.toPaddedHex=s.rgba=s.rgb=s.css=s.color=s.channels=s.NULL_COLOR=void 0;const a=l(6114);let u=0,_=0,g=0,S=0;var y,w,n,f,h;function c(b){const E=b.toString(16);return E.length<2?"0"+E:E}function p(b,E){return b<E?(E+.05)/(b+.05):(b+.05)/(E+.05)}s.NULL_COLOR={css:"#00000000",rgba:0},function(b){b.toCss=function(E,x,m,C){return C!==void 0?`#${c(E)}${c(x)}${c(m)}${c(C)}`:`#${c(E)}${c(x)}${c(m)}`},b.toRgba=function(E,x,m,C=255){return(E<<24|x<<16|m<<8|C)>>>0}}(y||(s.channels=y={})),function(b){function E(x,m){return S=Math.round(255*m),[u,_,g]=h.toChannels(x.rgba),{css:y.toCss(u,_,g,S),rgba:y.toRgba(u,_,g,S)}}b.blend=function(x,m){if(S=(255&m.rgba)/255,S===1)return{css:m.css,rgba:m.rgba};const C=m.rgba>>24&255,A=m.rgba>>16&255,T=m.rgba>>8&255,D=x.rgba>>24&255,O=x.rgba>>16&255,U=x.rgba>>8&255;return u=D+Math.round((C-D)*S),_=O+Math.round((A-O)*S),g=U+Math.round((T-U)*S),{css:y.toCss(u,_,g),rgba:y.toRgba(u,_,g)}},b.isOpaque=function(x){return(255&x.rgba)==255},b.ensureContrastRatio=function(x,m,C){const A=h.ensureContrastRatio(x.rgba,m.rgba,C);if(A)return h.toColor(A>>24&255,A>>16&255,A>>8&255)},b.opaque=function(x){const m=(255|x.rgba)>>>0;return[u,_,g]=h.toChannels(m),{css:y.toCss(u,_,g),rgba:m}},b.opacity=E,b.multiplyOpacity=function(x,m){return S=255&x.rgba,E(x,S*m/255)},b.toColorRGB=function(x){return[x.rgba>>24&255,x.rgba>>16&255,x.rgba>>8&255]}}(w||(s.color=w={})),function(b){let E,x;if(!a.isNode){const m=document.createElement("canvas");m.width=1,m.height=1;const C=m.getContext("2d",{willReadFrequently:!0});C&&(E=C,E.globalCompositeOperation="copy",x=E.createLinearGradient(0,0,1,1))}b.toColor=function(m){if(m.match(/#[\da-f]{3,8}/i))switch(m.length){case 4:return u=parseInt(m.slice(1,2).repeat(2),16),_=parseInt(m.slice(2,3).repeat(2),16),g=parseInt(m.slice(3,4).repeat(2),16),h.toColor(u,_,g);case 5:return u=parseInt(m.slice(1,2).repeat(2),16),_=parseInt(m.slice(2,3).repeat(2),16),g=parseInt(m.slice(3,4).repeat(2),16),S=parseInt(m.slice(4,5).repeat(2),16),h.toColor(u,_,g,S);case 7:return{css:m,rgba:(parseInt(m.slice(1),16)<<8|255)>>>0};case 9:return{css:m,rgba:parseInt(m.slice(1),16)>>>0}}const C=m.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return u=parseInt(C[1]),_=parseInt(C[2]),g=parseInt(C[3]),S=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),h.toColor(u,_,g,S);if(!E||!x)throw new Error("css.toColor: Unsupported css format");if(E.fillStyle=x,E.fillStyle=m,typeof E.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(E.fillRect(0,0,1,1),[u,_,g,S]=E.getImageData(0,0,1,1).data,S!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:y.toRgba(u,_,g,S),css:m}}}(n||(s.css=n={})),function(b){function E(x,m,C){const A=x/255,T=m/255,D=C/255;return .2126*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))+.7152*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.0722*(D<=.03928?D/12.92:Math.pow((D+.055)/1.055,2.4))}b.relativeLuminance=function(x){return E(x>>16&255,x>>8&255,255&x)},b.relativeLuminance2=E}(f||(s.rgb=f={})),function(b){function E(m,C,A){const T=m>>24&255,D=m>>16&255,O=m>>8&255;let U=C>>24&255,j=C>>16&255,Z=C>>8&255,N=p(f.relativeLuminance2(U,j,Z),f.relativeLuminance2(T,D,O));for(;N<A&&(U>0||j>0||Z>0);)U-=Math.max(0,Math.ceil(.1*U)),j-=Math.max(0,Math.ceil(.1*j)),Z-=Math.max(0,Math.ceil(.1*Z)),N=p(f.relativeLuminance2(U,j,Z),f.relativeLuminance2(T,D,O));return(U<<24|j<<16|Z<<8|255)>>>0}function x(m,C,A){const T=m>>24&255,D=m>>16&255,O=m>>8&255;let U=C>>24&255,j=C>>16&255,Z=C>>8&255,N=p(f.relativeLuminance2(U,j,Z),f.relativeLuminance2(T,D,O));for(;N<A&&(U<255||j<255||Z<255);)U=Math.min(255,U+Math.ceil(.1*(255-U))),j=Math.min(255,j+Math.ceil(.1*(255-j))),Z=Math.min(255,Z+Math.ceil(.1*(255-Z))),N=p(f.relativeLuminance2(U,j,Z),f.relativeLuminance2(T,D,O));return(U<<24|j<<16|Z<<8|255)>>>0}b.ensureContrastRatio=function(m,C,A){const T=f.relativeLuminance(m>>8),D=f.relativeLuminance(C>>8);if(p(T,D)<A){if(D<T){const j=E(m,C,A),Z=p(T,f.relativeLuminance(j>>8));if(Z<A){const N=x(m,C,A);return Z>p(T,f.relativeLuminance(N>>8))?j:N}return j}const O=x(m,C,A),U=p(T,f.relativeLuminance(O>>8));if(U<A){const j=E(m,C,A);return U>p(T,f.relativeLuminance(j>>8))?O:j}return O}},b.reduceLuminance=E,b.increaseLuminance=x,b.toChannels=function(m){return[m>>24&255,m>>16&255,m>>8&255,255&m]},b.toColor=function(m,C,A,T){return{css:y.toCss(m,C,A,T),rgba:y.toRgba(m,C,A,T)}}}(h||(s.rgba=h={})),s.toPaddedHex=c,s.contrastRatio=p},8969:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CoreTerminal=void 0;const a=l(844),u=l(2585),_=l(4348),g=l(7866),S=l(744),y=l(7302),w=l(6975),n=l(8460),f=l(1753),h=l(1480),c=l(7994),p=l(9282),b=l(5435),E=l(5981),x=l(2660);let m=!1;class C extends a.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new n.EventEmitter),this._onScroll.event(T=>{var D;(D=this._onScrollApi)===null||D===void 0||D.fire(T.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(T){for(const D in T)this.optionsService.options[D]=T[D]}constructor(T){super(),this._windowsWrappingHeuristics=this.register(new a.MutableDisposable),this._onBinary=this.register(new n.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new n.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new n.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new n.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new n.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new n.EventEmitter),this._instantiationService=new _.InstantiationService,this.optionsService=this.register(new y.OptionsService(T)),this._instantiationService.setService(u.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(S.BufferService)),this._instantiationService.setService(u.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(g.LogService)),this._instantiationService.setService(u.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(w.CoreService)),this._instantiationService.setService(u.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(f.CoreMouseService)),this._instantiationService.setService(u.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(h.UnicodeService)),this._instantiationService.setService(u.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(c.CharsetService),this._instantiationService.setService(u.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(x.OscLinkService),this._instantiationService.setService(u.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new b.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,n.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,n.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,n.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,n.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(D=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(D=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new E.WriteBuffer((D,O)=>this._inputHandler.parse(D,O))),this.register((0,n.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(T,D){this._writeBuffer.write(T,D)}writeSync(T,D){this._logService.logLevel<=u.LogLevelEnum.WARN&&!m&&(this._logService.warn("writeSync is unreliable and will be removed soon."),m=!0),this._writeBuffer.writeSync(T,D)}resize(T,D){isNaN(T)||isNaN(D)||(T=Math.max(T,S.MINIMUM_COLS),D=Math.max(D,S.MINIMUM_ROWS),this._bufferService.resize(T,D))}scroll(T,D=!1){this._bufferService.scroll(T,D)}scrollLines(T,D,O){this._bufferService.scrollLines(T,D,O)}scrollPages(T){this.scrollLines(T*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(T){const D=T-this._bufferService.buffer.ydisp;D!==0&&this.scrollLines(D)}registerEscHandler(T,D){return this._inputHandler.registerEscHandler(T,D)}registerDcsHandler(T,D){return this._inputHandler.registerDcsHandler(T,D)}registerCsiHandler(T,D){return this._inputHandler.registerCsiHandler(T,D)}registerOscHandler(T,D){return this._inputHandler.registerOscHandler(T,D)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let T=!1;const D=this.optionsService.rawOptions.windowsPty;D&&D.buildNumber!==void 0&&D.buildNumber!==void 0?T=D.backend==="conpty"&&D.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(T=!0),T?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const T=[];T.push(this.onLineFeed(p.updateWindowsModeWrappedState.bind(null,this._bufferService))),T.push(this.registerCsiHandler({final:"H"},()=>((0,p.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,a.toDisposable)(()=>{for(const D of T)D.dispose()})}}}s.CoreTerminal=C},8460:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.forwardEvent=s.EventEmitter=void 0,s.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=l=>(this._listeners.push(l),{dispose:()=>{if(!this._disposed){for(let a=0;a<this._listeners.length;a++)if(this._listeners[a]===l)return void this._listeners.splice(a,1)}}})),this._event}fire(l,a){const u=[];for(let _=0;_<this._listeners.length;_++)u.push(this._listeners[_]);for(let _=0;_<u.length;_++)u[_].call(void 0,l,a)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},s.forwardEvent=function(l,a){return l(u=>a.fire(u))}},5435:function(v,s,l){var a=this&&this.__decorate||function(N,k,I,M){var B,V=arguments.length,Q=V<3?k:M===null?M=Object.getOwnPropertyDescriptor(k,I):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Q=Reflect.decorate(N,k,I,M);else for(var ne=N.length-1;ne>=0;ne--)(B=N[ne])&&(Q=(V<3?B(Q):V>3?B(k,I,Q):B(k,I))||Q);return V>3&&Q&&Object.defineProperty(k,I,Q),Q},u=this&&this.__param||function(N,k){return function(I,M){k(I,M,N)}};Object.defineProperty(s,"__esModule",{value:!0}),s.InputHandler=s.WindowsOptionsReportType=void 0;const _=l(2584),g=l(7116),S=l(2015),y=l(844),w=l(482),n=l(8437),f=l(8460),h=l(643),c=l(511),p=l(3734),b=l(2585),E=l(6242),x=l(6351),m=l(5941),C={"(":0,")":1,"*":2,"+":3,"-":1,".":2},A=131072;function T(N,k){if(N>24)return k.setWinLines||!1;switch(N){case 1:return!!k.restoreWin;case 2:return!!k.minimizeWin;case 3:return!!k.setWinPosition;case 4:return!!k.setWinSizePixels;case 5:return!!k.raiseWin;case 6:return!!k.lowerWin;case 7:return!!k.refreshWin;case 8:return!!k.setWinSizeChars;case 9:return!!k.maximizeWin;case 10:return!!k.fullscreenWin;case 11:return!!k.getWinState;case 13:return!!k.getWinPosition;case 14:return!!k.getWinSizePixels;case 15:return!!k.getScreenSizePixels;case 16:return!!k.getCellSizePixels;case 18:return!!k.getWinSizeChars;case 19:return!!k.getScreenSizeChars;case 20:return!!k.getIconTitle;case 21:return!!k.getWinTitle;case 22:return!!k.pushTitle;case 23:return!!k.popTitle;case 24:return!!k.setWinLines}return!1}var D;(function(N){N[N.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",N[N.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(D||(s.WindowsOptionsReportType=D={}));let O=0;class U extends y.Disposable{getAttrData(){return this._curAttrData}constructor(k,I,M,B,V,Q,ne,te,_e=new S.EscapeSequenceParser){super(),this._bufferService=k,this._charsetService=I,this._coreService=M,this._logService=B,this._optionsService=V,this._oscLinkService=Q,this._coreMouseService=ne,this._unicodeService=te,this._parser=_e,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new w.StringToUtf32,this._utf8Decoder=new w.Utf8ToUtf32,this._workCell=new c.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new f.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new f.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new f.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new f.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new f.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new f.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new f.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new f.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new f.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new f.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new f.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new f.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new f.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new j(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(R=>this._activeBuffer=R.activeBuffer)),this._parser.setCsiHandlerFallback((R,H)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(R),params:H.toArray()})}),this._parser.setEscHandlerFallback(R=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(R)})}),this._parser.setExecuteHandlerFallback(R=>{this._logService.debug("Unknown EXECUTE code: ",{code:R})}),this._parser.setOscHandlerFallback((R,H,z)=>{this._logService.debug("Unknown OSC code: ",{identifier:R,action:H,data:z})}),this._parser.setDcsHandlerFallback((R,H,z)=>{H==="HOOK"&&(z=z.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(R),action:H,payload:z})}),this._parser.setPrintHandler((R,H,z)=>this.print(R,H,z)),this._parser.registerCsiHandler({final:"@"},R=>this.insertChars(R)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},R=>this.scrollLeft(R)),this._parser.registerCsiHandler({final:"A"},R=>this.cursorUp(R)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},R=>this.scrollRight(R)),this._parser.registerCsiHandler({final:"B"},R=>this.cursorDown(R)),this._parser.registerCsiHandler({final:"C"},R=>this.cursorForward(R)),this._parser.registerCsiHandler({final:"D"},R=>this.cursorBackward(R)),this._parser.registerCsiHandler({final:"E"},R=>this.cursorNextLine(R)),this._parser.registerCsiHandler({final:"F"},R=>this.cursorPrecedingLine(R)),this._parser.registerCsiHandler({final:"G"},R=>this.cursorCharAbsolute(R)),this._parser.registerCsiHandler({final:"H"},R=>this.cursorPosition(R)),this._parser.registerCsiHandler({final:"I"},R=>this.cursorForwardTab(R)),this._parser.registerCsiHandler({final:"J"},R=>this.eraseInDisplay(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},R=>this.eraseInDisplay(R,!0)),this._parser.registerCsiHandler({final:"K"},R=>this.eraseInLine(R,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},R=>this.eraseInLine(R,!0)),this._parser.registerCsiHandler({final:"L"},R=>this.insertLines(R)),this._parser.registerCsiHandler({final:"M"},R=>this.deleteLines(R)),this._parser.registerCsiHandler({final:"P"},R=>this.deleteChars(R)),this._parser.registerCsiHandler({final:"S"},R=>this.scrollUp(R)),this._parser.registerCsiHandler({final:"T"},R=>this.scrollDown(R)),this._parser.registerCsiHandler({final:"X"},R=>this.eraseChars(R)),this._parser.registerCsiHandler({final:"Z"},R=>this.cursorBackwardTab(R)),this._parser.registerCsiHandler({final:"`"},R=>this.charPosAbsolute(R)),this._parser.registerCsiHandler({final:"a"},R=>this.hPositionRelative(R)),this._parser.registerCsiHandler({final:"b"},R=>this.repeatPrecedingCharacter(R)),this._parser.registerCsiHandler({final:"c"},R=>this.sendDeviceAttributesPrimary(R)),this._parser.registerCsiHandler({prefix:">",final:"c"},R=>this.sendDeviceAttributesSecondary(R)),this._parser.registerCsiHandler({final:"d"},R=>this.linePosAbsolute(R)),this._parser.registerCsiHandler({final:"e"},R=>this.vPositionRelative(R)),this._parser.registerCsiHandler({final:"f"},R=>this.hVPosition(R)),this._parser.registerCsiHandler({final:"g"},R=>this.tabClear(R)),this._parser.registerCsiHandler({final:"h"},R=>this.setMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"h"},R=>this.setModePrivate(R)),this._parser.registerCsiHandler({final:"l"},R=>this.resetMode(R)),this._parser.registerCsiHandler({prefix:"?",final:"l"},R=>this.resetModePrivate(R)),this._parser.registerCsiHandler({final:"m"},R=>this.charAttributes(R)),this._parser.registerCsiHandler({final:"n"},R=>this.deviceStatus(R)),this._parser.registerCsiHandler({prefix:"?",final:"n"},R=>this.deviceStatusPrivate(R)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},R=>this.softReset(R)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},R=>this.setCursorStyle(R)),this._parser.registerCsiHandler({final:"r"},R=>this.setScrollRegion(R)),this._parser.registerCsiHandler({final:"s"},R=>this.saveCursor(R)),this._parser.registerCsiHandler({final:"t"},R=>this.windowOptions(R)),this._parser.registerCsiHandler({final:"u"},R=>this.restoreCursor(R)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},R=>this.insertColumns(R)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},R=>this.deleteColumns(R)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},R=>this.selectProtected(R)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},R=>this.requestMode(R,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},R=>this.requestMode(R,!1)),this._parser.setExecuteHandler(_.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(_.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(_.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(_.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(_.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(_.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(_.C1.IND,()=>this.index()),this._parser.setExecuteHandler(_.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(_.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new E.OscHandler(R=>(this.setTitle(R),this.setIconName(R),!0))),this._parser.registerOscHandler(1,new E.OscHandler(R=>this.setIconName(R))),this._parser.registerOscHandler(2,new E.OscHandler(R=>this.setTitle(R))),this._parser.registerOscHandler(4,new E.OscHandler(R=>this.setOrReportIndexedColor(R))),this._parser.registerOscHandler(8,new E.OscHandler(R=>this.setHyperlink(R))),this._parser.registerOscHandler(10,new E.OscHandler(R=>this.setOrReportFgColor(R))),this._parser.registerOscHandler(11,new E.OscHandler(R=>this.setOrReportBgColor(R))),this._parser.registerOscHandler(12,new E.OscHandler(R=>this.setOrReportCursorColor(R))),this._parser.registerOscHandler(104,new E.OscHandler(R=>this.restoreIndexedColor(R))),this._parser.registerOscHandler(110,new E.OscHandler(R=>this.restoreFgColor(R))),this._parser.registerOscHandler(111,new E.OscHandler(R=>this.restoreBgColor(R))),this._parser.registerOscHandler(112,new E.OscHandler(R=>this.restoreCursorColor(R))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const R in g.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:R},()=>this.selectCharset("("+R)),this._parser.registerEscHandler({intermediates:")",final:R},()=>this.selectCharset(")"+R)),this._parser.registerEscHandler({intermediates:"*",final:R},()=>this.selectCharset("*"+R)),this._parser.registerEscHandler({intermediates:"+",final:R},()=>this.selectCharset("+"+R)),this._parser.registerEscHandler({intermediates:"-",final:R},()=>this.selectCharset("-"+R)),this._parser.registerEscHandler({intermediates:".",final:R},()=>this.selectCharset("."+R)),this._parser.registerEscHandler({intermediates:"/",final:R},()=>this.selectCharset("/"+R));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(R=>(this._logService.error("Parsing error: ",R),R)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new x.DcsHandler((R,H)=>this.requestStatusString(R,H)))}_preserveStack(k,I,M,B){this._parseStack.paused=!0,this._parseStack.cursorStartX=k,this._parseStack.cursorStartY=I,this._parseStack.decodedLength=M,this._parseStack.position=B}_logSlowResolvingAsync(k){this._logService.logLevel<=b.LogLevelEnum.WARN&&Promise.race([k,new Promise((I,M)=>setTimeout(()=>M("#SLOW_TIMEOUT"),5e3))]).catch(I=>{if(I!=="#SLOW_TIMEOUT")throw I;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(k,I){let M,B=this._activeBuffer.x,V=this._activeBuffer.y,Q=0;const ne=this._parseStack.paused;if(ne){if(M=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,I))return this._logSlowResolvingAsync(M),M;B=this._parseStack.cursorStartX,V=this._parseStack.cursorStartY,this._parseStack.paused=!1,k.length>A&&(Q=this._parseStack.position+A)}if(this._logService.logLevel<=b.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof k=="string"?` "${k}"`:` "${Array.prototype.map.call(k,te=>String.fromCharCode(te)).join("")}"`),typeof k=="string"?k.split("").map(te=>te.charCodeAt(0)):k),this._parseBuffer.length<k.length&&this._parseBuffer.length<A&&(this._parseBuffer=new Uint32Array(Math.min(k.length,A))),ne||this._dirtyRowTracker.clearRange(),k.length>A)for(let te=Q;te<k.length;te+=A){const _e=te+A<k.length?te+A:k.length,R=typeof k=="string"?this._stringDecoder.decode(k.substring(te,_e),this._parseBuffer):this._utf8Decoder.decode(k.subarray(te,_e),this._parseBuffer);if(M=this._parser.parse(this._parseBuffer,R))return this._preserveStack(B,V,R,te),this._logSlowResolvingAsync(M),M}else if(!ne){const te=typeof k=="string"?this._stringDecoder.decode(k,this._parseBuffer):this._utf8Decoder.decode(k,this._parseBuffer);if(M=this._parser.parse(this._parseBuffer,te))return this._preserveStack(B,V,te,0),this._logSlowResolvingAsync(M),M}this._activeBuffer.x===B&&this._activeBuffer.y===V||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(k,I,M){let B,V;const Q=this._charsetService.charset,ne=this._optionsService.rawOptions.screenReaderMode,te=this._bufferService.cols,_e=this._coreService.decPrivateModes.wraparound,R=this._coreService.modes.insertMode,H=this._curAttrData;let z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&M-I>0&&z.getWidth(this._activeBuffer.x-1)===2&&z.setCellFromCodePoint(this._activeBuffer.x-1,0,1,H.fg,H.bg,H.extended);for(let $=I;$<M;++$){if(B=k[$],V=this._unicodeService.wcwidth(B),B<127&&Q){const oe=Q[String.fromCharCode(B)];oe&&(B=oe.charCodeAt(0))}if(ne&&this._onA11yChar.fire((0,w.stringFromCodePoint)(B)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),V||!this._activeBuffer.x){if(this._activeBuffer.x+V-1>=te){if(_e){for(;this._activeBuffer.x<te;)z.setCellFromCodePoint(this._activeBuffer.x++,0,1,H.fg,H.bg,H.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=te-1,V===2)continue}if(R&&(z.insertCells(this._activeBuffer.x,V,this._activeBuffer.getNullCell(H),H),z.getWidth(te-1)===2&&z.setCellFromCodePoint(te-1,h.NULL_CELL_CODE,h.NULL_CELL_WIDTH,H.fg,H.bg,H.extended)),z.setCellFromCodePoint(this._activeBuffer.x++,B,V,H.fg,H.bg,H.extended),V>0)for(;--V;)z.setCellFromCodePoint(this._activeBuffer.x++,0,0,H.fg,H.bg,H.extended)}else z.getWidth(this._activeBuffer.x-1)?z.addCodepointToCell(this._activeBuffer.x-1,B):z.addCodepointToCell(this._activeBuffer.x-2,B)}M-I>0&&(z.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<te&&M-I>0&&z.getWidth(this._activeBuffer.x)===0&&!z.hasContent(this._activeBuffer.x)&&z.setCellFromCodePoint(this._activeBuffer.x,0,1,H.fg,H.bg,H.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(k,I){return k.final!=="t"||k.prefix||k.intermediates?this._parser.registerCsiHandler(k,I):this._parser.registerCsiHandler(k,M=>!T(M.params[0],this._optionsService.rawOptions.windowOptions)||I(M))}registerDcsHandler(k,I){return this._parser.registerDcsHandler(k,new x.DcsHandler(I))}registerEscHandler(k,I){return this._parser.registerEscHandler(k,I)}registerOscHandler(k,I){return this._parser.registerOscHandler(k,new E.OscHandler(I))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var k;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||k===void 0)&&k.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);I.hasWidth(this._activeBuffer.x)&&!I.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const k=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-k),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(k=this._bufferService.cols-1){this._activeBuffer.x=Math.min(k,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(k,I){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=k,this._activeBuffer.y=this._activeBuffer.scrollTop+I):(this._activeBuffer.x=k,this._activeBuffer.y=I),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(k,I){this._restrictCursor(),this._setCursor(this._activeBuffer.x+k,this._activeBuffer.y+I)}cursorUp(k){const I=this._activeBuffer.y-this._activeBuffer.scrollTop;return I>=0?this._moveCursor(0,-Math.min(I,k.params[0]||1)):this._moveCursor(0,-(k.params[0]||1)),!0}cursorDown(k){const I=this._activeBuffer.scrollBottom-this._activeBuffer.y;return I>=0?this._moveCursor(0,Math.min(I,k.params[0]||1)):this._moveCursor(0,k.params[0]||1),!0}cursorForward(k){return this._moveCursor(k.params[0]||1,0),!0}cursorBackward(k){return this._moveCursor(-(k.params[0]||1),0),!0}cursorNextLine(k){return this.cursorDown(k),this._activeBuffer.x=0,!0}cursorPrecedingLine(k){return this.cursorUp(k),this._activeBuffer.x=0,!0}cursorCharAbsolute(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(k){return this._setCursor(k.length>=2?(k.params[1]||1)-1:0,(k.params[0]||1)-1),!0}charPosAbsolute(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(k){return this._moveCursor(k.params[0]||1,0),!0}linePosAbsolute(k){return this._setCursor(this._activeBuffer.x,(k.params[0]||1)-1),!0}vPositionRelative(k){return this._moveCursor(0,k.params[0]||1),!0}hVPosition(k){return this.cursorPosition(k),!0}tabClear(k){const I=k.params[0];return I===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:I===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let I=k.params[0]||1;for(;I--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let I=k.params[0]||1;for(;I--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(k){const I=k.params[0];return I===1&&(this._curAttrData.bg|=536870912),I!==2&&I!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(k,I,M,B=!1,V=!1){const Q=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);Q.replaceCells(I,M,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),V),B&&(Q.isWrapped=!1)}_resetBufferLine(k,I=!1){const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);M&&(M.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),I),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+k),M.isWrapped=!1)}eraseInDisplay(k,I=!1){let M;switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:for(M=this._activeBuffer.y,this._dirtyRowTracker.markDirty(M),this._eraseInBufferLine(M++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,I);M<this._bufferService.rows;M++)this._resetBufferLine(M,I);this._dirtyRowTracker.markDirty(M);break;case 1:for(M=this._activeBuffer.y,this._dirtyRowTracker.markDirty(M),this._eraseInBufferLine(M,0,this._activeBuffer.x+1,!0,I),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(M+1).isWrapped=!1);M--;)this._resetBufferLine(M,I);this._dirtyRowTracker.markDirty(0);break;case 2:for(M=this._bufferService.rows,this._dirtyRowTracker.markDirty(M-1);M--;)this._resetBufferLine(M,I);this._dirtyRowTracker.markDirty(0);break;case 3:const B=this._activeBuffer.lines.length-this._bufferService.rows;B>0&&(this._activeBuffer.lines.trimStart(B),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-B,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-B,0),this._onScroll.fire(0))}return!0}eraseInLine(k,I=!1){switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,I);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,I);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,I)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(k){this._restrictCursor();let I=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=this._activeBuffer.ybase+this._activeBuffer.y,B=this._bufferService.rows-1-this._activeBuffer.scrollBottom,V=this._bufferService.rows-1+this._activeBuffer.ybase-B+1;for(;I--;)this._activeBuffer.lines.splice(V-1,1),this._activeBuffer.lines.splice(M,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(k){this._restrictCursor();let I=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=this._activeBuffer.ybase+this._activeBuffer.y;let B;for(B=this._bufferService.rows-1-this._activeBuffer.scrollBottom,B=this._bufferService.rows-1+this._activeBuffer.ybase-B;I--;)this._activeBuffer.lines.splice(M,1),this._activeBuffer.lines.splice(B,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(k){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.insertCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(k){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.deleteCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(k){let I=k.params[0]||1;for(;I--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(k){let I=k.params[0]||1;for(;I--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(n.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=k.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);B.deleteCells(0,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),B.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=k.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);B.insertCells(0,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),B.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=k.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);B.insertCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),B.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=k.params[0]||1;for(let M=this._activeBuffer.scrollTop;M<=this._activeBuffer.scrollBottom;++M){const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+M);B.deleteCells(this._activeBuffer.x,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),B.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(k){this._restrictCursor();const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return I&&(I.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(k.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(k){if(!this._parser.precedingCodepoint)return!0;const I=k.params[0]||1,M=new Uint32Array(I);for(let B=0;B<I;++B)M[B]=this._parser.precedingCodepoint;return this.print(M,0,M.length),!0}sendDeviceAttributesPrimary(k){return k.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(_.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(_.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(k){return k.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(_.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(_.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(k.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(_.C0.ESC+"[>83;40003;0c")),!0}_is(k){return(this._optionsService.rawOptions.termName+"").indexOf(k)===0}setMode(k){for(let I=0;I<k.length;I++)switch(k.params[I]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(k){for(let I=0;I<k.length;I++)switch(k.params[I]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,g.DEFAULT_CHARSET),this._charsetService.setgCharset(1,g.DEFAULT_CHARSET),this._charsetService.setgCharset(2,g.DEFAULT_CHARSET),this._charsetService.setgCharset(3,g.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(k){for(let I=0;I<k.length;I++)switch(k.params[I]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(k){for(let I=0;I<k.length;I++)switch(k.params[I]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),k.params[I]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(k,I){const M=this._coreService.decPrivateModes,{activeProtocol:B,activeEncoding:V}=this._coreMouseService,Q=this._coreService,{buffers:ne,cols:te}=this._bufferService,{active:_e,alt:R}=ne,H=this._optionsService.rawOptions,z=P=>P?1:2,$=k.params[0];return oe=$,L=I?$===2?4:$===4?z(Q.modes.insertMode):$===12?3:$===20?z(H.convertEol):0:$===1?z(M.applicationCursorKeys):$===3?H.windowOptions.setWinLines?te===80?2:te===132?1:0:0:$===6?z(M.origin):$===7?z(M.wraparound):$===8?3:$===9?z(B==="X10"):$===12?z(H.cursorBlink):$===25?z(!Q.isCursorHidden):$===45?z(M.reverseWraparound):$===66?z(M.applicationKeypad):$===67?4:$===1e3?z(B==="VT200"):$===1002?z(B==="DRAG"):$===1003?z(B==="ANY"):$===1004?z(M.sendFocus):$===1005?4:$===1006?z(V==="SGR"):$===1015?4:$===1016?z(V==="SGR_PIXELS"):$===1048?1:$===47||$===1047||$===1049?z(_e===R):$===2004?z(M.bracketedPasteMode):0,Q.triggerDataEvent(`${_.C0.ESC}[${I?"":"?"}${oe};${L}$y`),!0;var oe,L}_updateAttrColor(k,I,M,B,V){return I===2?(k|=50331648,k&=-16777216,k|=p.AttributeData.fromColorRGB([M,B,V])):I===5&&(k&=-50331904,k|=33554432|255&M),k}_extractColor(k,I,M){const B=[0,0,-1,0,0,0];let V=0,Q=0;do{if(B[Q+V]=k.params[I+Q],k.hasSubParams(I+Q)){const ne=k.getSubParams(I+Q);let te=0;do B[1]===5&&(V=1),B[Q+te+1+V]=ne[te];while(++te<ne.length&&te+Q+1+V<B.length);break}if(B[1]===5&&Q+V>=2||B[1]===2&&Q+V>=5)break;B[1]&&(V=1)}while(++Q+I<k.length&&Q+V<B.length);for(let ne=2;ne<B.length;++ne)B[ne]===-1&&(B[ne]=0);switch(B[0]){case 38:M.fg=this._updateAttrColor(M.fg,B[1],B[3],B[4],B[5]);break;case 48:M.bg=this._updateAttrColor(M.bg,B[1],B[3],B[4],B[5]);break;case 58:M.extended=M.extended.clone(),M.extended.underlineColor=this._updateAttrColor(M.extended.underlineColor,B[1],B[3],B[4],B[5])}return Q}_processUnderline(k,I){I.extended=I.extended.clone(),(!~k||k>5)&&(k=1),I.extended.underlineStyle=k,I.fg|=268435456,k===0&&(I.fg&=-268435457),I.updateExtended()}_processSGR0(k){k.fg=n.DEFAULT_ATTR_DATA.fg,k.bg=n.DEFAULT_ATTR_DATA.bg,k.extended=k.extended.clone(),k.extended.underlineStyle=0,k.extended.underlineColor&=-67108864,k.updateExtended()}charAttributes(k){if(k.length===1&&k.params[0]===0)return this._processSGR0(this._curAttrData),!0;const I=k.length;let M;const B=this._curAttrData;for(let V=0;V<I;V++)M=k.params[V],M>=30&&M<=37?(B.fg&=-50331904,B.fg|=16777216|M-30):M>=40&&M<=47?(B.bg&=-50331904,B.bg|=16777216|M-40):M>=90&&M<=97?(B.fg&=-50331904,B.fg|=16777224|M-90):M>=100&&M<=107?(B.bg&=-50331904,B.bg|=16777224|M-100):M===0?this._processSGR0(B):M===1?B.fg|=134217728:M===3?B.bg|=67108864:M===4?(B.fg|=268435456,this._processUnderline(k.hasSubParams(V)?k.getSubParams(V)[0]:1,B)):M===5?B.fg|=536870912:M===7?B.fg|=67108864:M===8?B.fg|=1073741824:M===9?B.fg|=2147483648:M===2?B.bg|=134217728:M===21?this._processUnderline(2,B):M===22?(B.fg&=-134217729,B.bg&=-134217729):M===23?B.bg&=-67108865:M===24?(B.fg&=-268435457,this._processUnderline(0,B)):M===25?B.fg&=-536870913:M===27?B.fg&=-67108865:M===28?B.fg&=-1073741825:M===29?B.fg&=2147483647:M===39?(B.fg&=-67108864,B.fg|=16777215&n.DEFAULT_ATTR_DATA.fg):M===49?(B.bg&=-67108864,B.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):M===38||M===48||M===58?V+=this._extractColor(k,V,B):M===53?B.bg|=1073741824:M===55?B.bg&=-1073741825:M===59?(B.extended=B.extended.clone(),B.extended.underlineColor=-1,B.updateExtended()):M===100?(B.fg&=-67108864,B.fg|=16777215&n.DEFAULT_ATTR_DATA.fg,B.bg&=-67108864,B.bg|=16777215&n.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",M);return!0}deviceStatus(k){switch(k.params[0]){case 5:this._coreService.triggerDataEvent(`${_.C0.ESC}[0n`);break;case 6:const I=this._activeBuffer.y+1,M=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_.C0.ESC}[${I};${M}R`)}return!0}deviceStatusPrivate(k){if(k.params[0]===6){const I=this._activeBuffer.y+1,M=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_.C0.ESC}[?${I};${M}R`)}return!0}softReset(k){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(k){const I=k.params[0]||1;switch(I){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const M=I%2==1;return this._optionsService.options.cursorBlink=M,!0}setScrollRegion(k){const I=k.params[0]||1;let M;return(k.length<2||(M=k.params[1])>this._bufferService.rows||M===0)&&(M=this._bufferService.rows),M>I&&(this._activeBuffer.scrollTop=I-1,this._activeBuffer.scrollBottom=M-1,this._setCursor(0,0)),!0}windowOptions(k){if(!T(k.params[0],this._optionsService.rawOptions.windowOptions))return!0;const I=k.length>1?k.params[1]:0;switch(k.params[0]){case 14:I!==2&&this._onRequestWindowsOptionsReport.fire(D.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(D.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${_.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:I!==0&&I!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),I!==0&&I!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:I!==0&&I!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),I!==0&&I!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(k){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(k){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(k){return this._windowTitle=k,this._onTitleChange.fire(k),!0}setIconName(k){return this._iconName=k,!0}setOrReportIndexedColor(k){const I=[],M=k.split(";");for(;M.length>1;){const B=M.shift(),V=M.shift();if(/^\d+$/.exec(B)){const Q=parseInt(B);if(Z(Q))if(V==="?")I.push({type:0,index:Q});else{const ne=(0,m.parseColor)(V);ne&&I.push({type:1,index:Q,color:ne})}}}return I.length&&this._onColor.fire(I),!0}setHyperlink(k){const I=k.split(";");return!(I.length<2)&&(I[1]?this._createHyperlink(I[0],I[1]):!I[0]&&this._finishHyperlink())}_createHyperlink(k,I){this._getCurrentLinkId()&&this._finishHyperlink();const M=k.split(":");let B;const V=M.findIndex(Q=>Q.startsWith("id="));return V!==-1&&(B=M[V].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:B,uri:I}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(k,I){const M=k.split(";");for(let B=0;B<M.length&&!(I>=this._specialColors.length);++B,++I)if(M[B]==="?")this._onColor.fire([{type:0,index:this._specialColors[I]}]);else{const V=(0,m.parseColor)(M[B]);V&&this._onColor.fire([{type:1,index:this._specialColors[I],color:V}])}return!0}setOrReportFgColor(k){return this._setOrReportSpecialColor(k,0)}setOrReportBgColor(k){return this._setOrReportSpecialColor(k,1)}setOrReportCursorColor(k){return this._setOrReportSpecialColor(k,2)}restoreIndexedColor(k){if(!k)return this._onColor.fire([{type:2}]),!0;const I=[],M=k.split(";");for(let B=0;B<M.length;++B)if(/^\d+$/.exec(M[B])){const V=parseInt(M[B]);Z(V)&&I.push({type:2,index:V})}return I.length&&this._onColor.fire(I),!0}restoreFgColor(k){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(k){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(k){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,g.DEFAULT_CHARSET),!0}selectCharset(k){return k.length!==2?(this.selectDefaultCharset(),!0):(k[0]==="/"||this._charsetService.setgCharset(C[k[0]],g.CHARSETS[k[1]]||g.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const k=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,k,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=n.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=n.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(k){return this._charsetService.setgLevel(k),!0}screenAlignmentPattern(){const k=new c.CellData;k.content=4194304|"E".charCodeAt(0),k.fg=this._curAttrData.fg,k.bg=this._curAttrData.bg,this._setCursor(0,0);for(let I=0;I<this._bufferService.rows;++I){const M=this._activeBuffer.ybase+this._activeBuffer.y+I,B=this._activeBuffer.lines.get(M);B&&(B.fill(k),B.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(k,I){const M=this._bufferService.buffer,B=this._optionsService.rawOptions;return(V=>(this._coreService.triggerDataEvent(`${_.C0.ESC}${V}${_.C0.ESC}\\`),!0))(k==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:k==='"p'?'P1$r61;1"p':k==="r"?`P1$r${M.scrollTop+1};${M.scrollBottom+1}r`:k==="m"?"P1$r0m":k===" q"?`P1$r${{block:2,underline:4,bar:6}[B.cursorStyle]-(B.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(k,I){this._dirtyRowTracker.markRangeDirty(k,I)}}s.InputHandler=U;let j=class{constructor(N){this._bufferService=N,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(N){N<this.start?this.start=N:N>this.end&&(this.end=N)}markRangeDirty(N,k){N>k&&(O=N,N=k,k=O),N<this.start&&(this.start=N),k>this.end&&(this.end=k)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function Z(N){return 0<=N&&N<256}j=a([u(0,b.IBufferService)],j)},844:(v,s)=>{function l(a){for(const u of a)u.dispose();a.length=0}Object.defineProperty(s,"__esModule",{value:!0}),s.getDisposeArrayDisposable=s.disposeArray=s.toDisposable=s.MutableDisposable=s.Disposable=void 0,s.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const a of this._disposables)a.dispose();this._disposables.length=0}register(a){return this._disposables.push(a),a}unregister(a){const u=this._disposables.indexOf(a);u!==-1&&this._disposables.splice(u,1)}},s.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(a){var u;this._isDisposed||a===this._value||((u=this._value)===null||u===void 0||u.dispose(),this._value=a)}clear(){this.value=void 0}dispose(){var a;this._isDisposed=!0,(a=this._value)===null||a===void 0||a.dispose(),this._value=void 0}},s.toDisposable=function(a){return{dispose:a}},s.disposeArray=l,s.getDisposeArrayDisposable=function(a){return{dispose:()=>l(a)}}},1505:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.FourKeyMap=s.TwoKeyMap=void 0;class l{constructor(){this._data={}}set(u,_,g){this._data[u]||(this._data[u]={}),this._data[u][_]=g}get(u,_){return this._data[u]?this._data[u][_]:void 0}clear(){this._data={}}}s.TwoKeyMap=l,s.FourKeyMap=class{constructor(){this._data=new l}set(a,u,_,g,S){this._data.get(a,u)||this._data.set(a,u,new l),this._data.get(a,u).set(_,g,S)}get(a,u,_,g){var S;return(S=this._data.get(a,u))===null||S===void 0?void 0:S.get(_,g)}clear(){this._data.clear()}}},6114:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.isChromeOS=s.isLinux=s.isWindows=s.isIphone=s.isIpad=s.isMac=s.getSafariVersion=s.isSafari=s.isLegacyEdge=s.isFirefox=s.isNode=void 0,s.isNode=typeof navigator>"u";const l=s.isNode?"node":navigator.userAgent,a=s.isNode?"node":navigator.platform;s.isFirefox=l.includes("Firefox"),s.isLegacyEdge=l.includes("Edge"),s.isSafari=/^((?!chrome|android).)*safari/i.test(l),s.getSafariVersion=function(){if(!s.isSafari)return 0;const u=l.match(/Version\/(\d+)/);return u===null||u.length<2?0:parseInt(u[1])},s.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(a),s.isIpad=a==="iPad",s.isIphone=a==="iPhone",s.isWindows=["Windows","Win16","Win32","WinCE"].includes(a),s.isLinux=a.indexOf("Linux")>=0,s.isChromeOS=/\bCrOS\b/.test(l)},6106:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SortedList=void 0;let l=0;s.SortedList=class{constructor(a){this._getKey=a,this._array=[]}clear(){this._array.length=0}insert(a){this._array.length!==0?(l=this._search(this._getKey(a)),this._array.splice(l,0,a)):this._array.push(a)}delete(a){if(this._array.length===0)return!1;const u=this._getKey(a);if(u===void 0||(l=this._search(u),l===-1)||this._getKey(this._array[l])!==u)return!1;do if(this._array[l]===a)return this._array.splice(l,1),!0;while(++l<this._array.length&&this._getKey(this._array[l])===u);return!1}*getKeyIterator(a){if(this._array.length!==0&&(l=this._search(a),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===a))do yield this._array[l];while(++l<this._array.length&&this._getKey(this._array[l])===a)}forEachByKey(a,u){if(this._array.length!==0&&(l=this._search(a),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===a))do u(this._array[l]);while(++l<this._array.length&&this._getKey(this._array[l])===a)}values(){return[...this._array].values()}_search(a){let u=0,_=this._array.length-1;for(;_>=u;){let g=u+_>>1;const S=this._getKey(this._array[g]);if(S>a)_=g-1;else{if(!(S<a)){for(;g>0&&this._getKey(this._array[g-1])===a;)g--;return g}u=g+1}}return u}}},7226:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DebouncedIdleTask=s.IdleTaskQueue=s.PriorityTaskQueue=void 0;const a=l(6114);class u{constructor(){this._tasks=[],this._i=0}enqueue(S){this._tasks.push(S),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(S){this._idleCallback=void 0;let y=0,w=0,n=S.timeRemaining(),f=0;for(;this._i<this._tasks.length;){if(y=Date.now(),this._tasks[this._i]()||this._i++,y=Math.max(1,Date.now()-y),w=Math.max(y,w),f=S.timeRemaining(),1.5*w>f)return n-y<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(n-y))}ms`),void this._start();n=f}this.clear()}}class _ extends u{_requestCallback(S){return setTimeout(()=>S(this._createDeadline(16)))}_cancelCallback(S){clearTimeout(S)}_createDeadline(S){const y=Date.now()+S;return{timeRemaining:()=>Math.max(0,y-Date.now())}}}s.PriorityTaskQueue=_,s.IdleTaskQueue=!a.isNode&&"requestIdleCallback"in window?class extends u{_requestCallback(g){return requestIdleCallback(g)}_cancelCallback(g){cancelIdleCallback(g)}}:_,s.DebouncedIdleTask=class{constructor(){this._queue=new s.IdleTaskQueue}set(g){this._queue.clear(),this._queue.enqueue(g)}flush(){this._queue.flush()}}},9282:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.updateWindowsModeWrappedState=void 0;const a=l(643);s.updateWindowsModeWrappedState=function(u){const _=u.buffer.lines.get(u.buffer.ybase+u.buffer.y-1),g=_==null?void 0:_.get(u.cols-1),S=u.buffer.lines.get(u.buffer.ybase+u.buffer.y);S&&g&&(S.isWrapped=g[a.CHAR_DATA_CODE_INDEX]!==a.NULL_CELL_CODE&&g[a.CHAR_DATA_CODE_INDEX]!==a.WHITESPACE_CELL_CODE)}},3734:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ExtendedAttrs=s.AttributeData=void 0;class l{constructor(){this.fg=0,this.bg=0,this.extended=new a}static toColorRGB(_){return[_>>>16&255,_>>>8&255,255&_]}static fromColorRGB(_){return(255&_[0])<<16|(255&_[1])<<8|255&_[2]}clone(){const _=new l;return _.fg=this.fg,_.bg=this.bg,_.extended=this.extended.clone(),_}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}s.AttributeData=l;class a{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(_){this._ext=_}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(_){this._ext&=-469762049,this._ext|=_<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(_){this._ext&=-67108864,this._ext|=67108863&_}get urlId(){return this._urlId}set urlId(_){this._urlId=_}constructor(_=0,g=0){this._ext=0,this._urlId=0,this._ext=_,this._urlId=g}clone(){return new a(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}s.ExtendedAttrs=a},9092:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Buffer=s.MAX_BUFFER_SIZE=void 0;const a=l(6349),u=l(7226),_=l(3734),g=l(8437),S=l(4634),y=l(511),w=l(643),n=l(4863),f=l(7116);s.MAX_BUFFER_SIZE=4294967295,s.Buffer=class{constructor(h,c,p){this._hasScrollback=h,this._optionsService=c,this._bufferService=p,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=g.DEFAULT_ATTR_DATA.clone(),this.savedCharset=f.DEFAULT_CHARSET,this.markers=[],this._nullCell=y.CellData.fromCharData([0,w.NULL_CELL_CHAR,w.NULL_CELL_WIDTH,w.NULL_CELL_CODE]),this._whitespaceCell=y.CellData.fromCharData([0,w.WHITESPACE_CELL_CHAR,w.WHITESPACE_CELL_WIDTH,w.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new u.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new a.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(h){return h?(this._nullCell.fg=h.fg,this._nullCell.bg=h.bg,this._nullCell.extended=h.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new _.ExtendedAttrs),this._nullCell}getWhitespaceCell(h){return h?(this._whitespaceCell.fg=h.fg,this._whitespaceCell.bg=h.bg,this._whitespaceCell.extended=h.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new _.ExtendedAttrs),this._whitespaceCell}getBlankLine(h,c){return new g.BufferLine(this._bufferService.cols,this.getNullCell(h),c)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const h=this.ybase+this.y-this.ydisp;return h>=0&&h<this._rows}_getCorrectBufferLength(h){if(!this._hasScrollback)return h;const c=h+this._optionsService.rawOptions.scrollback;return c>s.MAX_BUFFER_SIZE?s.MAX_BUFFER_SIZE:c}fillViewportRows(h){if(this.lines.length===0){h===void 0&&(h=g.DEFAULT_ATTR_DATA);let c=this._rows;for(;c--;)this.lines.push(this.getBlankLine(h))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new a.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(h,c){const p=this.getNullCell(g.DEFAULT_ATTR_DATA);let b=0;const E=this._getCorrectBufferLength(c);if(E>this.lines.maxLength&&(this.lines.maxLength=E),this.lines.length>0){if(this._cols<h)for(let m=0;m<this.lines.length;m++)b+=+this.lines.get(m).resize(h,p);let x=0;if(this._rows<c)for(let m=this._rows;m<c;m++)this.lines.length<c+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new g.BufferLine(h,p)):this.ybase>0&&this.lines.length<=this.ybase+this.y+x+1?(this.ybase--,x++,this.ydisp>0&&this.ydisp--):this.lines.push(new g.BufferLine(h,p)));else for(let m=this._rows;m>c;m--)this.lines.length>c+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(E<this.lines.maxLength){const m=this.lines.length-E;m>0&&(this.lines.trimStart(m),this.ybase=Math.max(this.ybase-m,0),this.ydisp=Math.max(this.ydisp-m,0),this.savedY=Math.max(this.savedY-m,0)),this.lines.maxLength=E}this.x=Math.min(this.x,h-1),this.y=Math.min(this.y,c-1),x&&(this.y+=x),this.savedX=Math.min(this.savedX,h-1),this.scrollTop=0}if(this.scrollBottom=c-1,this._isReflowEnabled&&(this._reflow(h,c),this._cols>h))for(let x=0;x<this.lines.length;x++)b+=+this.lines.get(x).resize(h,p);this._cols=h,this._rows=c,this._memoryCleanupQueue.clear(),b>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let h=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,h=!1);let c=0;for(;this._memoryCleanupPosition<this.lines.length;)if(c+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),c>100)return!0;return h}get _isReflowEnabled(){const h=this._optionsService.rawOptions.windowsPty;return h&&h.buildNumber?this._hasScrollback&&h.backend==="conpty"&&h.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(h,c){this._cols!==h&&(h>this._cols?this._reflowLarger(h,c):this._reflowSmaller(h,c))}_reflowLarger(h,c){const p=(0,S.reflowLargerGetLinesToRemove)(this.lines,this._cols,h,this.ybase+this.y,this.getNullCell(g.DEFAULT_ATTR_DATA));if(p.length>0){const b=(0,S.reflowLargerCreateNewLayout)(this.lines,p);(0,S.reflowLargerApplyNewLayout)(this.lines,b.layout),this._reflowLargerAdjustViewport(h,c,b.countRemoved)}}_reflowLargerAdjustViewport(h,c,p){const b=this.getNullCell(g.DEFAULT_ATTR_DATA);let E=p;for(;E-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<c&&this.lines.push(new g.BufferLine(h,b))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-p,0)}_reflowSmaller(h,c){const p=this.getNullCell(g.DEFAULT_ATTR_DATA),b=[];let E=0;for(let x=this.lines.length-1;x>=0;x--){let m=this.lines.get(x);if(!m||!m.isWrapped&&m.getTrimmedLength()<=h)continue;const C=[m];for(;m.isWrapped&&x>0;)m=this.lines.get(--x),C.unshift(m);const A=this.ybase+this.y;if(A>=x&&A<x+C.length)continue;const T=C[C.length-1].getTrimmedLength(),D=(0,S.reflowSmallerGetNewLineLengths)(C,this._cols,h),O=D.length-C.length;let U;U=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+O):Math.max(0,this.lines.length-this.lines.maxLength+O);const j=[];for(let B=0;B<O;B++){const V=this.getBlankLine(g.DEFAULT_ATTR_DATA,!0);j.push(V)}j.length>0&&(b.push({start:x+C.length+E,newLines:j}),E+=j.length),C.push(...j);let Z=D.length-1,N=D[Z];N===0&&(Z--,N=D[Z]);let k=C.length-O-1,I=T;for(;k>=0;){const B=Math.min(I,N);if(C[Z]===void 0)break;if(C[Z].copyCellsFrom(C[k],I-B,N-B,B,!0),N-=B,N===0&&(Z--,N=D[Z]),I-=B,I===0){k--;const V=Math.max(k,0);I=(0,S.getWrappedLineTrimmedLength)(C,V,this._cols)}}for(let B=0;B<C.length;B++)D[B]<h&&C[B].setCell(D[B],p);let M=O-U;for(;M-- >0;)this.ybase===0?this.y<c-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+E)-c&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+O,this.ybase+c-1)}if(b.length>0){const x=[],m=[];for(let Z=0;Z<this.lines.length;Z++)m.push(this.lines.get(Z));const C=this.lines.length;let A=C-1,T=0,D=b[T];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+E);let O=0;for(let Z=Math.min(this.lines.maxLength-1,C+E-1);Z>=0;Z--)if(D&&D.start>A+O){for(let N=D.newLines.length-1;N>=0;N--)this.lines.set(Z--,D.newLines[N]);Z++,x.push({index:A+1,amount:D.newLines.length}),O+=D.newLines.length,D=b[++T]}else this.lines.set(Z,m[A--]);let U=0;for(let Z=x.length-1;Z>=0;Z--)x[Z].index+=U,this.lines.onInsertEmitter.fire(x[Z]),U+=x[Z].amount;const j=Math.max(0,C+E-this.lines.maxLength);j>0&&this.lines.onTrimEmitter.fire(j)}}translateBufferLineToString(h,c,p=0,b){const E=this.lines.get(h);return E?E.translateToString(c,p,b):""}getWrappedRangeForLine(h){let c=h,p=h;for(;c>0&&this.lines.get(c).isWrapped;)c--;for(;p+1<this.lines.length&&this.lines.get(p+1).isWrapped;)p++;return{first:c,last:p}}setupTabStops(h){for(h!=null?this.tabs[h]||(h=this.prevStop(h)):(this.tabs={},h=0);h<this._cols;h+=this._optionsService.rawOptions.tabStopWidth)this.tabs[h]=!0}prevStop(h){for(h==null&&(h=this.x);!this.tabs[--h]&&h>0;);return h>=this._cols?this._cols-1:h<0?0:h}nextStop(h){for(h==null&&(h=this.x);!this.tabs[++h]&&h<this._cols;);return h>=this._cols?this._cols-1:h<0?0:h}clearMarkers(h){this._isClearing=!0;for(let c=0;c<this.markers.length;c++)this.markers[c].line===h&&(this.markers[c].dispose(),this.markers.splice(c--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let h=0;h<this.markers.length;h++)this.markers[h].dispose(),this.markers.splice(h--,1);this._isClearing=!1}addMarker(h){const c=new n.Marker(h);return this.markers.push(c),c.register(this.lines.onTrim(p=>{c.line-=p,c.line<0&&c.dispose()})),c.register(this.lines.onInsert(p=>{c.line>=p.index&&(c.line+=p.amount)})),c.register(this.lines.onDelete(p=>{c.line>=p.index&&c.line<p.index+p.amount&&c.dispose(),c.line>p.index&&(c.line-=p.amount)})),c.register(c.onDispose(()=>this._removeMarker(c))),c}_removeMarker(h){this._isClearing||this.markers.splice(this.markers.indexOf(h),1)}}},8437:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLine=s.DEFAULT_ATTR_DATA=void 0;const a=l(3734),u=l(511),_=l(643),g=l(482);s.DEFAULT_ATTR_DATA=Object.freeze(new a.AttributeData);let S=0;class y{constructor(n,f,h=!1){this.isWrapped=h,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*n);const c=f||u.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]);for(let p=0;p<n;++p)this.setCell(p,c);this.length=n}get(n){const f=this._data[3*n+0],h=2097151&f;return[this._data[3*n+1],2097152&f?this._combined[n]:h?(0,g.stringFromCodePoint)(h):"",f>>22,2097152&f?this._combined[n].charCodeAt(this._combined[n].length-1):h]}set(n,f){this._data[3*n+1]=f[_.CHAR_DATA_ATTR_INDEX],f[_.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[n]=f[1],this._data[3*n+0]=2097152|n|f[_.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*n+0]=f[_.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|f[_.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(n){return this._data[3*n+0]>>22}hasWidth(n){return 12582912&this._data[3*n+0]}getFg(n){return this._data[3*n+1]}getBg(n){return this._data[3*n+2]}hasContent(n){return 4194303&this._data[3*n+0]}getCodePoint(n){const f=this._data[3*n+0];return 2097152&f?this._combined[n].charCodeAt(this._combined[n].length-1):2097151&f}isCombined(n){return 2097152&this._data[3*n+0]}getString(n){const f=this._data[3*n+0];return 2097152&f?this._combined[n]:2097151&f?(0,g.stringFromCodePoint)(2097151&f):""}isProtected(n){return 536870912&this._data[3*n+2]}loadCell(n,f){return S=3*n,f.content=this._data[S+0],f.fg=this._data[S+1],f.bg=this._data[S+2],2097152&f.content&&(f.combinedData=this._combined[n]),268435456&f.bg&&(f.extended=this._extendedAttrs[n]),f}setCell(n,f){2097152&f.content&&(this._combined[n]=f.combinedData),268435456&f.bg&&(this._extendedAttrs[n]=f.extended),this._data[3*n+0]=f.content,this._data[3*n+1]=f.fg,this._data[3*n+2]=f.bg}setCellFromCodePoint(n,f,h,c,p,b){268435456&p&&(this._extendedAttrs[n]=b),this._data[3*n+0]=f|h<<22,this._data[3*n+1]=c,this._data[3*n+2]=p}addCodepointToCell(n,f){let h=this._data[3*n+0];2097152&h?this._combined[n]+=(0,g.stringFromCodePoint)(f):(2097151&h?(this._combined[n]=(0,g.stringFromCodePoint)(2097151&h)+(0,g.stringFromCodePoint)(f),h&=-2097152,h|=2097152):h=f|4194304,this._data[3*n+0]=h)}insertCells(n,f,h,c){if((n%=this.length)&&this.getWidth(n-1)===2&&this.setCellFromCodePoint(n-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new a.ExtendedAttrs),f<this.length-n){const p=new u.CellData;for(let b=this.length-n-f-1;b>=0;--b)this.setCell(n+f+b,this.loadCell(n+b,p));for(let b=0;b<f;++b)this.setCell(n+b,h)}else for(let p=n;p<this.length;++p)this.setCell(p,h);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new a.ExtendedAttrs)}deleteCells(n,f,h,c){if(n%=this.length,f<this.length-n){const p=new u.CellData;for(let b=0;b<this.length-n-f;++b)this.setCell(n+b,this.loadCell(n+f+b,p));for(let b=this.length-f;b<this.length;++b)this.setCell(b,h)}else for(let p=n;p<this.length;++p)this.setCell(p,h);n&&this.getWidth(n-1)===2&&this.setCellFromCodePoint(n-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new a.ExtendedAttrs),this.getWidth(n)!==0||this.hasContent(n)||this.setCellFromCodePoint(n,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new a.ExtendedAttrs)}replaceCells(n,f,h,c,p=!1){if(p)for(n&&this.getWidth(n-1)===2&&!this.isProtected(n-1)&&this.setCellFromCodePoint(n-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new a.ExtendedAttrs),f<this.length&&this.getWidth(f-1)===2&&!this.isProtected(f)&&this.setCellFromCodePoint(f,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new a.ExtendedAttrs);n<f&&n<this.length;)this.isProtected(n)||this.setCell(n,h),n++;else for(n&&this.getWidth(n-1)===2&&this.setCellFromCodePoint(n-1,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new a.ExtendedAttrs),f<this.length&&this.getWidth(f-1)===2&&this.setCellFromCodePoint(f,0,1,(c==null?void 0:c.fg)||0,(c==null?void 0:c.bg)||0,(c==null?void 0:c.extended)||new a.ExtendedAttrs);n<f&&n<this.length;)this.setCell(n++,h)}resize(n,f){if(n===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const h=3*n;if(n>this.length){if(this._data.buffer.byteLength>=4*h)this._data=new Uint32Array(this._data.buffer,0,h);else{const c=new Uint32Array(h);c.set(this._data),this._data=c}for(let c=this.length;c<n;++c)this.setCell(c,f)}else{this._data=this._data.subarray(0,h);const c=Object.keys(this._combined);for(let b=0;b<c.length;b++){const E=parseInt(c[b],10);E>=n&&delete this._combined[E]}const p=Object.keys(this._extendedAttrs);for(let b=0;b<p.length;b++){const E=parseInt(p[b],10);E>=n&&delete this._extendedAttrs[E]}}return this.length=n,4*h*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const n=new Uint32Array(this._data.length);return n.set(this._data),this._data=n,1}return 0}fill(n,f=!1){if(f)for(let h=0;h<this.length;++h)this.isProtected(h)||this.setCell(h,n);else{this._combined={},this._extendedAttrs={};for(let h=0;h<this.length;++h)this.setCell(h,n)}}copyFrom(n){this.length!==n.length?this._data=new Uint32Array(n._data):this._data.set(n._data),this.length=n.length,this._combined={};for(const f in n._combined)this._combined[f]=n._combined[f];this._extendedAttrs={};for(const f in n._extendedAttrs)this._extendedAttrs[f]=n._extendedAttrs[f];this.isWrapped=n.isWrapped}clone(){const n=new y(0);n._data=new Uint32Array(this._data),n.length=this.length;for(const f in this._combined)n._combined[f]=this._combined[f];for(const f in this._extendedAttrs)n._extendedAttrs[f]=this._extendedAttrs[f];return n.isWrapped=this.isWrapped,n}getTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0])return n+(this._data[3*n+0]>>22);return 0}getNoBgTrimmedLength(){for(let n=this.length-1;n>=0;--n)if(4194303&this._data[3*n+0]||50331648&this._data[3*n+2])return n+(this._data[3*n+0]>>22);return 0}copyCellsFrom(n,f,h,c,p){const b=n._data;if(p)for(let x=c-1;x>=0;x--){for(let m=0;m<3;m++)this._data[3*(h+x)+m]=b[3*(f+x)+m];268435456&b[3*(f+x)+2]&&(this._extendedAttrs[h+x]=n._extendedAttrs[f+x])}else for(let x=0;x<c;x++){for(let m=0;m<3;m++)this._data[3*(h+x)+m]=b[3*(f+x)+m];268435456&b[3*(f+x)+2]&&(this._extendedAttrs[h+x]=n._extendedAttrs[f+x])}const E=Object.keys(n._combined);for(let x=0;x<E.length;x++){const m=parseInt(E[x],10);m>=f&&(this._combined[m-f+h]=n._combined[m])}}translateToString(n=!1,f=0,h=this.length){n&&(h=Math.min(h,this.getTrimmedLength()));let c="";for(;f<h;){const p=this._data[3*f+0],b=2097151&p;c+=2097152&p?this._combined[f]:b?(0,g.stringFromCodePoint)(b):_.WHITESPACE_CELL_CHAR,f+=p>>22||1}return c}}s.BufferLine=y},4841:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getRangeLength=void 0,s.getRangeLength=function(l,a){if(l.start.y>l.end.y)throw new Error(`Buffer range end (${l.end.x}, ${l.end.y}) cannot be before start (${l.start.x}, ${l.start.y})`);return a*(l.end.y-l.start.y)+(l.end.x-l.start.x+1)}},4634:(v,s)=>{function l(a,u,_){if(u===a.length-1)return a[u].getTrimmedLength();const g=!a[u].hasContent(_-1)&&a[u].getWidth(_-1)===1,S=a[u+1].getWidth(0)===2;return g&&S?_-1:_}Object.defineProperty(s,"__esModule",{value:!0}),s.getWrappedLineTrimmedLength=s.reflowSmallerGetNewLineLengths=s.reflowLargerApplyNewLayout=s.reflowLargerCreateNewLayout=s.reflowLargerGetLinesToRemove=void 0,s.reflowLargerGetLinesToRemove=function(a,u,_,g,S){const y=[];for(let w=0;w<a.length-1;w++){let n=w,f=a.get(++n);if(!f.isWrapped)continue;const h=[a.get(w)];for(;n<a.length&&f.isWrapped;)h.push(f),f=a.get(++n);if(g>=w&&g<n){w+=h.length-1;continue}let c=0,p=l(h,c,u),b=1,E=0;for(;b<h.length;){const m=l(h,b,u),C=m-E,A=_-p,T=Math.min(C,A);h[c].copyCellsFrom(h[b],E,p,T,!1),p+=T,p===_&&(c++,p=0),E+=T,E===m&&(b++,E=0),p===0&&c!==0&&h[c-1].getWidth(_-1)===2&&(h[c].copyCellsFrom(h[c-1],_-1,p++,1,!1),h[c-1].setCell(_-1,S))}h[c].replaceCells(p,_,S);let x=0;for(let m=h.length-1;m>0&&(m>c||h[m].getTrimmedLength()===0);m--)x++;x>0&&(y.push(w+h.length-x),y.push(x)),w+=h.length-1}return y},s.reflowLargerCreateNewLayout=function(a,u){const _=[];let g=0,S=u[g],y=0;for(let w=0;w<a.length;w++)if(S===w){const n=u[++g];a.onDeleteEmitter.fire({index:w-y,amount:n}),w+=n-1,y+=n,S=u[++g]}else _.push(w);return{layout:_,countRemoved:y}},s.reflowLargerApplyNewLayout=function(a,u){const _=[];for(let g=0;g<u.length;g++)_.push(a.get(u[g]));for(let g=0;g<_.length;g++)a.set(g,_[g]);a.length=u.length},s.reflowSmallerGetNewLineLengths=function(a,u,_){const g=[],S=a.map((f,h)=>l(a,h,u)).reduce((f,h)=>f+h);let y=0,w=0,n=0;for(;n<S;){if(S-n<_){g.push(S-n);break}y+=_;const f=l(a,w,u);y>f&&(y-=f,w++);const h=a[w].getWidth(y-1)===2;h&&y--;const c=h?_-1:_;g.push(c),n+=c}return g},s.getWrappedLineTrimmedLength=l},5295:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferSet=void 0;const a=l(8460),u=l(844),_=l(9092);class g extends u.Disposable{constructor(y,w){super(),this._optionsService=y,this._bufferService=w,this._onBufferActivate=this.register(new a.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new _.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new _.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(y){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(y),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(y,w){this._normal.resize(y,w),this._alt.resize(y,w),this.setupTabStops(y)}setupTabStops(y){this._normal.setupTabStops(y),this._alt.setupTabStops(y)}}s.BufferSet=g},511:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CellData=void 0;const a=l(482),u=l(643),_=l(3734);class g extends _.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new _.ExtendedAttrs,this.combinedData=""}static fromCharData(y){const w=new g;return w.setFromCharData(y),w}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,a.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(y){this.fg=y[u.CHAR_DATA_ATTR_INDEX],this.bg=0;let w=!1;if(y[u.CHAR_DATA_CHAR_INDEX].length>2)w=!0;else if(y[u.CHAR_DATA_CHAR_INDEX].length===2){const n=y[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=n&&n<=56319){const f=y[u.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=f&&f<=57343?this.content=1024*(n-55296)+f-56320+65536|y[u.CHAR_DATA_WIDTH_INDEX]<<22:w=!0}else w=!0}else this.content=y[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|y[u.CHAR_DATA_WIDTH_INDEX]<<22;w&&(this.combinedData=y[u.CHAR_DATA_CHAR_INDEX],this.content=2097152|y[u.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}s.CellData=g},643:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WHITESPACE_CELL_CODE=s.WHITESPACE_CELL_WIDTH=s.WHITESPACE_CELL_CHAR=s.NULL_CELL_CODE=s.NULL_CELL_WIDTH=s.NULL_CELL_CHAR=s.CHAR_DATA_CODE_INDEX=s.CHAR_DATA_WIDTH_INDEX=s.CHAR_DATA_CHAR_INDEX=s.CHAR_DATA_ATTR_INDEX=s.DEFAULT_EXT=s.DEFAULT_ATTR=s.DEFAULT_COLOR=void 0,s.DEFAULT_COLOR=0,s.DEFAULT_ATTR=256|s.DEFAULT_COLOR<<9,s.DEFAULT_EXT=0,s.CHAR_DATA_ATTR_INDEX=0,s.CHAR_DATA_CHAR_INDEX=1,s.CHAR_DATA_WIDTH_INDEX=2,s.CHAR_DATA_CODE_INDEX=3,s.NULL_CELL_CHAR="",s.NULL_CELL_WIDTH=1,s.NULL_CELL_CODE=0,s.WHITESPACE_CELL_CHAR=" ",s.WHITESPACE_CELL_WIDTH=1,s.WHITESPACE_CELL_CODE=32},4863:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Marker=void 0;const a=l(8460),u=l(844);class _{get id(){return this._id}constructor(S){this.line=S,this.isDisposed=!1,this._disposables=[],this._id=_._nextId++,this._onDispose=this.register(new a.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,u.disposeArray)(this._disposables),this._disposables.length=0)}register(S){return this._disposables.push(S),S}}s.Marker=_,_._nextId=1},7116:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_CHARSET=s.CHARSETS=void 0,s.CHARSETS={},s.DEFAULT_CHARSET=s.CHARSETS.B,s.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},s.CHARSETS.A={"#":""},s.CHARSETS.B=void 0,s.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},s.CHARSETS.C=s.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},s.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},s.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.E=s.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},s.CHARSETS.H=s.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},s.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(v,s)=>{var l,a,u;Object.defineProperty(s,"__esModule",{value:!0}),s.C1_ESCAPED=s.C1=s.C0=void 0,function(_){_.NUL="\0",_.SOH="",_.STX="",_.ETX="",_.EOT="",_.ENQ="",_.ACK="",_.BEL="\x07",_.BS="\b",_.HT="	",_.LF=`
`,_.VT="\v",_.FF="\f",_.CR="\r",_.SO="",_.SI="",_.DLE="",_.DC1="",_.DC2="",_.DC3="",_.DC4="",_.NAK="",_.SYN="",_.ETB="",_.CAN="",_.EM="",_.SUB="",_.ESC="\x1B",_.FS="",_.GS="",_.RS="",_.US="",_.SP=" ",_.DEL=""}(l||(s.C0=l={})),function(_){_.PAD="",_.HOP="",_.BPH="",_.NBH="",_.IND="",_.NEL="",_.SSA="",_.ESA="",_.HTS="",_.HTJ="",_.VTS="",_.PLD="",_.PLU="",_.RI="",_.SS2="",_.SS3="",_.DCS="",_.PU1="",_.PU2="",_.STS="",_.CCH="",_.MW="",_.SPA="",_.EPA="",_.SOS="",_.SGCI="",_.SCI="",_.CSI="",_.ST="",_.OSC="",_.PM="",_.APC=""}(a||(s.C1=a={})),function(_){_.ST=`${l.ESC}\\`}(u||(s.C1_ESCAPED=u={}))},7399:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.evaluateKeyboardEvent=void 0;const a=l(2584),u={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};s.evaluateKeyboardEvent=function(_,g,S,y){const w={type:0,cancel:!1,key:void 0},n=(_.shiftKey?1:0)|(_.altKey?2:0)|(_.ctrlKey?4:0)|(_.metaKey?8:0);switch(_.keyCode){case 0:_.key==="UIKeyInputUpArrow"?w.key=g?a.C0.ESC+"OA":a.C0.ESC+"[A":_.key==="UIKeyInputLeftArrow"?w.key=g?a.C0.ESC+"OD":a.C0.ESC+"[D":_.key==="UIKeyInputRightArrow"?w.key=g?a.C0.ESC+"OC":a.C0.ESC+"[C":_.key==="UIKeyInputDownArrow"&&(w.key=g?a.C0.ESC+"OB":a.C0.ESC+"[B");break;case 8:if(_.altKey){w.key=a.C0.ESC+a.C0.DEL;break}w.key=a.C0.DEL;break;case 9:if(_.shiftKey){w.key=a.C0.ESC+"[Z";break}w.key=a.C0.HT,w.cancel=!0;break;case 13:w.key=_.altKey?a.C0.ESC+a.C0.CR:a.C0.CR,w.cancel=!0;break;case 27:w.key=a.C0.ESC,_.altKey&&(w.key=a.C0.ESC+a.C0.ESC),w.cancel=!0;break;case 37:if(_.metaKey)break;n?(w.key=a.C0.ESC+"[1;"+(n+1)+"D",w.key===a.C0.ESC+"[1;3D"&&(w.key=a.C0.ESC+(S?"b":"[1;5D"))):w.key=g?a.C0.ESC+"OD":a.C0.ESC+"[D";break;case 39:if(_.metaKey)break;n?(w.key=a.C0.ESC+"[1;"+(n+1)+"C",w.key===a.C0.ESC+"[1;3C"&&(w.key=a.C0.ESC+(S?"f":"[1;5C"))):w.key=g?a.C0.ESC+"OC":a.C0.ESC+"[C";break;case 38:if(_.metaKey)break;n?(w.key=a.C0.ESC+"[1;"+(n+1)+"A",S||w.key!==a.C0.ESC+"[1;3A"||(w.key=a.C0.ESC+"[1;5A")):w.key=g?a.C0.ESC+"OA":a.C0.ESC+"[A";break;case 40:if(_.metaKey)break;n?(w.key=a.C0.ESC+"[1;"+(n+1)+"B",S||w.key!==a.C0.ESC+"[1;3B"||(w.key=a.C0.ESC+"[1;5B")):w.key=g?a.C0.ESC+"OB":a.C0.ESC+"[B";break;case 45:_.shiftKey||_.ctrlKey||(w.key=a.C0.ESC+"[2~");break;case 46:w.key=n?a.C0.ESC+"[3;"+(n+1)+"~":a.C0.ESC+"[3~";break;case 36:w.key=n?a.C0.ESC+"[1;"+(n+1)+"H":g?a.C0.ESC+"OH":a.C0.ESC+"[H";break;case 35:w.key=n?a.C0.ESC+"[1;"+(n+1)+"F":g?a.C0.ESC+"OF":a.C0.ESC+"[F";break;case 33:_.shiftKey?w.type=2:_.ctrlKey?w.key=a.C0.ESC+"[5;"+(n+1)+"~":w.key=a.C0.ESC+"[5~";break;case 34:_.shiftKey?w.type=3:_.ctrlKey?w.key=a.C0.ESC+"[6;"+(n+1)+"~":w.key=a.C0.ESC+"[6~";break;case 112:w.key=n?a.C0.ESC+"[1;"+(n+1)+"P":a.C0.ESC+"OP";break;case 113:w.key=n?a.C0.ESC+"[1;"+(n+1)+"Q":a.C0.ESC+"OQ";break;case 114:w.key=n?a.C0.ESC+"[1;"+(n+1)+"R":a.C0.ESC+"OR";break;case 115:w.key=n?a.C0.ESC+"[1;"+(n+1)+"S":a.C0.ESC+"OS";break;case 116:w.key=n?a.C0.ESC+"[15;"+(n+1)+"~":a.C0.ESC+"[15~";break;case 117:w.key=n?a.C0.ESC+"[17;"+(n+1)+"~":a.C0.ESC+"[17~";break;case 118:w.key=n?a.C0.ESC+"[18;"+(n+1)+"~":a.C0.ESC+"[18~";break;case 119:w.key=n?a.C0.ESC+"[19;"+(n+1)+"~":a.C0.ESC+"[19~";break;case 120:w.key=n?a.C0.ESC+"[20;"+(n+1)+"~":a.C0.ESC+"[20~";break;case 121:w.key=n?a.C0.ESC+"[21;"+(n+1)+"~":a.C0.ESC+"[21~";break;case 122:w.key=n?a.C0.ESC+"[23;"+(n+1)+"~":a.C0.ESC+"[23~";break;case 123:w.key=n?a.C0.ESC+"[24;"+(n+1)+"~":a.C0.ESC+"[24~";break;default:if(!_.ctrlKey||_.shiftKey||_.altKey||_.metaKey)if(S&&!y||!_.altKey||_.metaKey)!S||_.altKey||_.ctrlKey||_.shiftKey||!_.metaKey?_.key&&!_.ctrlKey&&!_.altKey&&!_.metaKey&&_.keyCode>=48&&_.key.length===1?w.key=_.key:_.key&&_.ctrlKey&&(_.key==="_"&&(w.key=a.C0.US),_.key==="@"&&(w.key=a.C0.NUL)):_.keyCode===65&&(w.type=1);else{const f=u[_.keyCode],h=f==null?void 0:f[_.shiftKey?1:0];if(h)w.key=a.C0.ESC+h;else if(_.keyCode>=65&&_.keyCode<=90){const c=_.ctrlKey?_.keyCode-64:_.keyCode+32;let p=String.fromCharCode(c);_.shiftKey&&(p=p.toUpperCase()),w.key=a.C0.ESC+p}else if(_.keyCode===32)w.key=a.C0.ESC+(_.ctrlKey?a.C0.NUL:" ");else if(_.key==="Dead"&&_.code.startsWith("Key")){let c=_.code.slice(3,4);_.shiftKey||(c=c.toLowerCase()),w.key=a.C0.ESC+c,w.cancel=!0}}else _.keyCode>=65&&_.keyCode<=90?w.key=String.fromCharCode(_.keyCode-64):_.keyCode===32?w.key=a.C0.NUL:_.keyCode>=51&&_.keyCode<=55?w.key=String.fromCharCode(_.keyCode-51+27):_.keyCode===56?w.key=a.C0.DEL:_.keyCode===219?w.key=a.C0.ESC:_.keyCode===220?w.key=a.C0.FS:_.keyCode===221&&(w.key=a.C0.GS)}return w}},482:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Utf8ToUtf32=s.StringToUtf32=s.utf32ToString=s.stringFromCodePoint=void 0,s.stringFromCodePoint=function(l){return l>65535?(l-=65536,String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):String.fromCharCode(l)},s.utf32ToString=function(l,a=0,u=l.length){let _="";for(let g=a;g<u;++g){let S=l[g];S>65535?(S-=65536,_+=String.fromCharCode(55296+(S>>10))+String.fromCharCode(S%1024+56320)):_+=String.fromCharCode(S)}return _},s.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(l,a){const u=l.length;if(!u)return 0;let _=0,g=0;if(this._interim){const S=l.charCodeAt(g++);56320<=S&&S<=57343?a[_++]=1024*(this._interim-55296)+S-56320+65536:(a[_++]=this._interim,a[_++]=S),this._interim=0}for(let S=g;S<u;++S){const y=l.charCodeAt(S);if(55296<=y&&y<=56319){if(++S>=u)return this._interim=y,_;const w=l.charCodeAt(S);56320<=w&&w<=57343?a[_++]=1024*(y-55296)+w-56320+65536:(a[_++]=y,a[_++]=w)}else y!==65279&&(a[_++]=y)}return _}},s.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(l,a){const u=l.length;if(!u)return 0;let _,g,S,y,w=0,n=0,f=0;if(this.interim[0]){let p=!1,b=this.interim[0];b&=(224&b)==192?31:(240&b)==224?15:7;let E,x=0;for(;(E=63&this.interim[++x])&&x<4;)b<<=6,b|=E;const m=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,C=m-x;for(;f<C;){if(f>=u)return 0;if(E=l[f++],(192&E)!=128){f--,p=!0;break}this.interim[x++]=E,b<<=6,b|=63&E}p||(m===2?b<128?f--:a[w++]=b:m===3?b<2048||b>=55296&&b<=57343||b===65279||(a[w++]=b):b<65536||b>1114111||(a[w++]=b)),this.interim.fill(0)}const h=u-4;let c=f;for(;c<u;){for(;!(!(c<h)||128&(_=l[c])||128&(g=l[c+1])||128&(S=l[c+2])||128&(y=l[c+3]));)a[w++]=_,a[w++]=g,a[w++]=S,a[w++]=y,c+=4;if(_=l[c++],_<128)a[w++]=_;else if((224&_)==192){if(c>=u)return this.interim[0]=_,w;if(g=l[c++],(192&g)!=128){c--;continue}if(n=(31&_)<<6|63&g,n<128){c--;continue}a[w++]=n}else if((240&_)==224){if(c>=u)return this.interim[0]=_,w;if(g=l[c++],(192&g)!=128){c--;continue}if(c>=u)return this.interim[0]=_,this.interim[1]=g,w;if(S=l[c++],(192&S)!=128){c--;continue}if(n=(15&_)<<12|(63&g)<<6|63&S,n<2048||n>=55296&&n<=57343||n===65279)continue;a[w++]=n}else if((248&_)==240){if(c>=u)return this.interim[0]=_,w;if(g=l[c++],(192&g)!=128){c--;continue}if(c>=u)return this.interim[0]=_,this.interim[1]=g,w;if(S=l[c++],(192&S)!=128){c--;continue}if(c>=u)return this.interim[0]=_,this.interim[1]=g,this.interim[2]=S,w;if(y=l[c++],(192&y)!=128){c--;continue}if(n=(7&_)<<18|(63&g)<<12|(63&S)<<6|63&y,n<65536||n>1114111)continue;a[w++]=n}}return w}}},225:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeV6=void 0;const l=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],a=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let u;s.UnicodeV6=class{constructor(){if(this.version="6",!u){u=new Uint8Array(65536),u.fill(1),u[0]=0,u.fill(0,1,32),u.fill(0,127,160),u.fill(2,4352,4448),u[9001]=2,u[9002]=2,u.fill(2,11904,42192),u[12351]=1,u.fill(2,44032,55204),u.fill(2,63744,64256),u.fill(2,65040,65050),u.fill(2,65072,65136),u.fill(2,65280,65377),u.fill(2,65504,65511);for(let _=0;_<l.length;++_)u.fill(0,l[_][0],l[_][1]+1)}}wcwidth(_){return _<32?0:_<127?1:_<65536?u[_]:function(g,S){let y,w=0,n=S.length-1;if(g<S[0][0]||g>S[n][1])return!1;for(;n>=w;)if(y=w+n>>1,g>S[y][1])w=y+1;else{if(!(g<S[y][0]))return!0;n=y-1}return!1}(_,a)?0:_>=131072&&_<=196605||_>=196608&&_<=262141?2:1}}},5981:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.WriteBuffer=void 0;const a=l(8460),u=l(844);class _ extends u.Disposable{constructor(S){super(),this._action=S,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new a.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(S,y){if(y!==void 0&&this._syncCalls>y)return void(this._syncCalls=0);if(this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let w;for(this._isSyncWriting=!0;w=this._writeBuffer.shift();){this._action(w);const n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(S,y){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(y),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(y)}_innerWrite(S=0,y=!0){const w=S||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const n=this._writeBuffer[this._bufferOffset],f=this._action(n,y);if(f){const c=p=>Date.now()-w>=12?setTimeout(()=>this._innerWrite(0,p)):this._innerWrite(w,p);return void f.catch(p=>(queueMicrotask(()=>{throw p}),Promise.resolve(!1))).then(c)}const h=this._callbacks[this._bufferOffset];if(h&&h(),this._bufferOffset++,this._pendingData-=n.length,Date.now()-w>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}s.WriteBuffer=_},5941:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.toRgbString=s.parseColor=void 0;const l=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,a=/^[\da-f]+$/;function u(_,g){const S=_.toString(16),y=S.length<2?"0"+S:S;switch(g){case 4:return S[0];case 8:return y;case 12:return(y+y).slice(0,3);default:return y+y}}s.parseColor=function(_){if(!_)return;let g=_.toLowerCase();if(g.indexOf("rgb:")===0){g=g.slice(4);const S=l.exec(g);if(S){const y=S[1]?15:S[4]?255:S[7]?4095:65535;return[Math.round(parseInt(S[1]||S[4]||S[7]||S[10],16)/y*255),Math.round(parseInt(S[2]||S[5]||S[8]||S[11],16)/y*255),Math.round(parseInt(S[3]||S[6]||S[9]||S[12],16)/y*255)]}}else if(g.indexOf("#")===0&&(g=g.slice(1),a.exec(g)&&[3,6,9,12].includes(g.length))){const S=g.length/3,y=[0,0,0];for(let w=0;w<3;++w){const n=parseInt(g.slice(S*w,S*w+S),16);y[w]=S===1?n<<4:S===2?n:S===3?n>>4:n>>8}return y}},s.toRgbString=function(_,g=16){const[S,y,w]=_;return`rgb:${u(S,g)}/${u(y,g)}/${u(w,g)}`}},5770:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.PAYLOAD_LIMIT=void 0,s.PAYLOAD_LIMIT=1e7},6351:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DcsHandler=s.DcsParser=void 0;const a=l(482),u=l(8742),_=l(5770),g=[];s.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=g,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=g}registerHandler(y,w){this._handlers[y]===void 0&&(this._handlers[y]=[]);const n=this._handlers[y];return n.push(w),{dispose:()=>{const f=n.indexOf(w);f!==-1&&n.splice(f,1)}}}clearHandler(y){this._handlers[y]&&delete this._handlers[y]}setHandlerFallback(y){this._handlerFb=y}reset(){if(this._active.length)for(let y=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;y>=0;--y)this._active[y].unhook(!1);this._stack.paused=!1,this._active=g,this._ident=0}hook(y,w){if(this.reset(),this._ident=y,this._active=this._handlers[y]||g,this._active.length)for(let n=this._active.length-1;n>=0;n--)this._active[n].hook(w);else this._handlerFb(this._ident,"HOOK",w)}put(y,w,n){if(this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].put(y,w,n);else this._handlerFb(this._ident,"PUT",(0,a.utf32ToString)(y,w,n))}unhook(y,w=!0){if(this._active.length){let n=!1,f=this._active.length-1,h=!1;if(this._stack.paused&&(f=this._stack.loopPosition-1,n=w,h=this._stack.fallThrough,this._stack.paused=!1),!h&&n===!1){for(;f>=0&&(n=this._active[f].unhook(y),n!==!0);f--)if(n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!1,n;f--}for(;f>=0;f--)if(n=this._active[f].unhook(!1),n instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!0,n}else this._handlerFb(this._ident,"UNHOOK",y);this._active=g,this._ident=0}};const S=new u.Params;S.addParam(0),s.DcsHandler=class{constructor(y){this._handler=y,this._data="",this._params=S,this._hitLimit=!1}hook(y){this._params=y.length>1||y.params[0]?y.clone():S,this._data="",this._hitLimit=!1}put(y,w,n){this._hitLimit||(this._data+=(0,a.utf32ToString)(y,w,n),this._data.length>_.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(y){let w=!1;if(this._hitLimit)w=!1;else if(y&&(w=this._handler(this._data,this._params),w instanceof Promise))return w.then(n=>(this._params=S,this._data="",this._hitLimit=!1,n));return this._params=S,this._data="",this._hitLimit=!1,w}}},2015:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.EscapeSequenceParser=s.VT500_TRANSITION_TABLE=s.TransitionTable=void 0;const a=l(844),u=l(8742),_=l(6242),g=l(6351);class S{constructor(f){this.table=new Uint8Array(f)}setDefault(f,h){this.table.fill(f<<4|h)}add(f,h,c,p){this.table[h<<8|f]=c<<4|p}addMany(f,h,c,p){for(let b=0;b<f.length;b++)this.table[h<<8|f[b]]=c<<4|p}}s.TransitionTable=S;const y=160;s.VT500_TRANSITION_TABLE=function(){const n=new S(4095),f=Array.apply(null,Array(256)).map((x,m)=>m),h=(x,m)=>f.slice(x,m),c=h(32,127),p=h(0,24);p.push(25),p.push.apply(p,h(28,32));const b=h(0,14);let E;for(E in n.setDefault(1,0),n.addMany(c,0,2,0),b)n.addMany([24,26,153,154],E,3,0),n.addMany(h(128,144),E,3,0),n.addMany(h(144,152),E,3,0),n.add(156,E,0,0),n.add(27,E,11,1),n.add(157,E,4,8),n.addMany([152,158,159],E,0,7),n.add(155,E,11,3),n.add(144,E,11,9);return n.addMany(p,0,3,0),n.addMany(p,1,3,1),n.add(127,1,0,1),n.addMany(p,8,0,8),n.addMany(p,3,3,3),n.add(127,3,0,3),n.addMany(p,4,3,4),n.add(127,4,0,4),n.addMany(p,6,3,6),n.addMany(p,5,3,5),n.add(127,5,0,5),n.addMany(p,2,3,2),n.add(127,2,0,2),n.add(93,1,4,8),n.addMany(c,8,5,8),n.add(127,8,5,8),n.addMany([156,27,24,26,7],8,6,0),n.addMany(h(28,32),8,0,8),n.addMany([88,94,95],1,0,7),n.addMany(c,7,0,7),n.addMany(p,7,0,7),n.add(156,7,0,0),n.add(127,7,0,7),n.add(91,1,11,3),n.addMany(h(64,127),3,7,0),n.addMany(h(48,60),3,8,4),n.addMany([60,61,62,63],3,9,4),n.addMany(h(48,60),4,8,4),n.addMany(h(64,127),4,7,0),n.addMany([60,61,62,63],4,0,6),n.addMany(h(32,64),6,0,6),n.add(127,6,0,6),n.addMany(h(64,127),6,0,0),n.addMany(h(32,48),3,9,5),n.addMany(h(32,48),5,9,5),n.addMany(h(48,64),5,0,6),n.addMany(h(64,127),5,7,0),n.addMany(h(32,48),4,9,5),n.addMany(h(32,48),1,9,2),n.addMany(h(32,48),2,9,2),n.addMany(h(48,127),2,10,0),n.addMany(h(48,80),1,10,0),n.addMany(h(81,88),1,10,0),n.addMany([89,90,92],1,10,0),n.addMany(h(96,127),1,10,0),n.add(80,1,11,9),n.addMany(p,9,0,9),n.add(127,9,0,9),n.addMany(h(28,32),9,0,9),n.addMany(h(32,48),9,9,12),n.addMany(h(48,60),9,8,10),n.addMany([60,61,62,63],9,9,10),n.addMany(p,11,0,11),n.addMany(h(32,128),11,0,11),n.addMany(h(28,32),11,0,11),n.addMany(p,10,0,10),n.add(127,10,0,10),n.addMany(h(28,32),10,0,10),n.addMany(h(48,60),10,8,10),n.addMany([60,61,62,63],10,0,11),n.addMany(h(32,48),10,9,12),n.addMany(p,12,0,12),n.add(127,12,0,12),n.addMany(h(28,32),12,0,12),n.addMany(h(32,48),12,9,12),n.addMany(h(48,64),12,0,11),n.addMany(h(64,127),12,12,13),n.addMany(h(64,127),10,12,13),n.addMany(h(64,127),9,12,13),n.addMany(p,13,13,13),n.addMany(c,13,13,13),n.add(127,13,0,13),n.addMany([27,156,24,26],13,14,0),n.add(y,0,2,0),n.add(y,8,5,8),n.add(y,6,0,6),n.add(y,11,0,11),n.add(y,13,13,13),n}();class w extends a.Disposable{constructor(f=s.VT500_TRANSITION_TABLE){super(),this._transitions=f,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new u.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(h,c,p)=>{},this._executeHandlerFb=h=>{},this._csiHandlerFb=(h,c)=>{},this._escHandlerFb=h=>{},this._errorHandlerFb=h=>h,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,a.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new _.OscParser),this._dcsParser=this.register(new g.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(f,h=[64,126]){let c=0;if(f.prefix){if(f.prefix.length>1)throw new Error("only one byte as prefix supported");if(c=f.prefix.charCodeAt(0),c&&60>c||c>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(f.intermediates){if(f.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let b=0;b<f.intermediates.length;++b){const E=f.intermediates.charCodeAt(b);if(32>E||E>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");c<<=8,c|=E}}if(f.final.length!==1)throw new Error("final must be a single byte");const p=f.final.charCodeAt(0);if(h[0]>p||p>h[1])throw new Error(`final must be in range ${h[0]} .. ${h[1]}`);return c<<=8,c|=p,c}identToString(f){const h=[];for(;f;)h.push(String.fromCharCode(255&f)),f>>=8;return h.reverse().join("")}setPrintHandler(f){this._printHandler=f}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(f,h){const c=this._identifier(f,[48,126]);this._escHandlers[c]===void 0&&(this._escHandlers[c]=[]);const p=this._escHandlers[c];return p.push(h),{dispose:()=>{const b=p.indexOf(h);b!==-1&&p.splice(b,1)}}}clearEscHandler(f){this._escHandlers[this._identifier(f,[48,126])]&&delete this._escHandlers[this._identifier(f,[48,126])]}setEscHandlerFallback(f){this._escHandlerFb=f}setExecuteHandler(f,h){this._executeHandlers[f.charCodeAt(0)]=h}clearExecuteHandler(f){this._executeHandlers[f.charCodeAt(0)]&&delete this._executeHandlers[f.charCodeAt(0)]}setExecuteHandlerFallback(f){this._executeHandlerFb=f}registerCsiHandler(f,h){const c=this._identifier(f);this._csiHandlers[c]===void 0&&(this._csiHandlers[c]=[]);const p=this._csiHandlers[c];return p.push(h),{dispose:()=>{const b=p.indexOf(h);b!==-1&&p.splice(b,1)}}}clearCsiHandler(f){this._csiHandlers[this._identifier(f)]&&delete this._csiHandlers[this._identifier(f)]}setCsiHandlerFallback(f){this._csiHandlerFb=f}registerDcsHandler(f,h){return this._dcsParser.registerHandler(this._identifier(f),h)}clearDcsHandler(f){this._dcsParser.clearHandler(this._identifier(f))}setDcsHandlerFallback(f){this._dcsParser.setHandlerFallback(f)}registerOscHandler(f,h){return this._oscParser.registerHandler(f,h)}clearOscHandler(f){this._oscParser.clearHandler(f)}setOscHandlerFallback(f){this._oscParser.setHandlerFallback(f)}setErrorHandler(f){this._errorHandler=f}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(f,h,c,p,b){this._parseStack.state=f,this._parseStack.handlers=h,this._parseStack.handlerPos=c,this._parseStack.transition=p,this._parseStack.chunkPos=b}parse(f,h,c){let p,b=0,E=0,x=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,x=this._parseStack.chunkPos+1;else{if(c===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const m=this._parseStack.handlers;let C=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(c===!1&&C>-1){for(;C>=0&&(p=m[C](this._params),p!==!0);C--)if(p instanceof Promise)return this._parseStack.handlerPos=C,p}this._parseStack.handlers=[];break;case 4:if(c===!1&&C>-1){for(;C>=0&&(p=m[C](),p!==!0);C--)if(p instanceof Promise)return this._parseStack.handlerPos=C,p}this._parseStack.handlers=[];break;case 6:if(b=f[this._parseStack.chunkPos],p=this._dcsParser.unhook(b!==24&&b!==26,c),p)return p;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(b=f[this._parseStack.chunkPos],p=this._oscParser.end(b!==24&&b!==26,c),p)return p;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,x=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let m=x;m<h;++m){switch(b=f[m],E=this._transitions.table[this.currentState<<8|(b<160?b:y)],E>>4){case 2:for(let O=m+1;;++O){if(O>=h||(b=f[O])<32||b>126&&b<y){this._printHandler(f,m,O),m=O-1;break}if(++O>=h||(b=f[O])<32||b>126&&b<y){this._printHandler(f,m,O),m=O-1;break}if(++O>=h||(b=f[O])<32||b>126&&b<y){this._printHandler(f,m,O),m=O-1;break}if(++O>=h||(b=f[O])<32||b>126&&b<y){this._printHandler(f,m,O),m=O-1;break}}break;case 3:this._executeHandlers[b]?this._executeHandlers[b]():this._executeHandlerFb(b),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:m,code:b,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const C=this._csiHandlers[this._collect<<8|b];let A=C?C.length-1:-1;for(;A>=0&&(p=C[A](this._params),p!==!0);A--)if(p instanceof Promise)return this._preserveStack(3,C,A,E,m),p;A<0&&this._csiHandlerFb(this._collect<<8|b,this._params),this.precedingCodepoint=0;break;case 8:do switch(b){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(b-48)}while(++m<h&&(b=f[m])>47&&b<60);m--;break;case 9:this._collect<<=8,this._collect|=b;break;case 10:const T=this._escHandlers[this._collect<<8|b];let D=T?T.length-1:-1;for(;D>=0&&(p=T[D](),p!==!0);D--)if(p instanceof Promise)return this._preserveStack(4,T,D,E,m),p;D<0&&this._escHandlerFb(this._collect<<8|b),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|b,this._params);break;case 13:for(let O=m+1;;++O)if(O>=h||(b=f[O])===24||b===26||b===27||b>127&&b<y){this._dcsParser.put(f,m,O),m=O-1;break}break;case 14:if(p=this._dcsParser.unhook(b!==24&&b!==26),p)return this._preserveStack(6,[],0,E,m),p;b===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let O=m+1;;O++)if(O>=h||(b=f[O])<32||b>127&&b<y){this._oscParser.put(f,m,O),m=O-1;break}break;case 6:if(p=this._oscParser.end(b!==24&&b!==26),p)return this._preserveStack(5,[],0,E,m),p;b===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&E}}}s.EscapeSequenceParser=w},6242:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OscHandler=s.OscParser=void 0;const a=l(5770),u=l(482),_=[];s.OscParser=class{constructor(){this._state=0,this._active=_,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(g,S){this._handlers[g]===void 0&&(this._handlers[g]=[]);const y=this._handlers[g];return y.push(S),{dispose:()=>{const w=y.indexOf(S);w!==-1&&y.splice(w,1)}}}clearHandler(g){this._handlers[g]&&delete this._handlers[g]}setHandlerFallback(g){this._handlerFb=g}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=_}reset(){if(this._state===2)for(let g=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;g>=0;--g)this._active[g].end(!1);this._stack.paused=!1,this._active=_,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||_,this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].start();else this._handlerFb(this._id,"START")}_put(g,S,y){if(this._active.length)for(let w=this._active.length-1;w>=0;w--)this._active[w].put(g,S,y);else this._handlerFb(this._id,"PUT",(0,u.utf32ToString)(g,S,y))}start(){this.reset(),this._state=1}put(g,S,y){if(this._state!==3){if(this._state===1)for(;S<y;){const w=g[S++];if(w===59){this._state=2,this._start();break}if(w<48||57<w)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+w-48}this._state===2&&y-S>0&&this._put(g,S,y)}}end(g,S=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let y=!1,w=this._active.length-1,n=!1;if(this._stack.paused&&(w=this._stack.loopPosition-1,y=S,n=this._stack.fallThrough,this._stack.paused=!1),!n&&y===!1){for(;w>=0&&(y=this._active[w].end(g),y!==!0);w--)if(y instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=w,this._stack.fallThrough=!1,y;w--}for(;w>=0;w--)if(y=this._active[w].end(!1),y instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=w,this._stack.fallThrough=!0,y}else this._handlerFb(this._id,"END",g);this._active=_,this._id=-1,this._state=0}}},s.OscHandler=class{constructor(g){this._handler=g,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(g,S,y){this._hitLimit||(this._data+=(0,u.utf32ToString)(g,S,y),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(g){let S=!1;if(this._hitLimit)S=!1;else if(g&&(S=this._handler(this._data),S instanceof Promise))return S.then(y=>(this._data="",this._hitLimit=!1,y));return this._data="",this._hitLimit=!1,S}}},8742:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.Params=void 0;const l=2147483647;class a{static fromArray(_){const g=new a;if(!_.length)return g;for(let S=Array.isArray(_[0])?1:0;S<_.length;++S){const y=_[S];if(Array.isArray(y))for(let w=0;w<y.length;++w)g.addSubParam(y[w]);else g.addParam(y)}return g}constructor(_=32,g=32){if(this.maxLength=_,this.maxSubParamsLength=g,g>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(_),this.length=0,this._subParams=new Int32Array(g),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(_),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const _=new a(this.maxLength,this.maxSubParamsLength);return _.params.set(this.params),_.length=this.length,_._subParams.set(this._subParams),_._subParamsLength=this._subParamsLength,_._subParamsIdx.set(this._subParamsIdx),_._rejectDigits=this._rejectDigits,_._rejectSubDigits=this._rejectSubDigits,_._digitIsSub=this._digitIsSub,_}toArray(){const _=[];for(let g=0;g<this.length;++g){_.push(this.params[g]);const S=this._subParamsIdx[g]>>8,y=255&this._subParamsIdx[g];y-S>0&&_.push(Array.prototype.slice.call(this._subParams,S,y))}return _}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(_){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(_<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=_>l?l:_}}addSubParam(_){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(_<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=_>l?l:_,this._subParamsIdx[this.length-1]++}}hasSubParams(_){return(255&this._subParamsIdx[_])-(this._subParamsIdx[_]>>8)>0}getSubParams(_){const g=this._subParamsIdx[_]>>8,S=255&this._subParamsIdx[_];return S-g>0?this._subParams.subarray(g,S):null}getSubParamsAll(){const _={};for(let g=0;g<this.length;++g){const S=this._subParamsIdx[g]>>8,y=255&this._subParamsIdx[g];y-S>0&&(_[g]=this._subParams.slice(S,y))}return _}addDigit(_){let g;if(this._rejectDigits||!(g=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const S=this._digitIsSub?this._subParams:this.params,y=S[g-1];S[g-1]=~y?Math.min(10*y+_,l):_}}s.Params=a},5741:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.AddonManager=void 0,s.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let l=this._addons.length-1;l>=0;l--)this._addons[l].instance.dispose()}loadAddon(l,a){const u={instance:a,dispose:a.dispose,isDisposed:!1};this._addons.push(u),a.dispose=()=>this._wrappedAddonDispose(u),a.activate(l)}_wrappedAddonDispose(l){if(l.isDisposed)return;let a=-1;for(let u=0;u<this._addons.length;u++)if(this._addons[u]===l){a=u;break}if(a===-1)throw new Error("Could not dispose an addon that has not been loaded");l.isDisposed=!0,l.dispose.apply(l.instance),this._addons.splice(a,1)}}},8771:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferApiView=void 0;const a=l(3785),u=l(511);s.BufferApiView=class{constructor(_,g){this._buffer=_,this.type=g}init(_){return this._buffer=_,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(_){const g=this._buffer.lines.get(_);if(g)return new a.BufferLineApiView(g)}getNullCell(){return new u.CellData}}},3785:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferLineApiView=void 0;const a=l(511);s.BufferLineApiView=class{constructor(u){this._line=u}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(u,_){if(!(u<0||u>=this._line.length))return _?(this._line.loadCell(u,_),_):this._line.loadCell(u,new a.CellData)}translateToString(u,_,g){return this._line.translateToString(u,_,g)}}},8285:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.BufferNamespaceApi=void 0;const a=l(8771),u=l(8460),_=l(844);class g extends _.Disposable{constructor(y){super(),this._core=y,this._onBufferChange=this.register(new u.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new a.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new a.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}s.BufferNamespaceApi=g},7975:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.ParserApi=void 0,s.ParserApi=class{constructor(l){this._core=l}registerCsiHandler(l,a){return this._core.registerCsiHandler(l,u=>a(u.toArray()))}addCsiHandler(l,a){return this.registerCsiHandler(l,a)}registerDcsHandler(l,a){return this._core.registerDcsHandler(l,(u,_)=>a(u,_.toArray()))}addDcsHandler(l,a){return this.registerDcsHandler(l,a)}registerEscHandler(l,a){return this._core.registerEscHandler(l,a)}addEscHandler(l,a){return this.registerEscHandler(l,a)}registerOscHandler(l,a){return this._core.registerOscHandler(l,a)}addOscHandler(l,a){return this.registerOscHandler(l,a)}}},7090:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeApi=void 0,s.UnicodeApi=class{constructor(l){this._core=l}register(l){this._core.unicodeService.register(l)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(l){this._core.unicodeService.activeVersion=l}}},744:function(v,s,l){var a=this&&this.__decorate||function(n,f,h,c){var p,b=arguments.length,E=b<3?f:c===null?c=Object.getOwnPropertyDescriptor(f,h):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(n,f,h,c);else for(var x=n.length-1;x>=0;x--)(p=n[x])&&(E=(b<3?p(E):b>3?p(f,h,E):p(f,h))||E);return b>3&&E&&Object.defineProperty(f,h,E),E},u=this&&this.__param||function(n,f){return function(h,c){f(h,c,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.BufferService=s.MINIMUM_ROWS=s.MINIMUM_COLS=void 0;const _=l(8460),g=l(844),S=l(5295),y=l(2585);s.MINIMUM_COLS=2,s.MINIMUM_ROWS=1;let w=s.BufferService=class extends g.Disposable{get buffer(){return this.buffers.active}constructor(n){super(),this.isUserScrolling=!1,this._onResize=this.register(new _.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new _.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(n.rawOptions.cols||0,s.MINIMUM_COLS),this.rows=Math.max(n.rawOptions.rows||0,s.MINIMUM_ROWS),this.buffers=this.register(new S.BufferSet(n,this))}resize(n,f){this.cols=n,this.rows=f,this.buffers.resize(n,f),this._onResize.fire({cols:n,rows:f})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(n,f=!1){const h=this.buffer;let c;c=this._cachedBlankLine,c&&c.length===this.cols&&c.getFg(0)===n.fg&&c.getBg(0)===n.bg||(c=h.getBlankLine(n,f),this._cachedBlankLine=c),c.isWrapped=f;const p=h.ybase+h.scrollTop,b=h.ybase+h.scrollBottom;if(h.scrollTop===0){const E=h.lines.isFull;b===h.lines.length-1?E?h.lines.recycle().copyFrom(c):h.lines.push(c.clone()):h.lines.splice(b+1,0,c.clone()),E?this.isUserScrolling&&(h.ydisp=Math.max(h.ydisp-1,0)):(h.ybase++,this.isUserScrolling||h.ydisp++)}else{const E=b-p+1;h.lines.shiftElements(p+1,E-1,-1),h.lines.set(b,c.clone())}this.isUserScrolling||(h.ydisp=h.ybase),this._onScroll.fire(h.ydisp)}scrollLines(n,f,h){const c=this.buffer;if(n<0){if(c.ydisp===0)return;this.isUserScrolling=!0}else n+c.ydisp>=c.ybase&&(this.isUserScrolling=!1);const p=c.ydisp;c.ydisp=Math.max(Math.min(c.ydisp+n,c.ybase),0),p!==c.ydisp&&(f||this._onScroll.fire(c.ydisp))}};s.BufferService=w=a([u(0,y.IOptionsService)],w)},7994:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.CharsetService=void 0,s.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(l){this.glevel=l,this.charset=this._charsets[l]}setgCharset(l,a){this._charsets[l]=a,this.glevel===l&&(this.charset=a)}}},1753:function(v,s,l){var a=this&&this.__decorate||function(c,p,b,E){var x,m=arguments.length,C=m<3?p:E===null?E=Object.getOwnPropertyDescriptor(p,b):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(c,p,b,E);else for(var A=c.length-1;A>=0;A--)(x=c[A])&&(C=(m<3?x(C):m>3?x(p,b,C):x(p,b))||C);return m>3&&C&&Object.defineProperty(p,b,C),C},u=this&&this.__param||function(c,p){return function(b,E){p(b,E,c)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreMouseService=void 0;const _=l(2585),g=l(8460),S=l(844),y={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:c=>c.button!==4&&c.action===1&&(c.ctrl=!1,c.alt=!1,c.shift=!1,!0)},VT200:{events:19,restrict:c=>c.action!==32},DRAG:{events:23,restrict:c=>c.action!==32||c.button!==3},ANY:{events:31,restrict:c=>!0}};function w(c,p){let b=(c.ctrl?16:0)|(c.shift?4:0)|(c.alt?8:0);return c.button===4?(b|=64,b|=c.action):(b|=3&c.button,4&c.button&&(b|=64),8&c.button&&(b|=128),c.action===32?b|=32:c.action!==0||p||(b|=3)),b}const n=String.fromCharCode,f={DEFAULT:c=>{const p=[w(c,!1)+32,c.col+32,c.row+32];return p[0]>255||p[1]>255||p[2]>255?"":`\x1B[M${n(p[0])}${n(p[1])}${n(p[2])}`},SGR:c=>{const p=c.action===0&&c.button!==4?"m":"M";return`\x1B[<${w(c,!0)};${c.col};${c.row}${p}`},SGR_PIXELS:c=>{const p=c.action===0&&c.button!==4?"m":"M";return`\x1B[<${w(c,!0)};${c.x};${c.y}${p}`}};let h=s.CoreMouseService=class extends S.Disposable{constructor(c,p){super(),this._bufferService=c,this._coreService=p,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new g.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const b of Object.keys(y))this.addProtocol(b,y[b]);for(const b of Object.keys(f))this.addEncoding(b,f[b]);this.reset()}addProtocol(c,p){this._protocols[c]=p}addEncoding(c,p){this._encodings[c]=p}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(c){if(!this._protocols[c])throw new Error(`unknown protocol "${c}"`);this._activeProtocol=c,this._onProtocolChange.fire(this._protocols[c].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(c){if(!this._encodings[c])throw new Error(`unknown encoding "${c}"`);this._activeEncoding=c}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(c){if(c.col<0||c.col>=this._bufferService.cols||c.row<0||c.row>=this._bufferService.rows||c.button===4&&c.action===32||c.button===3&&c.action!==32||c.button!==4&&(c.action===2||c.action===3)||(c.col++,c.row++,c.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,c,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(c))return!1;const p=this._encodings[this._activeEncoding](c);return p&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(p):this._coreService.triggerDataEvent(p,!0)),this._lastEvent=c,!0}explainEvents(c){return{down:!!(1&c),up:!!(2&c),drag:!!(4&c),move:!!(8&c),wheel:!!(16&c)}}_equalEvents(c,p,b){if(b){if(c.x!==p.x||c.y!==p.y)return!1}else if(c.col!==p.col||c.row!==p.row)return!1;return c.button===p.button&&c.action===p.action&&c.ctrl===p.ctrl&&c.alt===p.alt&&c.shift===p.shift}};s.CoreMouseService=h=a([u(0,_.IBufferService),u(1,_.ICoreService)],h)},6975:function(v,s,l){var a=this&&this.__decorate||function(h,c,p,b){var E,x=arguments.length,m=x<3?c:b===null?b=Object.getOwnPropertyDescriptor(c,p):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(h,c,p,b);else for(var C=h.length-1;C>=0;C--)(E=h[C])&&(m=(x<3?E(m):x>3?E(c,p,m):E(c,p))||m);return x>3&&m&&Object.defineProperty(c,p,m),m},u=this&&this.__param||function(h,c){return function(p,b){c(p,b,h)}};Object.defineProperty(s,"__esModule",{value:!0}),s.CoreService=void 0;const _=l(1439),g=l(8460),S=l(844),y=l(2585),w=Object.freeze({insertMode:!1}),n=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let f=s.CoreService=class extends S.Disposable{constructor(h,c,p){super(),this._bufferService=h,this._logService=c,this._optionsService=p,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new g.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new g.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new g.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new g.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,_.clone)(w),this.decPrivateModes=(0,_.clone)(n)}reset(){this.modes=(0,_.clone)(w),this.decPrivateModes=(0,_.clone)(n)}triggerDataEvent(h,c=!1){if(this._optionsService.rawOptions.disableStdin)return;const p=this._bufferService.buffer;c&&this._optionsService.rawOptions.scrollOnUserInput&&p.ybase!==p.ydisp&&this._onRequestScrollToBottom.fire(),c&&this._onUserInput.fire(),this._logService.debug(`sending data "${h}"`,()=>h.split("").map(b=>b.charCodeAt(0))),this._onData.fire(h)}triggerBinaryEvent(h){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${h}"`,()=>h.split("").map(c=>c.charCodeAt(0))),this._onBinary.fire(h))}};s.CoreService=f=a([u(0,y.IBufferService),u(1,y.ILogService),u(2,y.IOptionsService)],f)},9074:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.DecorationService=void 0;const a=l(8055),u=l(8460),_=l(844),g=l(6106);let S=0,y=0;class w extends _.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new g.SortedList(h=>h==null?void 0:h.marker.line),this._onDecorationRegistered=this.register(new u.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new u.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,_.toDisposable)(()=>this.reset()))}registerDecoration(h){if(h.marker.isDisposed)return;const c=new n(h);if(c){const p=c.marker.onDispose(()=>c.dispose());c.onDispose(()=>{c&&(this._decorations.delete(c)&&this._onDecorationRemoved.fire(c),p.dispose())}),this._decorations.insert(c),this._onDecorationRegistered.fire(c)}return c}reset(){for(const h of this._decorations.values())h.dispose();this._decorations.clear()}*getDecorationsAtCell(h,c,p){var b,E,x;let m=0,C=0;for(const A of this._decorations.getKeyIterator(c))m=(b=A.options.x)!==null&&b!==void 0?b:0,C=m+((E=A.options.width)!==null&&E!==void 0?E:1),h>=m&&h<C&&(!p||((x=A.options.layer)!==null&&x!==void 0?x:"bottom")===p)&&(yield A)}forEachDecorationAtCell(h,c,p,b){this._decorations.forEachByKey(c,E=>{var x,m,C;S=(x=E.options.x)!==null&&x!==void 0?x:0,y=S+((m=E.options.width)!==null&&m!==void 0?m:1),h>=S&&h<y&&(!p||((C=E.options.layer)!==null&&C!==void 0?C:"bottom")===p)&&b(E)})}}s.DecorationService=w;class n extends _.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=a.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=a.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(h){super(),this.options=h,this.onRenderEmitter=this.register(new u.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=h.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.InstantiationService=s.ServiceCollection=void 0;const a=l(2585),u=l(8343);class _{constructor(...S){this._entries=new Map;for(const[y,w]of S)this.set(y,w)}set(S,y){const w=this._entries.get(S);return this._entries.set(S,y),w}forEach(S){for(const[y,w]of this._entries.entries())S(y,w)}has(S){return this._entries.has(S)}get(S){return this._entries.get(S)}}s.ServiceCollection=_,s.InstantiationService=class{constructor(){this._services=new _,this._services.set(a.IInstantiationService,this)}setService(g,S){this._services.set(g,S)}getService(g){return this._services.get(g)}createInstance(g,...S){const y=(0,u.getServiceDependencies)(g).sort((f,h)=>f.index-h.index),w=[];for(const f of y){const h=this._services.get(f.id);if(!h)throw new Error(`[createInstance] ${g.name} depends on UNKNOWN service ${f.id}.`);w.push(h)}const n=y.length>0?y[0].index:S.length;if(S.length!==n)throw new Error(`[createInstance] First service dependency of ${g.name} at position ${n+1} conflicts with ${S.length} static arguments`);return new g(...S,...w)}}},7866:function(v,s,l){var a=this&&this.__decorate||function(n,f,h,c){var p,b=arguments.length,E=b<3?f:c===null?c=Object.getOwnPropertyDescriptor(f,h):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(n,f,h,c);else for(var x=n.length-1;x>=0;x--)(p=n[x])&&(E=(b<3?p(E):b>3?p(f,h,E):p(f,h))||E);return b>3&&E&&Object.defineProperty(f,h,E),E},u=this&&this.__param||function(n,f){return function(h,c){f(h,c,n)}};Object.defineProperty(s,"__esModule",{value:!0}),s.traceCall=s.setTraceLogger=s.LogService=void 0;const _=l(844),g=l(2585),S={trace:g.LogLevelEnum.TRACE,debug:g.LogLevelEnum.DEBUG,info:g.LogLevelEnum.INFO,warn:g.LogLevelEnum.WARN,error:g.LogLevelEnum.ERROR,off:g.LogLevelEnum.OFF};let y,w=s.LogService=class extends _.Disposable{get logLevel(){return this._logLevel}constructor(n){super(),this._optionsService=n,this._logLevel=g.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),y=this}_updateLogLevel(){this._logLevel=S[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(n){for(let f=0;f<n.length;f++)typeof n[f]=="function"&&(n[f]=n[f]())}_log(n,f,h){this._evalLazyOptionalParams(h),n.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+f,...h)}trace(n,...f){var h,c;this._logLevel<=g.LogLevelEnum.TRACE&&this._log((c=(h=this._optionsService.options.logger)===null||h===void 0?void 0:h.trace.bind(this._optionsService.options.logger))!==null&&c!==void 0?c:console.log,n,f)}debug(n,...f){var h,c;this._logLevel<=g.LogLevelEnum.DEBUG&&this._log((c=(h=this._optionsService.options.logger)===null||h===void 0?void 0:h.debug.bind(this._optionsService.options.logger))!==null&&c!==void 0?c:console.log,n,f)}info(n,...f){var h,c;this._logLevel<=g.LogLevelEnum.INFO&&this._log((c=(h=this._optionsService.options.logger)===null||h===void 0?void 0:h.info.bind(this._optionsService.options.logger))!==null&&c!==void 0?c:console.info,n,f)}warn(n,...f){var h,c;this._logLevel<=g.LogLevelEnum.WARN&&this._log((c=(h=this._optionsService.options.logger)===null||h===void 0?void 0:h.warn.bind(this._optionsService.options.logger))!==null&&c!==void 0?c:console.warn,n,f)}error(n,...f){var h,c;this._logLevel<=g.LogLevelEnum.ERROR&&this._log((c=(h=this._optionsService.options.logger)===null||h===void 0?void 0:h.error.bind(this._optionsService.options.logger))!==null&&c!==void 0?c:console.error,n,f)}};s.LogService=w=a([u(0,g.IOptionsService)],w),s.setTraceLogger=function(n){y=n},s.traceCall=function(n,f,h){if(typeof h.value!="function")throw new Error("not supported");const c=h.value;h.value=function(...p){if(y.logLevel!==g.LogLevelEnum.TRACE)return c.apply(this,p);y.trace(`GlyphRenderer#${c.name}(${p.map(E=>JSON.stringify(E)).join(", ")})`);const b=c.apply(this,p);return y.trace(`GlyphRenderer#${c.name} return`,b),b}}},7302:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.OptionsService=s.DEFAULT_OPTIONS=void 0;const a=l(8460),u=l(844),_=l(6114);s.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:_.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const g=["normal","bold","100","200","300","400","500","600","700","800","900"];class S extends u.Disposable{constructor(w){super(),this._onOptionChange=this.register(new a.EventEmitter),this.onOptionChange=this._onOptionChange.event;const n=Object.assign({},s.DEFAULT_OPTIONS);for(const f in w)if(f in n)try{const h=w[f];n[f]=this._sanitizeAndValidateOption(f,h)}catch(h){console.error(h)}this.rawOptions=n,this.options=Object.assign({},n),this._setupOptions()}onSpecificOptionChange(w,n){return this.onOptionChange(f=>{f===w&&n(this.rawOptions[w])})}onMultipleOptionChange(w,n){return this.onOptionChange(f=>{w.indexOf(f)!==-1&&n()})}_setupOptions(){const w=f=>{if(!(f in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${f}"`);return this.rawOptions[f]},n=(f,h)=>{if(!(f in s.DEFAULT_OPTIONS))throw new Error(`No option with key "${f}"`);h=this._sanitizeAndValidateOption(f,h),this.rawOptions[f]!==h&&(this.rawOptions[f]=h,this._onOptionChange.fire(f))};for(const f in this.rawOptions){const h={get:w.bind(this,f),set:n.bind(this,f)};Object.defineProperty(this.options,f,h)}}_sanitizeAndValidateOption(w,n){switch(w){case"cursorStyle":if(n||(n=s.DEFAULT_OPTIONS[w]),!function(f){return f==="block"||f==="underline"||f==="bar"}(n))throw new Error(`"${n}" is not a valid value for ${w}`);break;case"wordSeparator":n||(n=s.DEFAULT_OPTIONS[w]);break;case"fontWeight":case"fontWeightBold":if(typeof n=="number"&&1<=n&&n<=1e3)break;n=g.includes(n)?n:s.DEFAULT_OPTIONS[w];break;case"cursorWidth":n=Math.floor(n);case"lineHeight":case"tabStopWidth":if(n<1)throw new Error(`${w} cannot be less than 1, value: ${n}`);break;case"minimumContrastRatio":n=Math.max(1,Math.min(21,Math.round(10*n)/10));break;case"scrollback":if((n=Math.min(n,4294967295))<0)throw new Error(`${w} cannot be less than 0, value: ${n}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(n<=0)throw new Error(`${w} cannot be less than or equal to 0, value: ${n}`);break;case"rows":case"cols":if(!n&&n!==0)throw new Error(`${w} must be numeric, value: ${n}`);break;case"windowsPty":n=n??{}}return n}}s.OptionsService=S},2660:function(v,s,l){var a=this&&this.__decorate||function(S,y,w,n){var f,h=arguments.length,c=h<3?y:n===null?n=Object.getOwnPropertyDescriptor(y,w):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(S,y,w,n);else for(var p=S.length-1;p>=0;p--)(f=S[p])&&(c=(h<3?f(c):h>3?f(y,w,c):f(y,w))||c);return h>3&&c&&Object.defineProperty(y,w,c),c},u=this&&this.__param||function(S,y){return function(w,n){y(w,n,S)}};Object.defineProperty(s,"__esModule",{value:!0}),s.OscLinkService=void 0;const _=l(2585);let g=s.OscLinkService=class{constructor(S){this._bufferService=S,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(S){const y=this._bufferService.buffer;if(S.id===void 0){const p=y.addMarker(y.ybase+y.y),b={data:S,id:this._nextId++,lines:[p]};return p.onDispose(()=>this._removeMarkerFromLink(b,p)),this._dataByLinkId.set(b.id,b),b.id}const w=S,n=this._getEntryIdKey(w),f=this._entriesWithId.get(n);if(f)return this.addLineToLink(f.id,y.ybase+y.y),f.id;const h=y.addMarker(y.ybase+y.y),c={id:this._nextId++,key:this._getEntryIdKey(w),data:w,lines:[h]};return h.onDispose(()=>this._removeMarkerFromLink(c,h)),this._entriesWithId.set(c.key,c),this._dataByLinkId.set(c.id,c),c.id}addLineToLink(S,y){const w=this._dataByLinkId.get(S);if(w&&w.lines.every(n=>n.line!==y)){const n=this._bufferService.buffer.addMarker(y);w.lines.push(n),n.onDispose(()=>this._removeMarkerFromLink(w,n))}}getLinkData(S){var y;return(y=this._dataByLinkId.get(S))===null||y===void 0?void 0:y.data}_getEntryIdKey(S){return`${S.id};;${S.uri}`}_removeMarkerFromLink(S,y){const w=S.lines.indexOf(y);w!==-1&&(S.lines.splice(w,1),S.lines.length===0&&(S.data.id!==void 0&&this._entriesWithId.delete(S.key),this._dataByLinkId.delete(S.id)))}};s.OscLinkService=g=a([u(0,_.IBufferService)],g)},8343:(v,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.createDecorator=s.getServiceDependencies=s.serviceRegistry=void 0;const l="di$target",a="di$dependencies";s.serviceRegistry=new Map,s.getServiceDependencies=function(u){return u[a]||[]},s.createDecorator=function(u){if(s.serviceRegistry.has(u))return s.serviceRegistry.get(u);const _=function(g,S,y){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(w,n,f){n[l]===n?n[a].push({id:w,index:f}):(n[a]=[{id:w,index:f}],n[l]=n)})(_,g,y)};return _.toString=()=>u,s.serviceRegistry.set(u,_),_}},2585:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.IDecorationService=s.IUnicodeService=s.IOscLinkService=s.IOptionsService=s.ILogService=s.LogLevelEnum=s.IInstantiationService=s.ICharsetService=s.ICoreService=s.ICoreMouseService=s.IBufferService=void 0;const a=l(8343);var u;s.IBufferService=(0,a.createDecorator)("BufferService"),s.ICoreMouseService=(0,a.createDecorator)("CoreMouseService"),s.ICoreService=(0,a.createDecorator)("CoreService"),s.ICharsetService=(0,a.createDecorator)("CharsetService"),s.IInstantiationService=(0,a.createDecorator)("InstantiationService"),function(_){_[_.TRACE=0]="TRACE",_[_.DEBUG=1]="DEBUG",_[_.INFO=2]="INFO",_[_.WARN=3]="WARN",_[_.ERROR=4]="ERROR",_[_.OFF=5]="OFF"}(u||(s.LogLevelEnum=u={})),s.ILogService=(0,a.createDecorator)("LogService"),s.IOptionsService=(0,a.createDecorator)("OptionsService"),s.IOscLinkService=(0,a.createDecorator)("OscLinkService"),s.IUnicodeService=(0,a.createDecorator)("UnicodeService"),s.IDecorationService=(0,a.createDecorator)("DecorationService")},1480:(v,s,l)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.UnicodeService=void 0;const a=l(8460),u=l(225);s.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new a.EventEmitter,this.onChange=this._onChange.event;const _=new u.UnicodeV6;this.register(_),this._active=_.version,this._activeProvider=_}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(_){if(!this._providers[_])throw new Error(`unknown Unicode version "${_}"`);this._active=_,this._activeProvider=this._providers[_],this._onChange.fire(_)}register(_){this._providers[_.version]=_}wcwidth(_){return this._activeProvider.wcwidth(_)}getStringCellWidth(_){let g=0;const S=_.length;for(let y=0;y<S;++y){let w=_.charCodeAt(y);if(55296<=w&&w<=56319){if(++y>=S)return g+this.wcwidth(w);const n=_.charCodeAt(y);56320<=n&&n<=57343?w=1024*(w-55296)+n-56320+65536:g+=this.wcwidth(n)}g+=this.wcwidth(w)}return g}}}},r={};function o(v){var s=r[v];if(s!==void 0)return s.exports;var l=r[v]={exports:{}};return i[v].call(l.exports,l,l.exports,o),l.exports}var d={};return(()=>{var v=d;Object.defineProperty(v,"__esModule",{value:!0}),v.Terminal=void 0;const s=o(9042),l=o(3236),a=o(844),u=o(5741),_=o(8285),g=o(7975),S=o(7090),y=["cols","rows"];class w extends a.Disposable{constructor(f){super(),this._core=this.register(new l.Terminal(f)),this._addonManager=this.register(new u.AddonManager),this._publicOptions=Object.assign({},this._core.options);const h=p=>this._core.options[p],c=(p,b)=>{this._checkReadonlyOptions(p),this._core.options[p]=b};for(const p in this._core.options){const b={get:h.bind(this,p),set:c.bind(this,p)};Object.defineProperty(this._publicOptions,p,b)}}_checkReadonlyOptions(f){if(y.includes(f))throw new Error(`Option "${f}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new g.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new S.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new _.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const f=this._core.coreService.decPrivateModes;let h="none";switch(this._core.coreMouseService.activeProtocol){case"X10":h="x10";break;case"VT200":h="vt200";break;case"DRAG":h="drag";break;case"ANY":h="any"}return{applicationCursorKeysMode:f.applicationCursorKeys,applicationKeypadMode:f.applicationKeypad,bracketedPasteMode:f.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:h,originMode:f.origin,reverseWraparoundMode:f.reverseWraparound,sendFocusMode:f.sendFocus,wraparoundMode:f.wraparound}}get options(){return this._publicOptions}set options(f){for(const h in f)this._publicOptions[h]=f[h]}blur(){this._core.blur()}focus(){this._core.focus()}resize(f,h){this._verifyIntegers(f,h),this._core.resize(f,h)}open(f){this._core.open(f)}attachCustomKeyEventHandler(f){this._core.attachCustomKeyEventHandler(f)}registerLinkProvider(f){return this._core.registerLinkProvider(f)}registerCharacterJoiner(f){return this._checkProposedApi(),this._core.registerCharacterJoiner(f)}deregisterCharacterJoiner(f){this._checkProposedApi(),this._core.deregisterCharacterJoiner(f)}registerMarker(f=0){return this._verifyIntegers(f),this._core.registerMarker(f)}registerDecoration(f){var h,c,p;return this._checkProposedApi(),this._verifyPositiveIntegers((h=f.x)!==null&&h!==void 0?h:0,(c=f.width)!==null&&c!==void 0?c:0,(p=f.height)!==null&&p!==void 0?p:0),this._core.registerDecoration(f)}hasSelection(){return this._core.hasSelection()}select(f,h,c){this._verifyIntegers(f,h,c),this._core.select(f,h,c)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(f,h){this._verifyIntegers(f,h),this._core.selectLines(f,h)}dispose(){super.dispose()}scrollLines(f){this._verifyIntegers(f),this._core.scrollLines(f)}scrollPages(f){this._verifyIntegers(f),this._core.scrollPages(f)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(f){this._verifyIntegers(f),this._core.scrollToLine(f)}clear(){this._core.clear()}write(f,h){this._core.write(f,h)}writeln(f,h){this._core.write(f),this._core.write(`\r
`,h)}paste(f){this._core.paste(f)}refresh(f,h){this._verifyIntegers(f,h),this._core.refresh(f,h)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(f){this._addonManager.loadAddon(this,f)}static get strings(){return s}_verifyIntegers(...f){for(const h of f)if(h===1/0||isNaN(h)||h%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...f){for(const h of f)if(h&&(h===1/0||isNaN(h)||h%1!=0||h<0))throw new Error("This API only accepts positive integers")}}v.Terminal=w})(),d})())})(sl);var du=sl.exports,nl={exports:{}};(function(e,t){(function(i,r){e.exports=r()})(self,()=>(()=>{var i={};return(()=>{var r=i;Object.defineProperty(r,"__esModule",{value:!0}),r.FitAddon=void 0,r.FitAddon=class{activate(o){this._terminal=o}dispose(){}fit(){const o=this.proposeDimensions();if(!o||!this._terminal||isNaN(o.cols)||isNaN(o.rows))return;const d=this._terminal._core;this._terminal.rows===o.rows&&this._terminal.cols===o.cols||(d._renderService.clear(),this._terminal.resize(o.cols,o.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const o=this._terminal._core,d=o._renderService.dimensions;if(d.css.cell.width===0||d.css.cell.height===0)return;const v=this._terminal.options.scrollback===0?0:o.viewport.scrollBarWidth,s=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(s.getPropertyValue("height")),a=Math.max(0,parseInt(s.getPropertyValue("width"))),u=window.getComputedStyle(this._terminal.element),_=l-(parseInt(u.getPropertyValue("padding-top"))+parseInt(u.getPropertyValue("padding-bottom"))),g=a-(parseInt(u.getPropertyValue("padding-right"))+parseInt(u.getPropertyValue("padding-left")))-v;return{cols:Math.max(2,Math.floor(g/d.css.cell.width)),rows:Math.max(1,Math.floor(_/d.css.cell.height))}}}})(),i})())})(nl);var fu=nl.exports;function _u(e){var t={target:"confetti-holder",max:80,size:1,animate:!0,respawn:!0,props:["circle","square","triangle","line"],colors:[[165,104,246],[230,61,135],[0,199,228],[253,214,126]],clock:25,interval:null,rotate:!1,start_from_edge:!1,width:window.innerWidth,height:window.innerHeight};if(e&&(e.target&&(t.target=e.target),e.max&&(t.max=e.max),e.size&&(t.size=e.size),e.animate!==void 0&&e.animate!==null&&(t.animate=e.animate),e.respawn!==void 0&&e.respawn!==null&&(t.respawn=e.respawn),e.props&&(t.props=e.props),e.colors&&(t.colors=e.colors),e.clock&&(t.clock=e.clock),e.start_from_edge!==void 0&&e.start_from_edge!==null&&(t.start_from_edge=e.start_from_edge),e.width&&(t.width=e.width),e.height&&(t.height=e.height),e.rotate!==void 0&&e.rotate!==null&&(t.rotate=e.rotate)),typeof t.target!="object"&&typeof t.target!="string")throw new TypeError("The target parameter should be a node or string");if(typeof t.target=="object"&&(t.target===null||!t.target instanceof HTMLCanvasElement)||typeof t.target=="string"&&(document.getElementById(t.target)===null||!document.getElementById(t.target)instanceof HTMLCanvasElement))throw new ReferenceError("The target element does not exist or is not a canvas element");var i=typeof t.target=="object"?t.target:document.getElementById(t.target),r=i.getContext("2d"),o=[];function d(g,S){g||(g=1);var y=Math.random()*g;return S?Math.floor(y):y}var v=t.props.reduce(function(g,S){return g+(S.weight||1)},0);function s(){for(var g=Math.random()*v,S=0;S<t.props.length;++S){var y=t.props[S].weight||1;if(g<y)return S;g-=y}}function l(){var g=t.props[s()],S={prop:g.type?g.type:g,x:d(t.width),y:t.start_from_edge?t.clock>=0?-10:parseFloat(t.height)+10:d(t.height),src:g.src,radius:d(4)+1,size:g.size,rotate:t.rotate,line:Math.floor(d(65)-30),angles:[d(10,!0)+2,d(10,!0)+2,d(10,!0)+2,d(10,!0)+2],color:t.colors[d(t.colors.length,!0)],rotation:d(360,!0)*Math.PI/180,speed:d(t.clock/7)+t.clock/30};return S}function a(g){if(g){var S=g.radius<=3?.4:.8;switch(r.fillStyle=r.strokeStyle="rgba("+g.color+", "+S+")",r.beginPath(),g.prop){case"circle":{r.moveTo(g.x,g.y),r.arc(g.x,g.y,g.radius*t.size,0,Math.PI*2,!0),r.fill();break}case"triangle":{r.moveTo(g.x,g.y),r.lineTo(g.x+g.angles[0]*t.size,g.y+g.angles[1]*t.size),r.lineTo(g.x+g.angles[2]*t.size,g.y+g.angles[3]*t.size),r.closePath(),r.fill();break}case"line":{r.moveTo(g.x,g.y),r.lineTo(g.x+g.line*t.size,g.y+g.radius*5),r.lineWidth=2*t.size,r.stroke();break}case"square":{r.save(),r.translate(g.x+15,g.y+5),r.rotate(g.rotation),r.fillRect(-15*t.size,-5*t.size,15*t.size,5*t.size),r.restore();break}case"svg":{r.save();var y=new window.Image;y.src=g.src;var w=g.size||15;r.translate(g.x+w/2,g.y+w/2),g.rotate&&r.rotate(g.rotation),r.drawImage(y,-(w/2)*t.size,-(w/2)*t.size,w*t.size,w*t.size),r.restore();break}}}}var u=function(){t.animate=!1,clearInterval(t.interval),requestAnimationFrame(function(){r.clearRect(0,0,i.width,i.height);var g=i.width;i.width=1,i.width=g})},_=function(){i.width=t.width,i.height=t.height,o=[];for(var g=0;g<t.max;g++)o.push(l());function S(){r.clearRect(0,0,t.width,t.height);for(var w in o)a(o[w]);y(),t.animate&&requestAnimationFrame(S)}function y(){for(var w=0;w<t.max;w++){var n=o[w];n&&(t.animate&&(n.y+=n.speed),n.rotate&&(n.rotation+=n.speed/35),(n.speed>=0&&n.y>t.height||n.speed<0&&n.y<0)&&(t.respawn?(o[w]=n,o[w].x=d(t.width,!0),o[w].y=n.speed>=0?-10:parseFloat(t.height)):o[w]=void 0))}o.every(function(f){return f===void 0})&&u()}return requestAnimationFrame(S)};return{render:_,clear:u}}const qt=async e=>{await e.device.setSignals({dataTerminalReady:!1,requestToSend:!0}),await e.device.setSignals({dataTerminalReady:!1,requestToSend:!1})},uu=async(e,t,i,r,o)=>{let d,v;const s=h=>e({...h,manifest:r,build:d,chipFamily:v}),l=new il(t),a=document.getElementById("terminal"),u=new du.Terminal({rows:8}),_=new fu.FitAddon;u.loadAddon(_),u.clean=function(){this.clear()},u.writeLine=function(h){this.writeln(h)},u.open(a),_.fit();const g=new cu({transport:l,baudrate:115200,romBaudrate:115200,terminal:u});window.esploader=g,s({state:Re.INITIALIZING,message:"Initializing...",details:{done:!1}});try{await g.main_fn(),await g.flash_id()}catch(h){s({state:Re.ERROR,message:"Failed to initialize. Try resetting your device or holding the BOOT button while clicking INSTALL.",details:{error:pi.FAILED_INITIALIZING,details:h}}),await qt(l),await l.disconnect();return}if(v=g.chip.CHIP_NAME,!g.chip.ROM_TEXT){s({state:Re.ERROR,message:`Chip ${v} is not supported`,details:{error:pi.NOT_SUPPORTED,details:`Chip ${v} is not supported`}}),await qt(l),await l.disconnect();return}if(s({state:Re.INITIALIZING,message:`Initialized. Found ${v}`,details:{done:!0}}),d=r.builds.find(h=>h.chipFamily===v),!d){s({state:Re.ERROR,message:`Your ${v} board is not supported.`,details:{error:pi.NOT_SUPPORTED,details:v}}),await qt(l),await l.disconnect();return}s({state:Re.PREPARING,message:"Preparing installation...",details:{done:!1}});const S=d.parts.map(async h=>{console.log("firmware:",`/mc3/firmware/${h.path}`);const c=await fetch(`/mc3/firmware/${h.path}`);if(!c.ok)throw new Error(`Downlading firmware ${h.path} failed: ${c.status}`);const p=new FileReader,b=await c.blob();return new Promise(E=>{p.addEventListener("load",()=>E(p.result)),p.readAsBinaryString(b)})}),y=[];let w=0;for(let h=0;h<S.length;h++)try{const c=await S[h];y.push({data:c,address:d.parts[h].offset}),w+=c.length}catch(c){s({state:Re.ERROR,message:c.message,details:{error:pi.FAILED_FIRMWARE_DOWNLOAD,details:c.message}}),await qt(l),await l.disconnect();return}s({state:Re.PREPARING,message:"Installation prepared",details:{done:!0}}),o&&(s({state:Re.ERASING,message:"Erasing device...",details:{done:!1}}),await g.erase_flash(),s({state:Re.ERASING,message:"Device erased",details:{done:!0}})),s({state:Re.WRITING,message:"Writing progress: 0%",details:{bytesTotal:w,bytesWritten:0,percentage:0}});let n=0;try{await g.write_flash({fileArray:y,flashSize:"keep",flashMode:"keep",flashFreq:"keep",eraseAll:!1,compress:!0,reportProgress:(h,c,p)=>{const b=c/p*y[h].data.length,E=Math.floor((n+b)/w*100);if(c===p){n+=b;return}s({state:Re.WRITING,message:`Writing progress: ${E}%`,details:{bytesTotal:w,bytesWritten:n+c,percentage:E}})}})}catch(h){s({state:Re.ERROR,message:h.message,details:{error:pi.WRITE_FAILED,details:h}}),await qt(l),await l.disconnect();return}s({state:Re.WRITING,message:"Writing complete",details:{bytesTotal:w,bytesWritten:n,percentage:100}}),await xr(100),console.log("HARD RESET"),await qt(l),console.log("DISCONNECT"),await l.disconnect(),s({state:Re.FINISHED,message:"All done!"});const f=new _u({target:"confetti-canvas"});f.render(),setTimeout(()=>{f.clear()},5e3)},pu=["I".charCodeAt(0),"M".charCodeAt(0),"P".charCodeAt(0),"R".charCodeAt(0),"O".charCodeAt(0),"V".charCodeAt(0),1];var Gt;(function(e){e[e.CURRENT_STATE=1]="CURRENT_STATE",e[e.ERROR_STATE=2]="ERROR_STATE",e[e.RPC=3]="RPC",e[e.RPC_RESULT=4]="RPC_RESULT"})(Gt||(Gt={}));var kr;(function(e){e[e.READY=2]="READY",e[e.PROVISIONING=3]="PROVISIONING",e[e.PROVISIONED=4]="PROVISIONED"})(kr||(kr={}));const gu={0:"NO_ERROR",1:"INVALID_RPC_PACKET",2:"UNKNOWN_RPC_COMMAND",3:"UNABLE_TO_CONNECT",254:"TIMEOUT",255:"UNKNOWN_ERROR"};let vu=class extends Error{constructor(){super("Port is not ready")}};const mu=e=>new Promise(t=>setTimeout(t,e)),Su=(e,t=2)=>{let i=e.toString(16).toUpperCase();return i.startsWith("-")?"-0x"+i.substring(1).padStart(t,"0"):"0x"+i.padStart(t,"0")},yo=e=>"["+e.map(t=>Su(t)).join(", ")+"]";class bu extends EventTarget{constructor(t,i){if(super(),this.port=t,this.logger=i,this.error=0,t.readable===null)throw new Error("Port is not readable");if(t.writable===null)throw new Error("Port is not writable")}async initialize(t=1e3){if(this.logger.log("Initializing Improv Serial"),this._processInput(),await mu(1e3),this._reader===void 0)throw new vu;try{await new Promise(async(i,r)=>{setTimeout(()=>r(new Error("Improv Wi-Fi Serial not detected")),t),await this.requestCurrentState(),i(void 0)}),await this.requestInfo()}catch(i){throw await this.close(),i}return this.info}async close(){this._reader&&await new Promise(t=>{this._reader.cancel(),this.addEventListener("disconnect",t,{once:!0})})}async requestCurrentState(){let t;try{await new Promise(async(r,o)=>{this.addEventListener("state-changed",r,{once:!0});const d=v=>{this.removeEventListener("state-changed",r),o(v)};t=this._sendRPCWithResponse(2,[]),t.catch(d)})}catch(r){throw this._rpcFeedback=void 0,new Error(`Error fetching current state: ${r}`)}if(this.state!==kr.PROVISIONED){this._rpcFeedback=void 0;return}const i=await t;this.nextUrl=i[0]}async requestInfo(t){const i=await this._sendRPCWithResponse(3,[],t);this.info={firmware:i[0],version:i[1],name:i[3],chipFamily:i[2]}}async provision(t,i,r){const o=new TextEncoder,d=o.encode(t),v=o.encode(i),s=[d.length,...d,v.length,...v],l=await this._sendRPCWithResponse(1,s,r);this.nextUrl=l[0]}async scan(){const i=(await this._sendRPCWithMultipleResponses(4,[])).map(([r,o,d])=>({name:r,rssi:parseInt(o),secured:d==="YES"}));return i.sort((r,o)=>r.name.toLocaleLowerCase().localeCompare(o.name.toLocaleLowerCase())),i}_sendRPC(t,i){this.writePacketToStream(Gt.RPC,[t,i.length,...i])}async _sendRPCWithResponse(t,i,r){if(this._rpcFeedback)throw new Error("Only 1 RPC command that requires feedback can be active");return await this._awaitRPCResultWithTimeout(new Promise((o,d)=>{this._rpcFeedback={command:t,resolve:o,reject:d},this._sendRPC(t,i)}),r)}async _sendRPCWithMultipleResponses(t,i,r){if(this._rpcFeedback)throw new Error("Only 1 RPC command that requires feedback can be active");return await this._awaitRPCResultWithTimeout(new Promise((o,d)=>{this._rpcFeedback={command:t,resolve:o,reject:d,receivedData:[]},this._sendRPC(t,i)}),r)}async _awaitRPCResultWithTimeout(t,i){return i?await new Promise((r,o)=>{const d=setTimeout(()=>this._setError(254),i);t.finally(()=>clearTimeout(d)),t.then(r,o)}):await t}async _processInput(){this.logger.debug("Starting read loop"),this._reader=this.port.readable.getReader();try{let t=[],i,r=0;for(;;){const{value:o,done:d}=await this._reader.read();if(d)break;if(!(!o||o.length===0))for(const v of o){if(i===!1){v===10&&(i=void 0);continue}if(i===!0){t.push(v),t.length===r&&(this._handleIncomingPacket(t),i=void 0,t=[]);continue}if(v===10){t=[];continue}if(t.push(v),t.length!==9)continue;if(i=String.fromCharCode(...t.slice(0,6))==="IMPROV",!i){t=[];continue}r=9+t[8]+1}}}catch(t){this.logger.error("Error while reading serial port",t)}finally{this._reader.releaseLock(),this._reader=void 0}this.logger.debug("Finished read loop"),this.dispatchEvent(new Event("disconnect"))}_handleIncomingPacket(t){const i=t.slice(6),r=i[0],o=i[1],d=i[2],v=i.slice(3,3+d);if(this.logger.debug("PROCESS",{version:r,packetType:o,packetLength:d,data:yo(v)}),r!==1){this.logger.error("Received unsupported version",r);return}let s=i[3+d],l=0;for(let a=0;a<t.length-1;a++)l+=t[a];if(l=l&255,l!==s){this.logger.error(`Received invalid checksum ${s}. Expected ${l}`);return}if(o===Gt.CURRENT_STATE)this.state=v[0],this.dispatchEvent(new CustomEvent("state-changed",{detail:this.state}));else if(o===Gt.ERROR_STATE)this._setError(v[0]);else if(o===Gt.RPC_RESULT){if(!this._rpcFeedback){this.logger.error("Received result while not waiting for one");return}const a=v[0];if(a!==this._rpcFeedback.command){this.logger.error(`Received result for command ${a} but expected ${this._rpcFeedback.command}`);return}const u=[],_=v[1];let g=2;for(;g<2+_;)u.push(String.fromCodePoint(...v.slice(g+1,g+v[g]+1))),g+=v[g]+1;"receivedData"in this._rpcFeedback?u.length>0?this._rpcFeedback.receivedData.push(u):(this._rpcFeedback.resolve(this._rpcFeedback.receivedData),this._rpcFeedback=void 0):(this._rpcFeedback.resolve(u),this._rpcFeedback=void 0)}else this.logger.error("Unable to handle packet",i)}async writePacketToStream(t,i){const r=new Uint8Array([...pu,t,i.length,...i,0,0]);r[r.length-2]=r.reduce((d,v)=>d+v,0)&255,r[r.length-1]=10,this.logger.debug("Writing to stream:",yo(new Array(...r)));const o=this.port.writable.getWriter();await o.write(r);try{o.releaseLock()}catch(d){console.error("Ignoring release lock error",d)}}_setError(t){this.error=t,t>0&&this._rpcFeedback&&(this._rpcFeedback.reject(gu[t]||`UNKNOWN_ERROR (${t})`),this._rpcFeedback=void 0),this.dispatchEvent(new CustomEvent("error-changed",{detail:this.error}))}}const wu={props:{_manifest:Object,text:String},computed:{isSupported(){return"serial"in navigator},isAllowed(){return window.isSecureContext},unsuported(){return!this.isSupported||!this.isAllowed}},data(){return{isConnected:!1,_installState:"",manifestPath:"/",_state:"DASHBOARD",port:null,_error:"",key:0}},methods:{_handleDisconnect(){this._state="ERROR",this._error="Disconnected"},async _initialize(e=!1){if(this.port.readable===null||this.port.writable===null){this._state="ERROR",this._error="Serial port is not readable/writable. Close any other application using it and try again.";return}if(this._manifest.new_install_improv_wait_time===0){this._client=null;return}const t=new bu(this.port,{log(i){console.log("value",i),as.update(r=>r.concat(i))},debug(i){console.log("value",i),as.update(r=>r.concat(i))},error(i){console.log("value",i),as.update(r=>r.concat(i))}});t.addEventListener("state-changed",()=>{this.key++}),t.addEventListener("error-changed",()=>{this.key++});try{const i=e?this._manifest.new_install_improv_wait_time!==void 0?this._manifest.new_install_improv_wait_time*1e3:1e4:1e3;this._info=await t.initialize(i),this._client=t,t.addEventListener("disconnect",this._handleDisconnect)}catch(i){console.error(i),this._info=void 0,i instanceof PortNotReady?(this._state="ERROR",this._error="Serial port is not ready. Close any other application using it and try again."):(this._client=null,console.error("Improv initialization failed.",i))}},async connectToDevice(){try{if(this.port=await navigator.serial.requestPort(),!this.port)return;try{console.log("this.port",this.port),await this.port.open({baudRate:115200}),this.isConnected=!0}catch(e){console.error(e),this.isConnected=!1,alert(e.message);return}await this.port.close(),uu(e=>{ba.set(e.message),this.$emit("update-state",e),this._installState=e,e.state===Re.FINISHED?xr(100).then(()=>this.port.open({baudRate:115200})).then(()=>this._initialize(!0)).then(()=>{this.key++}):e.state===Re.ERROR&&xr(100).then(()=>this.port.open({baudRate:115200}))},this.port,this.manifestPath,this._manifest,this._installErase)}catch(e){e.name==="NotFoundError"||alert(`Error: ${e.message}`)}}}},yu={key:1};function Cu(e,t,i,r,o,d){var v,s,l;return Le(),je(xe,null,[d.isSupported&&d.isAllowed?(Le(),je("button",{key:0,onClick:t[0]||(t[0]=(...a)=>d.connectToDevice&&d.connectToDevice(...a)),class:rt(["w-[26rem] rounded-md text-2xl md:text-3xl px-12 py-1 border relative font-born2bsporty uppercase",{"text-lightgreen border-lightgreen hover:text-white":o._installState=="","text-lightblue border-lightblue":o._installState!=""}]),style:{"background-color":"#491d00"}},[he("div",{class:"absolute bg-lightblue h-full top-0 left-0 opacity-40",style:Cs([{width:`${((s=(v=o._installState)==null?void 0:v.details)==null?void 0:s.percentage)||0}%`},{transition:"width 3s ease-in-out"}])},null,4),he("div",{class:rt(["absolute w-full h-full opacity-20 left-0 top-0 z-0",{"hover:opacity-60 hover:cursor-pointer bg-lightgreen":o._installState=="","bg-lightblue cursor-auto":o._installState!=""}])},null,2),o._installState==""?(Le(),je(xe,{key:0},[St(sr(i.text),1)],64)):(Le(),je(xe,{key:1},[St(sr((l=o._installState)==null?void 0:l.state),1)],64))],2)):Xi("",!0),o.isConnected?Xi("",!0):(Le(),je("div",yu,[d.isAllowed?Xi("",!0):(Le(),je(xe,{key:0},[St("You can only install ESP devices on HTTPS websites or on the localhost.")],64)),d.unsuported?(Le(),je(xe,{key:1},[St(" >Your browser does not support installing things on ESP devices. Use Google Chrome or Microsoft Edge.")],64)):Xi("",!0)]))],64)}const Eu=zt(wu,[["render",Cu]]);const xu={props:{manifest:Object},components:{InstallButton:Eu}},ol=e=>(Xo("data-v-36534c64"),e=e(),Yo(),e),ku=ol(()=>he("div",{class:"radar z-0 top-0 left-0 h-full w-full shrink-0 overflow-hidden absolute"},null,-1)),Ru={class:"flex justify-center items-center flex-col z-10 mt-20 mb-16 relative"},Au=ol(()=>he("div",{class:"flex flex-row items-center mb-2 md:mb-8 scale-75 md:scale-100"},[he("div",{class:"relative w-[360px] h-[156px] bg-flipper"},[he("div",{class:"absolute left-[92px] top-[27px] w-[128px] h-[64px] bg-flipper-default"}),he("div",{class:"ml-4 hidden md:block absolute top-[70px] w-[159px] h-[37px] bg-typec right-[-175px]"})])],-1));function Lu(e,t,i,r,o,d){const v=ss("InstallButton");return Le(),je(xe,null,[ku,he("div",Ru,[Au,Fe(v,{_manifest:i.manifest,text:"Install Firmware",onUpdateState:t[0]||(t[0]=s=>e.$emit("update-state",s)),onLog:t[1]||(t[1]=s=>e.$emit("log",s))},null,8,["_manifest"])])],64)}const Du=zt(xu,[["render",Lu],["__scopeId","data-v-36534c64"]]);const al=e=>(Xo("data-v-01c964c5"),e=e(),Yo(),e),Tu=al(()=>he("div",{class:"opacity-20 w-full h-full top-0 left-0 absolute bg-repeat bg-[length:412.5px_749.25px] pattern"},null,-1)),Iu={class:"bg-black"},Mu={class:"absolute w-full h-full top-0 left-0 z-20"},Ou=al(()=>he("canvas",{id:"confetti-canvas"},null,-1)),Pu={__name:"App",setup(e){const t=Bs(""),i=Bs(""),r=Bs("2.5.1"),o=ur(()=>r.value.replace(/\./g,"_")),d=ur(()=>({name:"[MALVEKE] Firmware",version:"v0.0.1",builds:[{chipFamily:"ESP32-C3",parts:[{path:`${o.value}/esp32_marauder.ino.bootloader.bin`,offset:4096},{path:`${o.value}/esp32_marauder.ino.partitions.bin`,offset:32768},{path:`${o.value}/boot_app0.bin`,offset:57344},{path:`${o.value}/esp32_marauder.ino.bin`,offset:65536}]}]}));function v(l){t.value=l.message,i.value=l.state}function s(){}return(l,a)=>(Le(),je(xe,null,[Tu,he("div",Iu,[he("div",Mu,[Fe(md,{state:i.value,message:t.value,version:r.value,"onUpdate:version":a[0]||(a[0]=u=>r.value=u)},{default:Jo(()=>[Fe(Du,{manifest:d.value,onUpdateState:v,onLog:s},null,8,["manifest"])]),_:1},8,["state","message","version"])]),Ou])],64))}},Bu=zt(Pu,[["__scopeId","data-v-01c964c5"]]);Mc(Bu).mount("#app");
